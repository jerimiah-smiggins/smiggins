var ResponseCodes,ErrorCodes,_a,_b,_c,NotificationCodes,__awaiter=this&&this.__awaiter||function(e,i,r,l){return new(r=r||Promise)(function(n,t){function o(e){try{s(l.next(e))}catch(e){t(e)}}function a(e){try{s(l.throw(e))}catch(e){t(e)}}function s(e){var t;e.done?n(e.value):((t=e.value)instanceof r?t:new r(function(e){e(t)})).then(o,a)}s((l=l.apply(e,i||[])).next())})};function _intToBytes(t,n=1){var o=new Uint8Array(n);for(let e=0;e<n;e++)o[e]=t>>8*(n-e-1)&255;return o}function hexToBytes(t){var n=Math.floor(t.length/2),o=new Uint8Array(n);for(let e=0;e<n;e++)o[e]=Number("0x"+t.slice(2*e,2*e+2));return o}function buildRequest(...e){let t=[],n=0,o=0;for(var a of e){var s;o&&"boolean"!=typeof a&&(t.push(n<<8-o),n=0,o=0),"boolean"==typeof a?(n=(n<<=1)|Number(a),o++):"object"==typeof a?t=a.push?"string"==typeof a[0]?(s=(new TextEncoder).encode(a[0]),t.concat(Array.from(_intToBytes(s.length,Math.floor(a[1]/8))),Array.from(s))):t.concat(Array.from(_intToBytes(a[0],Math.floor(a[1]/8)))):t.concat(Array.from(a)):console.log("invalid type for buildRequest",a),8==o&&(t.push(n),n=0,o=0)}return o&&t.push(n<<8-o),new Uint8Array(t).buffer}let changes={"1.1.0":{description:"Changelog page and bug fixes",major_changes:[{info:"Added a page that shows changes from previous versions. You're looking at it now!",icon:"quote"}],changes:["Added the changelogs page",'Fixed a bug that occasionally caused the username on user pages to temporairily show the username along with "null"',"Fixed escaping the backtick (<code>`</code>) character in certain circumstances","Fixed a bug that caused some numbers (ex. 12.3) to be treated as links","Added indicators for quotes that are quoting a post with a poll or another quote","The timeline selection (global/following) on the home timeline is saved across sessions","Added backend configuration for the frequency of frontend polling requests (timelines, notifications)"]},"1.1.1":{description:"Banner PFPs and bug fixes",changes:['User sections on posts now have a little "profile picture" using banner colors',"Fixed line wrapping for long words in most places","Fixed a bug with links in numbers",'Fixed a bug that caused the "Includes a quote" text to show up when it shouldn\'t']},"1.1.2":{description:"Bug fixes and small improvements",changes:["The changelog page loads properly again","Added an option that lets you change the shape of the banner icons, or disable them all together","Added an option that configures how content warnings are cascaded","Added a versioning system to APIs to prevent an outdated client from interpreting data as garbage","Added a post counter to profiles","Added a share button on posts",'Clicking the "<i>Includes a poll/quote</i>" on quotes brings you to the quote']},"1.2.0":{description:"Logged out content and embeds",major_changes:[{info:"People who aren't logged in can view users and posts! This helps with ease of use for people who aren't sure if they want to make an account.",icon:"user"}],changes:["People who aren't logged in can view users and post pages","Data is now embedded into the base document for embeds on other platforms, ex. discord","Like notifications now have a timestamp attached to them"]},"1.3.0":{description:"Searching",major_changes:[{info:"You can now search for posts! There are seveal search filters that can be used, like whether or not it has a poll, or who created it.",icon:"search"}],changes:["Added a search page","The navbar on mobile has been rearranged to be less cluttered",'Fixed pagination for the "oldest" timeline on hashtags and comments']},"1.3.1":{description:"More secure password storage and IFrame support",major_changes:[{info:"You can now embed posts on other websites! By using an IFrame, you can make any post be visible on any of your websites.",icon:"embed"}],changes:["Added IFrame support","Password storage is more secure. This however does require everyone to log in again",'Added a backend setting to disable the <a href="/settings/about/" data-internal-link="settings/about">about page</a>',"Added a configuration to disable changelog popups","Like notifications get grouped more often"]},"1.3.2":{description:"Post interaction keybinds",changes:["Added configurable keybinds for the options in hamburger menus on posts","Added an import/export function for settings","Added simple ratelimiting to api requests"]},"1.4.0":{description:"Messages",major_changes:[{info:"You can send people private messages! You can also create group messages with several people at once.",icon:"messages"},{info:'You can now see who follows someone and who that person follows! This can be found by clicking the "following" or "followed by" text on the user\'s page.',icon:"user_plus"}],changes:["Added messages","Rewrote how the API is handled on the frontend","Fixed a bug that caused the default visibility setting to not populate on comments","Comments are now always followers-only by default if the original post is followers-only","Added following/followers pages"]},"1.4.1":{description:"Misc. changes and fixes",changes:["Fixed a bug that caused people who aren't logged in to not be able to view the following/followers popups","Added a setting that disables notification grouping for likes"]},"1.4.2":{description:"Languages",major_changes:[{info:"Added support for multiple languages! Currently, there is only English (US/UK) and Spanish, but if you want to help translate to more languages, please reach out.",icon:"comment"}],changes:["Added support for multiple languages."]},"1.4.3":{description:"Follow Notifications",changes:["You now recieve a notification when someone follows you."]}};(e=>{e[e.NOOP=-1]="NOOP",e[e.LogIn=1]="LogIn",e[e.SignUp=2]="SignUp",e[e.Follow=16]="Follow",e[e.Unfollow=17]="Unfollow",e[e.Block=18]="Block",e[e.Unblock=19]="Unblock",e[e.AcceptFolreq=20]="AcceptFolreq",e[e.DenyFolreq=21]="DenyFolreq",e[e.GetProfile=32]="GetProfile",e[e.SaveProfile=33]="SaveProfile",e[e.DeleteAccount=34]="DeleteAccount",e[e.ChangePassword=35]="ChangePassword",e[e.DefaultVisibility=36]="DefaultVisibility",e[e.VerifyFollowers=37]="VerifyFollowers",e[e.CreatePost=48]="CreatePost",e[e.Like=49]="Like",e[e.Unlike=50]="Unlike",e[e.Pin=51]="Pin",e[e.Unpin=52]="Unpin",e[e.PollVote=53]="PollVote",e[e.PollRefresh=54]="PollRefresh",e[e.EditPost=62]="EditPost",e[e.DeletePost=63]="DeletePost",e[e.AdminDeleteUser=64]="AdminDeleteUser",e[e.GenerateOTP=65]="GenerateOTP",e[e.DeleteOTP=66]="DeleteOTP",e[e.ListOTP=67]="ListOTP",e[e.GetAdminPermissions=68]="GetAdminPermissions",e[e.SetAdminPermissions=69]="SetAdminPermissions",e[e.MessageGroupTimeline=80]="MessageGroupTimeline",e[e.MessageTimeline=81]="MessageTimeline",e[e.MessageSend=82]="MessageSend",e[e.MessageGetGID=83]="MessageGetGID",e[e.TimelineGlobal=96]="TimelineGlobal",e[e.TimelineFollowing=97]="TimelineFollowing",e[e.TimelineUser=98]="TimelineUser",e[e.TimelineComments=99]="TimelineComments",e[e.TimelineNotifications=100]="TimelineNotifications",e[e.TimelineHashtag=101]="TimelineHashtag",e[e.TimelineFolreq=102]="TimelineFolreq",e[e.TimelineSearch=103]="TimelineSearch",e[e.TimelineUserFollowing=104]="TimelineUserFollowing",e[e.TimelineUserFollowers=105]="TimelineUserFollowers",e[e.Notifications=112]="Notifications"})(ResponseCodes=ResponseCodes||{}),(e=>{e[e.BadRequest=0]="BadRequest",e[e.BadUsername=16]="BadUsername",e[e.UsernameUsed=17]="UsernameUsed",e[e.BadPassword=18]="BadPassword",e[e.InvalidOTP=19]="InvalidOTP",e[e.CantInteract=32]="CantInteract",e[e.Blocking=33]="Blocking",e[e.PostNotFound=48]="PostNotFound",e[e.PollSingleOption=49]="PollSingleOption",e[e.NotAuthenticated=254]="NotAuthenticated",e[e.Ratelimit=255]="Ratelimit"})(ErrorCodes=ErrorCodes||{});class _api_Base{constructor(){this.id=ResponseCodes.NOOP,this.version=0,this.url="/api/noop",this.method="GET",this.disabled=[],this.requestBody=null,this.requestParams=null}fetch(){return __awaiter(this,void 0,void 0,function*(){for(var e of this.disabled)null!=e&&e.setAttribute("disabled","");return fetch(this.url+(this.requestParams?(this.url.includes("?")?"&":"?")+this.requestParams:""),{method:this.method,body:this.requestBody}).then(e=>e.arrayBuffer()).then(e=>new Uint8Array(e)).then(e=>{if((127&e[0])!==this.id)throw Error(`Bad response code - expected ${this.id}/${128|this.id}, got ${e[0]}`);if(e[0]>>7&1)return this.err(e[1]),!1;if(e[1]!==this.version)throw alert(lr(L.generic.pending_update,{t:pageTitle,c:`r${e[0].toString(16)}v${e[1]}t${Math.round(Date.now()/1e3)}`})),Error("Bad version");return this.handle(e),!0}).catch(e=>this.genericError(e)).finally(()=>this.always())})}always(){for(var e of this.disabled)null!=e&&e.removeAttribute("disabled")}handle(e){throw Error("Not Implemented")}err(e){createToast(..._getErrorStrings(e,this.id))}genericError(e){createToast(L.errors.something_went_wrong,String(e)),this.always(),console.error(e)}}class _api_TimelineBase extends _api_Base{constructor(e,t){super(),this.expectedTlID=currentTlID,e&&(this.requestParams=`offset=${e}`,t)&&(this.requestParams+="&forwards=true","force"===t)&&(this.expectedTlID="$"+this.expectedTlID)}handle(t){var e=_extractBool(t[2],7),n=_extractBool(t[2],6),o=t[3],a=[];t=t.slice(4);for(let e=0;e<o;e++){var s=_extractPost(t);a.push(s[0]),t=s[1]}n?this.expectedTlID.startsWith("$")?handleForward(a,e,this.expectedTlID.slice(1),!0):handleForward(a,e,this.expectedTlID):renderTimeline(insertIntoPostCache(a),e)}}class api_LogIn extends _api_Base{constructor(e,t,n){super(),this.id=ResponseCodes.LogIn,this.version=0,this.url="/api/user/login",this.method="POST",this.requestBody=buildRequest([e,8],hexToBytes(sha256(t))),this.disabled=[n]}handle(e){setTokenCookie(_toHex(e.slice(2))),location.href="/"}}class api_SignUp extends api_LogIn{constructor(){super(...arguments),this.id=ResponseCodes.SignUp,this.version=0,this.url="/api/user/signup"}}class api_Follow extends _api_Base{constructor(e,t){super(),this.id=ResponseCodes.Follow,this.version=0,this.url="/api/user/follow",this.method="POST",this.requestBody=e,this.disabled=[t]}handle(e){updateFollowButton(!0,Boolean(128&e[2]))}}class api_Unfollow extends api_Follow{constructor(){super(...arguments),this.id=ResponseCodes.Unfollow,this.version=0,this.method="DELETE"}handle(e){updateFollowButton(!1)}}class api_Block extends api_Follow{constructor(){super(...arguments),this.id=ResponseCodes.Block,this.version=0,this.url="/api/user/block",this.method="POST"}handle(e){updateBlockButton(!0)}}class api_Unblock extends api_Block{constructor(){super(...arguments),this.id=ResponseCodes.Unblock,this.version=0,this.method="DELETE"}handle(e){updateBlockButton(!1)}}class api_AcceptFollowRequest extends _api_Base{constructor(e){super(),this.id=ResponseCodes.AcceptFolreq,this.version=0,this.url="/api/user/follow-request",this.method="POST",this.requestBody=e}handle(e){}}class api_DenyFollowRequest extends api_AcceptFollowRequest{constructor(){super(...arguments),this.id=ResponseCodes.DenyFolreq,this.version=0,this.method="DELETE"}}class api_GetProfile extends _api_Base{constructor(){super(...arguments),this.id=ResponseCodes.GetProfile,this.version=0,this.url="/api/user",this.method="GET"}handle(e){var e=_extractString(8,e.slice(2)),t=_extractString(16,e[1]),n=_extractString(8,t[1]);profileSettingsSetUserData(e[0],t[0],n[0],"#"+_toHex(n[1].slice(0,3)),"#"+_toHex(n[1].slice(3,6)),_extractBool(n[1][6],7),_extractBool(n[1][6],6))}}class api_SaveProfile extends _api_Base{constructor(e,t,n,o,a,s,i){super(),this.id=ResponseCodes.SaveProfile,this.version=0,this.url="/api/user",this.method="PATCH",this.disabled=[i],this.requestBody=buildRequest(e,[t,8],[n,16],[o,8],hexToBytes(a+s))}handle(e){createToast(L.generic.success,L.settings.profile.profile_saved),updateUserCacheFromCosmeticSettings()}}class api_DeleteAccount extends _api_Base{constructor(e,t,n){super(),this.id=ResponseCodes.DeleteAccount,this.version=1,this.url="/api/user",this.method="DELETE",this.disabled=[n],this.requestBody=buildRequest(hexToBytes(sha256(t)),[e,8])}handle(e){renderPage("logout")}}class api_ChangePassword extends _api_Base{constructor(e,t,n){super(),this.id=ResponseCodes.ChangePassword,this.version=0,this.url="/api/user/password",this.method="PATCH",this.disabled=[n],this.requestBody=buildRequest(hexToBytes(sha256(e)+sha256(t)))}handle(e){changePasswordSuccess(_toHex(e.slice(2)))}}class api_DefaultVisibility extends _api_Base{constructor(e){super(),this.id=ResponseCodes.DefaultVisibility,this.version=0,this.url="/api/user/default_post",this.method="PATCH",this.requestBody=buildRequest([+e,8])}handle(e){}}class api_VerifyFollowers extends _api_Base{constructor(e){super(),this.id=ResponseCodes.VerifyFollowers,this.version=0,this.url="/api/user/verify_followers",this.method="PATCH",this.requestBody=buildRequest([+e,8])}handle(e){}}class api_CreatePost extends _api_Base{constructor(e,t,n,o){super(),this.id=ResponseCodes.CreatePost,this.version=0,this.url="/api/post",this.method="POST",this.requestBody=buildRequest(n,Boolean(o&&o.quote),Boolean(o&&o.poll&&o.poll.length),Boolean(o&&o.comment),[e,16],[t||"",8],...o&&o.poll&&o.poll.length?[[o.poll.length,8],...o.poll.map(e=>[e,8])]:[],...o&&o.quote?[[o.quote,32]]:[],...o&&o.comment?[[o.comment,32]]:[])}handle(e){prependPostToTimeline(_extractPost(e.slice(2))[0])}}class api_Like extends _api_Base{constructor(e){super(),this.id=ResponseCodes.Like,this.version=0,this.method="POST",this.url=`/api/post/like/${e}`}handle(e){}}class api_Unlike extends api_Like{constructor(){super(...arguments),this.id=ResponseCodes.Unlike,this.version=0,this.method="DELETE"}handle(e){}}class api_Pin extends _api_Base{constructor(e){super(),this.id=ResponseCodes.Pin,this.version=0,this.method="POST",this.url=`/api/post/pin/${e}`}handle(e){createToast(L.generic.success,L.post.pinned)}}class api_Unpin extends _api_Base{constructor(){super(...arguments),this.id=ResponseCodes.Unpin,this.version=0,this.url="/api/post/pin",this.method="DELETE"}handle(e){var t;createToast(L.generic.success,L.post.unpinned),null!=(t=document.getElementById("user-pinned-container"))&&t.setAttribute("hidden","")}}class api_PollVote extends _api_Base{constructor(e,t){super(),this.id=ResponseCodes.PollVote,this.version=0,this.url="/api/post/poll",this.method="POST",this.requestBody=buildRequest([e,32],[t,8])}handle(e){var t=_extractInt(32,e.slice(2)),e=_extractPoll(e.slice(6))[0],n=postCache[t];n&&(n.poll=e),refreshPollDisplay(t,!0)}}class api_PollRefresh extends api_PollVote{constructor(e){super(0,0),this.id=ResponseCodes.PollRefresh,this.version=0,this.method="GET",this.url=`/api/post/poll/${e}`,this.requestBody=null}}class api_EditPost extends _api_Base{constructor(e,t,n,o,a){super(),this.id=ResponseCodes.EditPost,this.version=0,this.url="/api/post",this.method="PATCH",this.disabled=[a],this.requestBody=buildRequest([e,32],o,[t,16],[n,8])}handle(e){}}class api_DeletePost extends _api_Base{constructor(e){super(),this.id=ResponseCodes.DeletePost,this.version=0,this.url="/api/post",this.method="DELETE",this.requestBody=buildRequest([e,32])}handle(e){handlePostDelete(_extractInt(32,e.slice(2)))}}class api_AdminDeleteUser extends _api_Base{constructor(e){super(),this.id=ResponseCodes.AdminDeleteUser,this.version=0,this.url="/api/admin/user",this.method="DELETE",this.requestBody=e}handle(e){createToast(L.generic.success,L.admin.delete_user.success)}}class api_GenerateOTP extends _api_Base{constructor(){super(...arguments),this.id=ResponseCodes.GenerateOTP,this.version=0,this.url="/api/admin/invite",this.method="POST"}handle(e){var e=_toHex(e.slice(2)),t=document.getElementById("generate-otp-output");t&&(t.classList.add("otp"),t.innerText=e),null!=t&&t.removeAttribute("hidden"),navigator.clipboard.writeText(e).then(()=>createToast(L.generic.copied,L.admin.generate_otp.copied))}}class api_DeleteOTP extends _api_Base{constructor(e){super(),this.id=ResponseCodes.DeleteOTP,this.version=0,this.url="/api/admin/invite",this.method="DELETE",this.requestBody=buildRequest(hexToBytes(e))}handle(e){}}class api_ListOTP extends _api_Base{constructor(){super(...arguments),this.id=ResponseCodes.ListOTP,this.version=0,this.url="/api/admin/invite",this.method="GET"}handle(e){var t=document.getElementById("otp-list");if(t){e=[..._toHex(e.slice(2)).matchAll(/.{64}/g)];if(e.length){t.innerHTML=e.map(e=>`<div data-otp-container="${e[0]}"><code class="otp">${e[0]}</code> <button data-otp="${e}">${L.admin.generate_otp.delete}</button></div>`).join("");for(var n of t.querySelectorAll("button"))n.addEventListener("click",adminDeleteOTP)}else t.innerHTML=`<i>${L.generic.none}</i>`}}}class api_GetAdminPermissions extends _api_Base{constructor(e){super(),this.id=ResponseCodes.GetAdminPermissions,this.version=0,this.method="GET",this.url=`/api/admin/permissions/${e}`}handle(e){adminSetPermissionCheckboxes(_extractInt(16,e.slice(2)))}}class api_SetAdminPermissions extends _api_Base{constructor(e,t){super(),this.id=ResponseCodes.SetAdminPermissions,this.version=0,this.url="/api/admin/permissions",this.method="POST",this.requestBody=buildRequest([t,16],[e,8])}handle(e){createToast(L.generic.success,L.admin.set_level.success)}}class api_MessageGroupTimeline extends _api_TimelineBase{constructor(){super(...arguments),this.id=ResponseCodes.MessageGroupTimeline,this.version=0,this.url="/api/message/list",this.method="GET"}handle(t){var e=_extractBool(t[2],7),n=_extractBool(t[2],6),o=t[3],a=[];t=t.slice(4);for(let e=0;e<o;e++){var s=_extractInt(32,t),i=_extractInt(64,t.slice(4)),r=_extractBool(t[12],7),l=_extractString(16,t.slice(13)),c=(t=l[1].slice(1),[]);for(let e=0;e<Math.min(l[1][0]-1,3);e++){var d=_extractString(8,t);c.push(d[0]),t=d[1]}a.push({group_id:s,timestamp:i,unread:r,recent_content:l[0],members:{count:l[1][0],names:c}})}n?handleMessageListForward(a,e,"message_list",!0):renderMessageListTimeline(a,e,!1)}}class api_MessageTimeline extends _api_TimelineBase{constructor(e,t,n){super(e,t),this.id=ResponseCodes.MessageTimeline,this.version=0,this.method="GET",this.url=`/api/messages/${n}`}handle(t){var n=t[2],o=[];t=t.slice(3);for(let e=0;e<Math.min(n-1,3);e++){var a=_extractString(8,t);o.push(a[0]),t=a[1]}var e=document.getElementById("message-title"),e=(e&&(e.innerHTML=getMessageTitle(o,n)),_extractBool(t[0],7)),s=_extractBool(t[0],6),i=t[1],r=[];t=t.slice(2);for(let e=0;e<i;e++){var l=_extractInt(64,t),c=_extractString(16,t.slice(8)),d=_extractString(8,c[1]),u=_extractString(8,d[1]);t=u[1],r.push({timestamp:l,content:c[0],username:d[0],display_name:u[0]})}s?handleMessageForward(r,e,"message",!0):renderMessageTimeline(r,e,!1)}}class api_MessageSend extends _api_Base{constructor(e,t,n){super(),this.id=ResponseCodes.MessageSend,this.version=0,this.method="POST",this.disabled=[n],this.url=`/api/message/${e}`,this.requestBody=buildRequest([t,16])}handle(e){var t=document.getElementById("messages-compose");t&&(t.disabled=!1,t.value="",t.focus()),(document.querySelector("#timeline-posts > div")?timelinePolling:reloadTimeline)(!0)}}class api_MessageGetGID extends _api_Base{constructor(e,t){super(),this.id=ResponseCodes.MessageGetGID,this.version=0,this.url="/api/message/group",this.method="GET",this.disabled=[t],this.requestParams=`usernames=${e.join(",")}`}handle(e){e=_extractInt(32,e.slice(2));history.pushState("message","",`/message/${e}/`),renderPage("message"),clearModal()}}class api_TimelineGlobal extends _api_TimelineBase{constructor(e,t,n){super(e,t),this.id=ResponseCodes.TimelineGlobal,this.version=0,this.method="GET",this.url=`/api/timeline/global${n?"?comments=true":""}`}}class api_TimelineFollowing extends _api_TimelineBase{constructor(e,t,n){super(e,t),this.id=ResponseCodes.TimelineFollowing,this.version=0,this.method="GET",this.url=`/api/timeline/following${n?"?comments=true":""}`}}class api_TimelineUser extends _api_TimelineBase{constructor(e,t,n,o){super(e,t),this.id=ResponseCodes.TimelineUser,this.version=0,this.method="GET",this.url=`/api/timeline/user/${n}${o?"?include_comments=true":""}`}handle(e){var t=_extractString(8,e.slice(2)),n=_extractString(8,t[1]),o=_extractString(16,n[1]),a=o[1][12];let s=null,i;_extractBool(a,2)&&(i=_extractPost(o[1].slice(13)),s=insertIntoPostCache([i[0]])[0]),userUpdateStats(t[0],n[0],o[0],"#"+_toHex(o[1].slice(0,3)),"#"+_toHex(o[1].slice(3,6)),_extractBool(a,3)?"pending":_extractBool(a,5),_extractBool(a,4),_extractInt(16,o[1].slice(8)),_extractInt(16,o[1].slice(6)),_extractInt(16,o[1].slice(10)),s),e=new Uint8Array([0,0,a].concat(Array.from(i?i[1]:o[1].slice(13)))),super.handle(e)}}class api_TimelineComments extends _api_TimelineBase{constructor(e,t,n,o){super(e,t),this.id=ResponseCodes.TimelineComments,this.version=0,this.method="GET",this.url=`/api/timeline/post/${n}?sort=${o}`}handle(e){var t=_extractPost(e.slice(2));updateFocusedPost(t[0]),e=new Uint8Array([0].concat(Array.from(t[1]))),super.handle(e)}}class api_TimelineNotifications extends _api_TimelineBase{constructor(){super(...arguments),this.id=ResponseCodes.TimelineNotifications,this.version=1,this.url="/api/timeline/notifications",this.method="GET"}handle(t){var e=_extractBool(t[2],7),n=_extractBool(t[2],6),o=t[3],a=[];t=t.slice(4);for(let e=0;e<o;e++){var s=Boolean(128&t[0]);let e=null;var i=127&t[0];switch(t=t.slice(1),i){case NotificationCodes.Comment:case NotificationCodes.Quote:case NotificationCodes.Ping:var r=_extractPost(t);t=r[1],e={code:i,unread:s,post:r[0]};break;case NotificationCodes.Like:var r=_extractInt(32,t),l=_extractInt(64,t.slice(4)),c=_extractString(8,t.slice(12)),d=_extractString(8,c[1]),u=_extractString(16,d[1]),m=_extractString(8,u[1]);t=m[1],e={code:i,unread:s,username:c[0],display_name:d[0],timestamp:l,post_id:r,content:u[0],content_warning:m[0]};break;case NotificationCodes.Follow:c=_extractInt(64,t),d=_extractString(8,t.slice(8)),l=_extractString(8,d[1]);t=l[1],e={code:i,unread:s,username:d[0],display_name:l[0],timestamp:c};break;default:console.log("invalid notification object",i)}e&&a.push(e)}n?handleNotificationForward(a,e,"notifications"):renderNotificationTimeline(a,e,!1)}}class api_TimelineHashtag extends _api_TimelineBase{constructor(e,t,n,o){super(e,t),this.id=ResponseCodes.TimelineHashtag,this.version=0,this.method="GET",this.url=`/api/timeline/tag/${n}?sort=${o}`}}class api_TimelineFolreq extends _api_TimelineBase{constructor(e,t){super(e,!1),this.id=ResponseCodes.TimelineFolreq,this.version=1,this.url="/api/timeline/follow-requests",this.method="GET"}handle(t){var e=_extractBool(t[2],7),n=t[3],o=[];t=t.slice(4);for(let e=0;e<n;e++){var a=_extractInt(32,t),s=_extractString(8,t.slice(4)),i=_extractString(8,s[1]),r=_extractString(8,i[1].slice(6)),l=_extractString(16,r[1]);t=l[1],o.push({username:s[0],pronouns:i[0]||null,color_one:"#"+_toHex(i[1].slice(0,3)),color_two:"#"+_toHex(i[1].slice(3,6)),display_name:r[0],bio:l[0],id:a})}renderFolreqTimeline(o,e,!1)}}class api_TimelineSearch extends _api_TimelineBase{constructor(e,t,n,o){super(e,t),this.id=ResponseCodes.TimelineSearch,this.version=0,this.method="GET",this.url=`/api/timeline/search?sort=${o}&${n}`}}class api_TimelineUserFollowing extends _api_TimelineBase{constructor(e,t){super(e,!1),this.id=ResponseCodes.TimelineUserFollowing,this.version=0,this.method="GET",this.url=`/api/timeline/user/following/${t}`}handle(t){var e=_extractBool(t[2],7),n=t[3],o=[];t=t.slice(4);for(let e=0;e<n;e++){var a=_extractInt(32,t),s=_extractString(8,t.slice(4)),i=_extractString(8,s[1]),r=_extractString(8,i[1].slice(6)),l=_extractString(16,r[1]);t=l[1],o.push({username:s[0],pronouns:i[0]||null,color_one:"#"+_toHex(i[1].slice(0,3)),color_two:"#"+_toHex(i[1].slice(3,6)),display_name:r[0],bio:l[0],id:a})}renderFollowingTimeline(o,e)}}class api_TimelineUserFollowers extends api_TimelineUserFollowing{constructor(e,t){super(e,t),this.id=ResponseCodes.TimelineUserFollowers,this.url=`/api/timeline/user/followers/${t}`}}class api_Notifications extends _api_Base{constructor(){super(...arguments),this.id=ResponseCodes.Notifications,this.version=0,this.url="/api/notifications",this.method="GET"}handle(e){pendingNotifications={notifications:_extractBool(e[2],7),messages:_extractBool(e[2],6),follow_requests:_extractBool(e[2],5)},resetNotificationIndicators()}genericError(e){}}let forceDisableKeybinds=!1,navModKeyPressed=!1,KB_DISABLED="DISABLED",_kbReverse={},keybinds={newPost:{defaultKey:"n",callback:()=>{createPostModal()}},loadNewPosts:{defaultKey:"r",callback:timelineShowNew},topOfTimeline:{defaultKey:"/",callback:()=>{window.scrollTo(0,0)}},navModifier:{defaultKey:"g",callback:()=>{navModKeyPressed=!0},releaseCallback:()=>{navModKeyPressed=!1}},navAdmin:{defaultKey:"a",modifiers:["nav"],callback:()=>{isAdmin&&"admin"!==currentPage&&(history.pushState("admin","","/admin/"),renderPage("admin"))}},navHome:{defaultKey:"h",modifiers:["nav"],callback:()=>{"home"!==currentPage&&(history.pushState("home","","/"),renderPage("home"))}},navMessages:{defaultKey:"m",modifiers:["nav"],callback:()=>{"message-list"!==currentPage&&(history.pushState("message-list","","/messages/"),renderPage("message-list"))}},navNotifications:{defaultKey:"n",modifiers:["nav"],callback:()=>{"notifications"!==currentPage&&(history.pushState("notifications","","/notifications/"),renderPage("notifications"))}},navProfile:{defaultKey:"p",modifiers:["nav"],callback:()=>{"user"===currentPage&&getUsernameFromPath()===username||(history.pushState("user","",`/u/${username}/`),renderPage("user"))}},navSettings:{defaultKey:"s",modifiers:["nav"],callback:()=>{"settings"!==currentPage&&(history.pushState("settings","","/settings/"),renderPage("settings"))}},hamburgerDelete:{defaultKey:"d",modifiers:["alt"],callback:()=>{keybindPostHamburger("data-interaction-delete")}},hamburgerPin:{defaultKey:"f",modifiers:["alt"],callback:()=>{keybindPostHamburger("data-interaction-pin")||keybindPostHamburger("data-interaction-unpin")}},hamburgerEdit:{defaultKey:"e",modifiers:["alt"],callback:()=>{keybindPostHamburger("data-interaction-edit")}},hamburgerShare:{defaultKey:"s",modifiers:["alt"],callback:()=>{keybindPostHamburger("data-interaction-share")}},hamburgerEmbed:{defaultKey:KB_DISABLED,modifiers:[],callback:()=>{keybindPostHamburger("data-interaction-embed")}}};function setKeybindStrings(){keybinds.newPost=Object.assign(Object.assign({},keybinds.newPost),L.keybinds.new_post),keybinds.loadNewPosts=Object.assign(Object.assign({},keybinds.loadNewPosts),L.keybinds.load_new_posts),keybinds.topOfTimeline=Object.assign(Object.assign({},keybinds.topOfTimeline),L.keybinds.top_of_timeline),keybinds.navModifier=Object.assign(Object.assign({},keybinds.navModifier),L.keybinds.nav_modifier),keybinds.navAdmin.name=L.keybinds.nav_admin,keybinds.navHome.name=L.keybinds.nav_home,keybinds.navMessages.name=L.keybinds.nav_messages,keybinds.navNotifications.name=L.keybinds.nav_notifications,keybinds.navProfile.name=L.keybinds.nav_profile,keybinds.navSettings.name=L.keybinds.nav_settings,keybinds.hamburgerDelete.name=L.keybinds.hamburger_delete,keybinds.hamburgerPin.name=L.keybinds.hamburger_pin,keybinds.hamburgerEdit.name=L.keybinds.hamburger_edit,keybinds.hamburgerShare.name=L.keybinds.hamburger_share,keybinds.hamburgerEmbed.name=L.keybinds.hamburger_embed}function setKeybindKey(e,t,n){let o="";if(n){if(n.nav){var a=_kbGetKey("navModifier");if(a[0]+a.slice(1).split(":")[0]===t.toLowerCase())return!1;o+="nav"}n.alt&&(o&&(o+=","),o+="alt"),n.ctrl&&(o&&(o+=","),o+="ctrl"),n.shift&&(o&&(o+=","),o+="shift")}if("navModifier"===e){o="";for(var s of Object.keys(_kbReverse))if(s.startsWith(t+":nav"))return!1}a=(t="escape"===(t=t.toLowerCase())?KB_DISABLED:t)+":"+o;return!(a in _kbReverse||(localStorage.setItem("smiggins-keybind-"+e,a),_kbRefreshReverse(),0))}function _kbGetKey(e){var t=keybinds[e],e=localStorage.getItem("smiggins-keybind-"+e);return e||t.defaultKey+":"+(t.modifiers||[]).join(",")}function _kbRefreshReverse(){_kbReverse={};for(var[e,t]of Object.entries(keybinds)){e=_kbGetKey(e);e.startsWith(KB_DISABLED)||(_kbReverse[e]={callback:t.callback,modifiers:e.slice(1).split(":")[1].split(",")})}}function keyHandler(t){if(!forceDisableKeybinds&&loggedIn&&!IS_IFRAME){var n=t.target;if(!n||"INPUT"!==n.tagName&&"TEXTAREA"!==n.tagName){let e="";navModKeyPressed&&(e+="nav"),t.altKey&&(e&&(e+=","),e+="alt"),t.ctrlKey&&(e&&(e+=","),e+="ctrl"),t.shiftKey&&(e&&(e+=","),e+="shift");n=_kbReverse[t.key.toLowerCase()+":"+e];n&&(t.preventDefault(),n.callback(t))}}}function keyUpHandler(e){e.key.toLowerCase()+":"===_kbGetKey("navModifier")&&(navModKeyPressed=!1)}function keybindPostHamburger(e){e=document.querySelector(`.hamburger:focus .post-hamburger [${e}]:not([hidden])`)||document.querySelector(`.hamburger .post-hamburger:focus [${e}]:not([hidden])`)||document.querySelector(`.hamburger .post-hamburger:focus-within [${e}]:not([hidden])`);return console.log(e),!!e&&(e.click(),!0)}onkeydown=keyHandler,onkeyup=keyUpHandler,_kbRefreshReverse();let LANGS={en:{meta:{id:"en",name:"English",fallbacks:[],maintainers:[["trinkey","trinkey"]],past_maintainers:[]},version:"v%n",generic:{username:"Username",success:"Success!",copied:"Copied!",none:"None",pending_update:"It seems that %t has been updated. Please reload the page for updates to take effect.\n\nIf this popup continues to show up after you reload, please contact your instance administrator.\nCode: %c",loading:"Loading...",load_more:"Load More",sign_up_for_more:"Sign up to view more!",toggle_password:"Toggle Password",back:"Back"},errors:{something_went_wrong:"Something went wrong!",bad_username:"Invalid username.",username_no_user:"No user has that username.",username_characters:"Usernames can only include the characters a-z, 0-9, _, and -.",username_used:"Username in use.",bad_password:"Invalid password.",invalid_otp:"Invalid invite code.",invalid_otp_more:"Make sure your invite code is correct and try again.",cant_delete:"Can't delete.",cant_delete_more:"You don't have permissions to delete this post.",cant_interact:"Can't interact.",cant_interact_more:"You can't interact with this user for some reason.",blocking:"You are blocking this person.",blocking_more:"You need to unblock them to do this.",post_not_found:"Post not found.",invalid_poll:"Invalid poll.",poll_more_than_one:"Must have more than one option.",not_authenticated:"Not Authenticated.",not_authenticated_more:"You need to be logged in to do this.",ratelimit:"Ratelimited.",ratelimit_more:"Try again in a few seconds.",error_code:"Error code %c",cant_copy:"Unable to copy!",cant_copy_more:"Couldn't copy text to your clipboard. Are you using https?",passwords_dont_match:"Passwords don't match.",user_dne:"User '%u' does not exist."},numbers:{infinity:"Infinity",thousand:"%nk",million:"%nm",billion:"%nb",second:"%xs",minute:"%xm",hour:"%xh",day:"%xd",year:"%xy",minute_second:"%xm%ys",hour_minute:"%xh%ym",day_hour:"%xd%yh",year_day:"%xy%yd",future:"in %t"},titles:{base:"%l - %n",admin:"Administration",changes:"Changes",follow_requests:"Follow Requests",login:"Log In",logout:"Log Out",messages:"Messages",not_found:"Page Not Found",notifications:"Notifications",search:"Search",settings:"Settings",signup:"Sign Up"},post:{poll:{refresh:"Refresh",return_to_voting:"Return to voting",view_results:"View results",vote_count:{1:"%n vote","*":"%n vote"}},cw:{length:{1:"%n char","*":"%n chars"},has_quote:", quote",has_poll:", poll",reply:"RE: %c"},quote:{has_quote:"Includes a quote",has_poll:"Includes a poll",cant_view:"You can't view this quote."},tl_refresh:"Refresh",show_new:{1:"Show new post (%n)","*":"Show new posts (%n)"},copied:"A link to this post has been added to your clipboard.",copy_message:"Check out this post on %s! %p",embedded:"An IFrame code snippet has been copied to your clipboard.",deleted:"This post has been deleted.",cw_short:"CW: %c",poll_short:"Poll",followers_only:"Followers Only",cw_placeholder:"Content warning (optional)",poll_button:"Poll",poll_placeholder:"Option %n",poll_placeholder_optional:"Option %n (optional)",button:"Post",placeholder:"Cool post",quote_button:"Quote",quote_placeholder:["Cool quote","What did they say this time?","Yet another mistake to point out?","Ugh... not again..."],comment_button:"Reply",comment_placeholder:["Cool comment","Got something to say about this?","Let them know how you feel","Go spread your opinions, little one"],edit_button:"Save",edit_placeholder:"Cool post but edited",pinned:"Pinned to your profile.",unpinned:"This post is no longer pinned to your profile.",embed:"Embed",share:"Share",unpin:"Unpin",pin:"Pin",edit:"Edit",delete:"Delete",parent_link:"Comment Parent",home_link:"Home"},keybinds:{modifiers:{alt:"Alt",ctrl:"Ctrl",shift:"Shift",disabled:"DISABLED"},button_change:"Change",change_instructions:"Press the new key in the box above.",new_post:{name:"Enter Post Box",description:"Lets you send a post from anywhere"},load_new_posts:{name:"Load New Posts",description:"Shows any posts that have been made since the posts were initially loaded"},top_of_timeline:{name:"Jump to Top",description:"Jumps to the top of the current page"},nav_modifier:{name:"Navigation Modifier",description:"The key that needs to be pressed in order to use the other navigation keybinds"},nav_admin:"Admin Page",nav_home:"Home",nav_messages:"Messages",nav_notifications:"Notifications",nav_profile:"Your Profile",nav_settings:"Settings",hamburger_delete:"Delete Post",hamburger_pin:"Pin Post",hamburger_edit:"Edit Post",hamburger_share:"Share Post",hamburger_embed:"Embed Post"},settings:{profile:{title:"Profile",real_title:"Profile Settings",description:"Display name, banner color...",profile_saved:"Your profile has been saved.",section_profile:"Your Profile",display_name:"Display name:",pronouns:"Pronouns:",pronouns_presets:["he/him","she/her","they/them","it/its"],pronouns_unset:"Unset",pronouns_custom:"Custom",pronouns_custom_placeholder:"Custom pronouns...",bio:"User bio:",banner:"Banner:",gradient:"Enable gradient banner?",save_profile:"Save",section_posts:"Posts",default_visibility:"Default post visibility:",vis_public:"Public",vis_private:"Followers Only",section_followers:"Followers",manually_approve:"Manually approve followers?"},cosmetic:{title:"Cosmetic",real_title:"Cosmetic Settings",description:"Website theme, tweaks...",section_colors:"Colors",themes:{label:"Theme:",system:"Automatic",light:"Light",dark:"Dark",warm:"Warm",gray:"Gray",darker:"Dark Gray",oled:"Black"},section_timestamps:"Timestamps",complex_ts:"Enable complex timestamps",complex_ts_more:"(1h becomes 1h32m, 5m becomes 5m48s)",section_language:"Languages",language:"Language:",section_font_size:"Font Size",font_size_example:"Aa",section_posts:"Posts",hide_interactions:"Hide interactions on posts",expand_cws:"Always expand content warnings",hide_changelog:"Hide changelog popups",no_like_grouping:"Don't group like notifications",auto_show_new:"Automatically show new posts on the timeline",auto_show_new_more:"When disabled, there will instead be a button to show new posts.",banner_shape:{label:"User banner icon shape:",none:"Hidden",square:"Square",round:"Rounded Square",circle:"Circle"},cw_cascading:{label:"Content warning cascading:",description:"What the content warning should be when commenting on a post with one.",none:"Don't set a content warning",email:'Prepend "RE: " (like an email)',copy:"Use existing content warning"}},keybinds:{title:"Keybinds",real_title:"Keybinds",description:"Navigation, send posts...",section_generic:"Generic Keybinds",section_nav:"Navigation Keybinds",section_hamburger:"Post Interaction Keybinds"},account:{title:"Account",real_title:"Account Settings",description:"Change password, delete account...",password_changed:"Your password has been changed.",section_change_password:"Change Password",current:"Current Password",new:"New Password",confirm:"Confirm Password",set:"Set Password",section_delete:"Delete Account",password:"Password",confirmation:"I confirm that this action %Bcan not be undone%b, and any data associated with this account (%u) will %Bnot be recoverable%b.",delete:"Delete My Account"},about:{title:"About",description:"Source code, credits...",section_credits:"Credits",lead_dev:"Lead Developer:",contributors:"Other Contributors:",translators:"Translators:",maintainers:"Maintainers:",past_maintainers:"Past Maintainers:",icons:"Some icons are from Font Awesome",section_call_to_action:"Found a bug? Have suggestions?",create_an_issue:"Create an issue on the GitHub repository!",suggestions_appreciated:"All suggestions and bug reports are greatly appreciated.",past_changes:"You can also view all past changes %h.",here:"here",section_special_thanks:"Special Thanks",thanks_intro:"Thank you to everyone who has reported issues, suggested features, and been active in the community.",thanks_body:"This project is created and maintained completely for free. No one has made a single penny off of Smiggins. This wouldn't exist today without your support. Thank you for using Smiggins, and we hope you enjoy it!",source:"Source Code",discord:"Discord Server"},import:"Import Settings...",export:"Export Settings...",log_out:"Log Out...",log_in:"Log In..."},admin:{title:"Administration",description:"Delete posts, generate invites...",delete_post:{title:"Delete Posts",pid:"Post ID:",button:"Delete Post"},delete_user:{title:"Delete User",success:"This user has been deleted.",username:"Username:",confirmation:"I confirm that this is the user I would like to permanently delete.",button:"Delete User"},generate_otp:{title:"Manage Invite Codes",generate:"Generate Code",list:"List Valid Codes",delete:"Delete",copied:"The invite code has been copied to your clipboard."},set_level:{title:"Set Admin Permissions",success:"Permissions saved.",username:"Username:",permission_warning:"Allows setting permissions for both self and others, including permissions they don't have",load:"Load Current Permissions",save:"Save Permissions"}},messages:{none:"No messages",title:{1:"%a",2:"%a and %b",3:"%a, %b, and %c",4:"%a, %b, %c, and <b>%n other</b>","*":"%a, %b, %c, and <b>%n others</b>"},placeholder:"Blah blah blah",create_group:"Create a Group",create_button:"Create Group",add_user:"Add User",cancel:"Cancel"},notifications:{like:{1:"%a liked your post.",2:"%a and %b liked your post.",3:"%a, %b, and %c liked your post.",4:"%a, %b, %c, and <b>%n other</b> liked your post.","*":"%a, %b, %c, and <b>%n others</b> liked your post."},follow:{1:"%a followed you.",2:"%a and %b followed you.",3:"%a, %b, and %c followed you.",4:"%a, %b, %c, and <b>%n other</b> followed you.","*":"%a, %b, %c, and <b>%n others</b> followed you."}},user:{follow:"Follow",unfollow:"Unfollow",pending:"Pending",block:"Block",unblock:"Unblock",no_bio:"No bio set",following_count:"following %n",followed_by_count:"followed by %n",posts_count:"%n posts",modal_close:"Close",follow_request_accept:"Accept",follow_request_deny:"Deny"},timeline:{user_main:"Posts",user_comments:"Include Comments",newest:"Newest",oldest:"Oldest",home_following:"Following",home_global:"Global",home_comments:"Comments"},login:{username:"Username",password:"Password",confirm:"Confirm Password",invite_code:"Invite Code",logout_info:"Click here if you don't get automatically redirected.",sign_up_button:"Sign Up",log_in_button:"Log In",new_accounts_disabled:"New accounts are currently disabled.",already_have_account:"Already have an account? Log in instead.",dont_have_account:"Don't have an account? Sign up instead."},search:{button:"Search",content_placeholder:"Post content",advanced:"Advanced Search",cw:"Content Warning:",cw_placeholder:"CW content (optional)",author:"Created by:",author_placeholder:"Username (optional)",quote:"Includes quote?",poll:"Includes poll?",comment:"Is comment?",any:"Any",yes:"Yes",no:"No"},not_found:{subtitle:"The url wasn't found",back:"Return Home"},update:{title:"%s has been updated!",view_changes:"View Changes",dismiss:"Dismiss"}},en_GB:{meta:{id:"en_GB",name:"English (United Kingdom)",fallbacks:["en"],maintainers:[["trinkey","trinkey"]],past_maintainers:[]},version:"v%n",generic:{username:"Username",success:"Success!",copied:"Copied!",none:"None",pending_update:"It seems that %t has been updated. Please reload the page for updates to take effect.\n\nIf this popup continues to show up after you reload, please contact your instance administrator.\nCode: %c",loading:"Loading...",load_more:"Load More",sign_up_for_more:"Sign up to view more!",toggle_password:"Toggle Password",back:"Back"},errors:{something_went_wrong:"Something went wrong!",bad_username:"Invalid username.",username_no_user:"No user has that username.",username_characters:"Usernames can only include the characters a-z, 0-9, _, and -.",username_used:"Username in use.",bad_password:"Invalid password.",invalid_otp:"Invalid invite code.",invalid_otp_more:"Make sure your invite code is correct and try again.",cant_delete:"Can't delete.",cant_delete_more:"You don't have permissions to delete this post.",cant_interact:"Can't interact.",cant_interact_more:"You can't interact with this user for some reason.",blocking:"You are blocking this person.",blocking_more:"You need to unblock them to do this.",post_not_found:"Post not found.",invalid_poll:"Invalid poll.",poll_more_than_one:"Must have more than one option.",not_authenticated:"Not Authenticated.",not_authenticated_more:"You need to be logged in to do this.",ratelimit:"Ratelimited.",ratelimit_more:"Try again in a few seconds.",error_code:"Error code %c",cant_copy:"Unable to copy!",cant_copy_more:"Couldn't copy text to your clipboard. Are you using https?",passwords_dont_match:"Passwords don't match.",user_dne:"User '%u' does not exist."},numbers:{infinity:"Infinity",thousand:"%nk",million:"%nm",billion:"%nb",second:"%xs",minute:"%xm",hour:"%xh",day:"%xd",year:"%xy",minute_second:"%xm%ys",hour_minute:"%xh%ym",day_hour:"%xd%yh",year_day:"%xy%yd",future:"in %t"},titles:{base:"%l - %n",admin:"Administration",changes:"Changes",follow_requests:"Follow Requests",login:"Log In",logout:"Log Out",messages:"Messages",not_found:"Page Not Found",notifications:"Notifications",search:"Search",settings:"Settings",signup:"Sign Up"},post:{poll:{refresh:"Refresh",return_to_voting:"Return to voting",view_results:"View results",vote_count:{1:"%n vote","*":"%n vote"}},cw:{length:{1:"%n char","*":"%n chars"},has_quote:", quote",has_poll:", poll",reply:"RE: %c"},quote:{has_quote:"Includes a quote",has_poll:"Includes a poll",cant_view:"You can't view this quote."},tl_refresh:"Refresh",show_new:{1:"Show new post (%n)","*":"Show new posts (%n)"},copied:"A link to this post has been added to your clipboard.",copy_message:"Check out this post on %s! %p",embedded:"An IFrame code snippet has been copied to your clipboard.",deleted:"This post has been deleted.",cw_short:"CW: %c",poll_short:"Poll",followers_only:"Followers Only",cw_placeholder:"Content warning (optional)",poll_button:"Poll",poll_placeholder:"Option %n",poll_placeholder_optional:"Option %n (optional)",button:"Post",placeholder:"Cool post",quote_button:"Quote",quote_placeholder:["Cool quote","What did they say this time?","Yet another mistake to point out?","Ugh... not again..."],comment_button:"Reply",comment_placeholder:["Cool comment","Got something to say about this?","Let them know how you feel","Go spread your opinions, little one"],edit_button:"Save",edit_placeholder:"Cool post but edited",pinned:"Pinned to your profile.",unpinned:"This post is no longer pinned to your profile.",embed:"Embed",share:"Share",unpin:"Unpin",pin:"Pin",edit:"Edit",delete:"Delete",parent_link:"Comment Parent",home_link:"Home"},keybinds:{modifiers:{alt:"Alt",ctrl:"Ctrl",shift:"Shift",disabled:"DISABLED"},button_change:"Change",change_instructions:"Press the new key in the box above.",new_post:{name:"Enter Post Box",description:"Lets you send a post from anywhere"},load_new_posts:{name:"Load New Posts",description:"Shows any posts that have been made since the posts were initially loaded"},top_of_timeline:{name:"Jump to Top",description:"Jumps to the top of the current page"},nav_modifier:{name:"Navigation Modifier",description:"The key that needs to be pressed in order to use the other navigation keybinds"},nav_admin:"Admin Page",nav_home:"Home",nav_messages:"Messages",nav_notifications:"Notifications",nav_profile:"Your Profile",nav_settings:"Settings",hamburger_delete:"Delete Post",hamburger_pin:"Pin Post",hamburger_edit:"Edit Post",hamburger_share:"Share Post",hamburger_embed:"Embed Post"},settings:{profile:{title:"Profile",real_title:"Profile Settings",description:"Display name, banner colour...",profile_saved:"Your profile has been saved.",section_profile:"Your Profile",display_name:"Display name:",pronouns:"Pronouns:",pronouns_presets:["he/him","she/her","they/them","it/its"],pronouns_unset:"Unset",pronouns_custom:"Custom",pronouns_custom_placeholder:"Custom pronouns...",bio:"User bio:",banner:"Banner:",gradient:"Enable gradient banner?",save_profile:"Save",section_posts:"Posts",default_visibility:"Default post visibility:",vis_public:"Public",vis_private:"Followers Only",section_followers:"Followers",manually_approve:"Manually approve followers?"},cosmetic:{title:"Cosmetic",real_title:"Cosmetic Settings",description:"Website theme, tweaks...",section_colors:"Colours",themes:{label:"Theme:",system:"Automatic",light:"Light",dark:"Dark",warm:"Warm",gray:"Gray",darker:"Dark Gray",oled:"Black"},section_timestamps:"Timestamps",complex_ts:"Enable complex timestamps",complex_ts_more:"(1h becomes 1h32m, 5m becomes 5m48s)",section_language:"Languages",language:"Language:",section_font_size:"Font Size",font_size_example:"Aa",section_posts:"Posts",hide_interactions:"Hide interactions on posts",expand_cws:"Always expand content warnings",hide_changelog:"Hide changelog popups",no_like_grouping:"Don't group like notifications",auto_show_new:"Automatically show new posts on the timeline",auto_show_new_more:"When disabled, there will instead be a button to show new posts.",banner_shape:{label:"User banner icon shape:",none:"Hidden",square:"Square",round:"Rounded Square",circle:"Circle"},cw_cascading:{label:"Content warning cascading:",description:"What the content warning should be when commenting on a post with one.",none:"Don't set a content warning",email:'Prepend "RE: " (like an email)',copy:"Use existing content warning"}},keybinds:{title:"Keybinds",real_title:"Keybinds",description:"Navigation, send posts...",section_generic:"Generic Keybinds",section_nav:"Navigation Keybinds",section_hamburger:"Post Interaction Keybinds"},account:{title:"Account",real_title:"Account Settings",description:"Change password, delete account...",password_changed:"Your password has been changed.",section_change_password:"Change Password",current:"Current Password",new:"New Password",confirm:"Confirm Password",set:"Set Password",section_delete:"Delete Account",password:"Password",confirmation:"I confirm that this action %Bcan not be undone%b, and any data associated with this account (%u) will %Bnot be recoverable%b.",delete:"Delete My Account"},about:{title:"About",description:"Source code, credits...",section_credits:"Credits",lead_dev:"Lead Developer:",contributors:"Other Contributors:",translators:"Translators:",maintainers:"Maintainers:",past_maintainers:"Past Maintainers:",icons:"Some icons are from Font Awesome",section_call_to_action:"Found a bug? Have suggestions?",create_an_issue:"Create an issue on the GitHub repository!",suggestions_appreciated:"All suggestions and bug reports are greatly appreciated.",past_changes:"You can also view all past changes %h.",here:"here",section_special_thanks:"Special Thanks",thanks_intro:"Thank you to everyone who has reported issues, suggested features, and been active in the community.",thanks_body:"This project is created and maintained completely for free. No one has made a single penny off of Smiggins. This wouldn't exist today without your support. Thank you for using Smiggins, and we hope you enjoy it!",source:"Source Code",discord:"Discord Server"},import:"Import Settings...",export:"Export Settings...",log_out:"Log Out...",log_in:"Log In..."},admin:{title:"Administration",description:"Delete posts, generate invites...",delete_post:{title:"Delete Posts",pid:"Post ID:",button:"Delete Post"},delete_user:{title:"Delete User",success:"This user has been deleted.",username:"Username:",confirmation:"I confirm that this is the user I would like to permanently delete.",button:"Delete User"},generate_otp:{title:"Manage Invite Codes",generate:"Generate Code",list:"List Valid Codes",delete:"Delete",copied:"The invite code has been copied to your clipboard."},set_level:{title:"Set Admin Permissions",success:"Permissions saved.",username:"Username:",permission_warning:"Allows setting permissions for both self and others, including permissions they don't have",load:"Load Current Permissions",save:"Save Permissions"}},messages:{none:"No messages",title:{1:"%a",2:"%a and %b",3:"%a, %b, and %c",4:"%a, %b, %c, and <b>%n other</b>","*":"%a, %b, %c, and <b>%n others</b>"},placeholder:"Blah blah blah",create_group:"Create a Group",create_button:"Create Group",add_user:"Add User",cancel:"Cancel"},notifications:{like:{1:"%a liked your post.",2:"%a and %b liked your post.",3:"%a, %b, and %c liked your post.",4:"%a, %b, %c, and <b>%n other</b> liked your post.","*":"%a, %b, %c, and <b>%n others</b> liked your post."},follow:{1:"%a followed you.",2:"%a and %b followed you.",3:"%a, %b, and %c followed you.",4:"%a, %b, %c, and <b>%n other</b> followed you.","*":"%a, %b, %c, and <b>%n others</b> followed you."}},user:{follow:"Follow",unfollow:"Unfollow",pending:"Pending",block:"Block",unblock:"Unblock",no_bio:"No bio set",following_count:"following %n",followed_by_count:"followed by %n",posts_count:"%n posts",modal_close:"Close",follow_request_accept:"Accept",follow_request_deny:"Deny"},timeline:{user_main:"Posts",user_comments:"Include Comments",newest:"Newest",oldest:"Oldest",home_following:"Following",home_global:"Global",home_comments:"Comments"},login:{username:"Username",password:"Password",confirm:"Confirm Password",invite_code:"Invite Code",logout_info:"Click here if you don't get automatically redirected.",sign_up_button:"Sign Up",log_in_button:"Log In",new_accounts_disabled:"New accounts are currently disabled.",already_have_account:"Already have an account? Log in instead.",dont_have_account:"Don't have an account? Sign up instead."},search:{button:"Search",content_placeholder:"Post content",advanced:"Advanced Search",cw:"Content Warning:",cw_placeholder:"CW content (optional)",author:"Created by:",author_placeholder:"Username (optional)",quote:"Includes quote?",poll:"Includes poll?",comment:"Is comment?",any:"Any",yes:"Yes",no:"No"},not_found:{subtitle:"The url wasn't found",back:"Return Home"},update:{title:"%s has been updated!",view_changes:"View Changes",dismiss:"Dismiss"}},es:{meta:{id:"es",name:"Espaol",fallbacks:["en"],maintainers:[["pq-on-tempe2","pquirrel"]],past_maintainers:[]},version:"v%n",generic:{username:"Nombre para mostrar",success:"xito!",copied:"Copiado!",none:"Nada",pending_update:"Parece que %t fue actualizado. Recarga la pgina para ver los actualizaciones.\n\nSi este mensaje continuara apareciendo despus de recargar, contacta su administrador.\nCdigo: %c",loading:"Cargando...",load_more:"Carga Ms",sign_up_for_more:"Inscribese para ver ms!",toggle_password:"Ver Contrasea",back:"Atrs"},errors:{something_went_wrong:"Algo sali mal!",bad_username:"Nombre invlido.",username_no_user:"No usuario tiene este nombre.",username_characters:"Nombres para mostrar solo pueden incluir los carcteres a-z, 0-9, _, and -.",username_used:"Este nombre est ocupado.",bad_password:"Contrasea invlida.",invalid_otp:"Cdigo de invitacin invlido.",invalid_otp_more:"Make sure your invite code is correct and try again.",cant_delete:"No puede borrar.",cant_delete_more:"No tiene los permisos para borrar este publicacin.",cant_interact:"No puede interactuar.",cant_interact_more:"No puede interactuar con este usuario por alguno razn.",blocking:"Est bloqueando este usuario.",blocking_more:"Debera desbloquear este usuario para hacerlo.",post_not_found:"Este publicacin no fue encontrado.",invalid_poll:"Encuesta invlida.",poll_more_than_one:"Necesita ms de una opcin.",not_authenticated:"No tiene autenticacin.",not_authenticated_more:"Necesita iniciar una sesin para hacerlo.",ratelimit:"Ratelimited.",ratelimit_more:"Intntalo de nuevo en algunos segundos.",error_code:"Cdigo de error: %c",cant_copy:"No pudo copiarlo!",cant_copy_more:"No puede copiar el texto al portapapeles. Est usando https?",passwords_dont_match:"Contraseas no se combinan.",user_dne:"Usario '%u' no existe."},numbers:{infinity:"Infinito",thousand:"%nk",million:"%nm",billion:"%nb",second:"%xs",minute:"%xm",hour:"%xh",day:"%xd",year:"%xa",minute_second:"%xm%ys",hour_minute:"%xh%ym",day_hour:"%xd%yh",year_day:"%xa%yd",future:"en %t"},titles:{base:"%l - %n",admin:"Administracin",changes:"Cambios",follow_requests:"Solicitudes para seguirte",login:"Iniciar sesin",logout:"Cerrar sesin",messages:"Mensajes",not_found:"Pgina No Encontrado",notifications:"Notificaciones",search:"Buscar",settings:"Ajustes",signup:"Inscribirse"},post:{poll:{refresh:"Actualizar",return_to_voting:"Regresar a votar",view_results:"Ver resultados",vote_count:{1:"%n vota","*":"%n votas"}},cw:{length:{1:"%n car.","*":"%n cars."},has_quote:", cita",has_poll:", encuesta",reply:"RE: %c"},quote:{has_quote:"Incluye una cita",has_poll:"Incluye una encuesta",cant_view:"No puede ver esta cita."},tl_refresh:"Actualizar",show_new:{1:"Muestra publicacin nueva (%n)","*":"Muestra publicaciones nuevas (%n)"},copied:"Copiado un enlace a esta publicacin al portapapeles.",copy_message:"Mira esta publicacin en %s! %p",embedded:"Copiado un IFrame al portapapeles.",deleted:"Este publicacin fue borrado.",cw_short:"CW: %c",poll_short:"Encuesta",followers_only:"Solo para Seguidores",cw_placeholder:"Advertencia de Contenido (opcional)",poll_button:"Encuesta",poll_placeholder:"Opcin %n",poll_placeholder_optional:"Opcin %n (opcional)",button:"Publicar",placeholder:"Un miau o algo",quote_button:"Citar",quote_placeholder:["Una cita...","Qu se dice ahora...?","Otro error?","Otra vez..."],comment_button:"Responder",comment_placeholder:["Una nota...","Tiene algo que quiere decir?","Informase como se siente","Puede decir algo... o puede enviar un miau"],edit_button:"Guardar",edit_placeholder:"Otro tipo de miau",pinned:"La publicacin esta fijado a su perfil.",unpinned:"Este publicacin ya no esta fijado a su perfil.",embed:"Incrustar",share:"Compartir",unpin:"Desfijar",pin:"Fijar",edit:"Editar",delete:"Borrar",parent_link:"Nota Superior",home_link:"Inicio"},keybinds:{modifiers:{alt:"Alt",ctrl:"Ctrl",shift:"Shift",disabled:"DESHABILITADO"},button_change:"Cambiar",change_instructions:"Pulsa la tecla nueva en el cuadro arriba.",new_post:{name:"Entrar Cuadro de Publicar",description:"Se permite enviar un publicacin de cualquier lugar"},load_new_posts:{name:"Cargar Publicaciones Nuevas",description:"Muestra todas las publicaciones que fue creado desde cuando fueron cargados"},top_of_timeline:{name:"Saltar al principio",description:"Salta al principio de la pgina"},nav_modifier:{name:"Tecla modificador de navigacin",description:"La tecla que activa los otros comandos"},nav_admin:"Administracin",nav_home:"Inicio",nav_messages:"Mensajes",nav_notifications:"Notificaciones",nav_profile:"Perfil",nav_settings:"Ajustes",hamburger_delete:"Borrar publicacin",hamburger_pin:"Fijar publicacin",hamburger_edit:"Editar publicacin",hamburger_share:"Compartir publicacin",hamburger_embed:"Incrustar publicacin"},settings:{profile:{title:"Perfil",real_title:"Perfil",description:"Nombre de usuario, color del banner...",profile_saved:"Su perfil fue guardado.",section_profile:"Su Perfil",display_name:"Nombre de usuario:",pronouns:"Pronombres:",pronouns_presets:["l","ella","elle"],pronouns_unset:"-",pronouns_custom:"Personalizado",pronouns_custom_placeholder:"Pronombres personalizados...",bio:"Bo:",banner:"Banner:",gradient:"Activar banner con gradiente",save_profile:"Guardar",section_posts:"Publicaciones",default_visibility:"Visibilidad de publicacin por defecto:",vis_public:"Pblico",vis_private:"Solo seguidores",section_followers:"Seguidores",manually_approve:"Revisar seguidores nuevos"},cosmetic:{title:"Esttico",real_title:"Esttico",description:"Diseo del sitio, modificaciones...",section_colors:"Colores",themes:{label:"Diseo:",system:"Automtico",light:"Claro",dark:"Oscuro",warm:"Clido",gray:"Gris",darker:"Gris Oscuro",oled:"OLED"},section_timestamps:"Marcas de tiempo",complex_ts:"Activa marcas de tiempo detallados",complex_ts_more:"(1h  1h32m, 5m  5m48s)",section_language:"Idiomas",language:"Idioma:",section_font_size:"Tamao de fuente",font_size_example:"Aa",section_posts:"Publicaciones",hide_interactions:"Esconder interacciones en publicaciones",expand_cws:"Siempre abrir advertencias de contenido",hide_changelog:"Esconder registro de cambios",no_like_grouping:"No agrupar notificaciones de likes",auto_show_new:"Mostrar publicaciones nuevas en la biografa automticamente",auto_show_new_more:"Si no es activado, estara un botn para mostrar publicaciones nuevas.",banner_shape:{label:"Forma del cono del banner usuario:",none:"Escondido",square:"Cuadrado",round:"Cuadrado redondeado",circle:"Crculo"},cw_cascading:{label:"Catarada de Advertencias de contenido:",description:"Que la advertencia de contenido debe estar cuando notando una publicacin con uno.",none:"No pone un advertencia",email:'Adjuntar "RE: " (como email)',copy:"Usar advertencia actual"}},keybinds:{title:"Comandos",real_title:"Comandos",description:"Navigacin, enviar publicaciones...",section_generic:"Comandos genricos",section_nav:"Comandos de Navigacin",section_hamburger:"Comandos de Interacciones"},account:{title:"Cuenta",real_title:"Cuenta",description:"Cambiar contrasea, borrar cuenta...",password_changed:"Su contrasea fue cambiado.",section_change_password:"Cambiar contrasea",current:"Contrasea actual",new:"Contrasea nueva",confirm:"Confirma contrasea nueva",set:"Cambiar",section_delete:"Borrar cuenta",password:"Contrasea",confirmation:"Yo confirma que %Bno podra deshacer%b este accin, y que %Bno podra recuperar%b todo la informacin relacionado con este cuenta.",delete:"Borrar mi cuenta"},about:{title:"Acerca De",description:"Cdigo fuente, crditos...",section_credits:"Crditos",lead_dev:"Desarrollador Principal:",contributors:"Otros Contribuyentes:",translators:"Traductores:",maintainers:"Mantenedores:",past_maintainers:"Mantenedores Pasados:",icons:"Algunos conos son de Font Awesome",section_call_to_action:"Encontraste un error? Tienes recomendaciones?",create_an_issue:"Crea un cuestion en GitHub!",suggestions_appreciated:"Todos los recomendaciones y declaraciones de errores son apreciados.",past_changes:"Tambin, puedes ver todos los cambios pasados %h.",here:"aqu",section_special_thanks:"Agradecimientos Especiales",thanks_intro:"Gracias a todos quien han declarado cuestiones, han dado recomendaciones, y quien son activo en la comunidad.",thanks_body:"Este projecto esta creado y mantenido gratis. Nadie ha ganado ni uno centavo por Smiggins. No existe hoy sin su apoyo. Gracias por usando Smiggins, y esperamos que lo guste!",source:"Cdigo fuente",discord:"Servidor de Discord"},import:"Importar Ajustes...",export:"Exportar Ajustes...",log_out:"Cerrar sesin...",log_in:"Iniciar sesin..."},admin:{title:"Administracin",description:"Borrar publicaciones, crear invitaciones...",delete_post:{title:"Borrar publicaciones",pid:"ID de la publicacin:",button:"Borrar publicacin"},delete_user:{title:"Borrar usuario",success:"This user has been deleted.",username:"Nombre para mostrar: ",confirmation:"Yo confirma que este es el usuario que quiero borrar permanentemente.",button:"Borrar usuario"},generate_otp:{title:"Manejar cdigos de invitacin",generate:"Crear cdigo de invitacin",list:"Enumerar cdigos vlidos",delete:"Borrar",copied:"El cdigo de invitacin fue copiado al portapapeles."},set_level:{title:"Permisos de administracin",success:"Guard los permisos.",username:"Nombre para mostrar: ",permission_warning:"Permite cambiar permisos a s mismo y a otros, incluyendo permisos que no tiene.",load:"Cargar Permisos Actuales",save:"Guardar Permisos"}},messages:{none:"No mensajes",title:{1:"%a",2:"%a y %b",3:"%a, %b, y %c",4:"%a, %b, %c, y <b>%n otro</b>","*":"%a, %b, %c, y <b>%n otros</b>"},placeholder:"Miau Miau",create_group:"Crear un Grupo",create_button:"Crear Grupo",add_user:"Aadir un Usuario",cancel:"Cancelar"},notifications:{like:{1:"%a dio un like a tu publicacin.",2:"%a y %b dieron likes a tu publicacin.",3:"%a, %b, y %c dieron likes a tu publicacin.",4:"%a, %b, %c, y <b>%n otro</b> dieron likes a tu publicacin.","*":"%a, %b, %c, y <b>%n otros</b> dieron likes a tu publicacin."},follow:{1:"%a followed you.",2:"%a and %b followed you.",3:"%a, %b, and %c followed you.",4:"%a, %b, %c, and <b>%n other</b> followed you.","*":"%a, %b, %c, and <b>%n others</b> followed you."}},user:{follow:"Seguir",unfollow:"Dejar de seguir",pending:"Pendiente",block:"Bloquear",unblock:"Desbloquear",no_bio:"No bo esta presente",following_count:"%n Siguiendo",followed_by_count:"%n Seguidores",posts_count:"%n publicaciones",modal_close:"Cerrar",follow_request_accept:"Aceptar",follow_request_deny:"Rechazar"},timeline:{user_main:"Publicaciones",user_comments:"Con Notas",newest:"Ms nuevo",oldest:"Ms viejo",home_following:"Seguidores",home_global:"Global",home_comments:"Notas"},login:{username:"Nombre para mostrar",password:"Contrasea",confirm:"Confirma Contrasea",invite_code:"Cdigo de invitacin",logout_info:"Haz clic aqu si no ha sido redirigido automticamente",sign_up_button:"Inscribirse",log_in_button:"Iniciar sesin",new_accounts_disabled:"Se ha cerrado crear nuevas cuentas.",already_have_account:"Ya tienes una cuenta? Mejor iniciar una sesin.",dont_have_account:"No tienes una cuenta? Mejor inscribirse."},search:{button:"Buscar",content_placeholder:"Contenido de la publicacin",advanced:"Avanzada",cw:"Advertencia de Contenido:",cw_placeholder:"Contenido de la AC (opcional)",author:"Creado por:",author_placeholder:"Nombre para mostrar (opcional)",quote:"Con una cita?",poll:"Con una encuesta?",comment:"Es una Nota?",any:"Cualquier",yes:"S",no:"No"},not_found:{subtitle:"No se encontr el URL",back:"Volver a inicio"},update:{title:"%s haba actualizado!",view_changes:"Mirar a los Cambios",dismiss:"Descartar"}}},DEFAULT_LANGUAGE="en",L,RE_TLDs=(L=(L=LANGS[localStorage.getItem("smiggins-language")||DEFAULT_LANGUAGE])||LANGS[DEFAULT_LANGUAGE],"aaa|aarp|abb|abbott|abbvie|abc|able|abogado|abudhabi|ac|academy|accenture|accountant|accountants|aco|actor|ad|ads|adult|ae|aeg|aero|aetna|af|afl|africa|ag|agakhan|agency|ai|aig|airbus|airforce|airtel|akdn|al|alibaba|alipay|allfinanz|allstate|ally|alsace|alstom|am|amazon|americanexpress|americanfamily|amex|amfam|amica|amsterdam|analytics|android|anquan|anz|ao|aol|apartments|app|apple|aq|aquarelle|ar|arab|aramco|archi|army|arpa|art|arte|as|asda|asia|associates|at|athleta|attorney|au|auction|audi|audible|audio|auspost|author|auto|autos|aw|aws|ax|axa|az|azure|ba|baby|baidu|banamex|band|bank|bar|barcelona|barclaycard|barclays|barefoot|bargains|baseball|basketball|bauhaus|bayern|bb|bbc|bbt|bbva|bcg|bcn|bd|be|beats|beauty|beer|berlin|best|bestbuy|bet|bf|bg|bh|bharti|bi|bible|bid|bike|bing|bingo|bio|biz|bj|black|blackfriday|blockbuster|blog|bloomberg|blue|bm|bms|bmw|bn|bnpparibas|bo|boats|boehringer|bofa|bom|bond|boo|book|booking|bosch|bostik|boston|bot|boutique|box|br|bradesco|bridgestone|broadway|broker|brother|brussels|bs|bt|build|builders|business|buy|buzz|bv|bw|by|bz|bzh|ca|cab|cafe|cal|call|calvinklein|cam|camera|camp|canon|capetown|capital|capitalone|car|caravan|cards|care|career|careers|cars|casa|case|cash|casino|cat|catering|catholic|cba|cbn|cbre|cc|cd|center|ceo|cern|cf|cfa|cfd|cg|ch|chanel|channel|charity|chase|chat|cheap|chintai|christmas|chrome|church|ci|cipriani|circle|cisco|citadel|citi|citic|city|ck|cl|claims|cleaning|click|clinic|clinique|clothing|cloud|club|clubmed|cm|cn|co|coach|codes|coffee|college|cologne|com|commbank|community|company|compare|computer|comsec|condos|construction|consulting|contact|contractors|cooking|cool|coop|corsica|country|coupon|coupons|courses|cpa|cr|credit|creditcard|creditunion|cricket|crown|crs|cruise|cruises|cu|cuisinella|cv|cw|cx|cy|cymru|cyou|cz|dad|dance|data|date|dating|datsun|day|dclk|dds|de|deal|dealer|deals|degree|delivery|dell|deloitte|delta|democrat|dental|dentist|desi|design|dev|dhl|diamonds|diet|digital|direct|directory|discount|discover|dish|diy|dj|dk|dm|dnp|do|docs|doctor|dog|domains|dot|download|drive|dtv|dubai|dunlop|dupont|durban|dvag|dvr|dz|earth|eat|ec|eco|edeka|edu|education|ee|eg|email|emerck|energy|engineer|engineering|enterprises|epson|equipment|er|ericsson|erni|es|esq|estate|et|eu|eurovision|eus|events|exchange|expert|exposed|express|extraspace|fage|fail|fairwinds|faith|family|fan|fans|farm|farmers|fashion|fast|fedex|feedback|ferrari|ferrero|fi|fidelity|fido|film|final|finance|financial|fire|firestone|firmdale|fish|fishing|fit|fitness|fj|fk|flickr|flights|flir|florist|flowers|fly|fm|fo|foo|food|football|ford|forex|forsale|forum|foundation|fox|fr|free|fresenius|frl|frogans|frontier|ftr|fujitsu|fun|fund|furniture|futbol|fyi|ga|gal|gallery|gallo|gallup|game|games|gap|garden|gay|gb|gbiz|gd|gdn|ge|gea|gent|genting|george|gf|gg|ggee|gh|gi|gift|gifts|gives|giving|gl|glass|gle|global|globo|gm|gmail|gmbh|gmo|gmx|gn|godaddy|gold|goldpoint|golf|goo|goodyear|goog|google|gop|got|gov|gp|gq|gr|grainger|graphics|gratis|green|gripe|grocery|group|gs|gt|gu|gucci|guge|guide|guitars|guru|gw|gy|hair|hamburg|hangout|haus|hbo|hdfc|hdfcbank|health|healthcare|help|helsinki|here|hermes|hiphop|hisamitsu|hitachi|hiv|hk|hkt|hm|hn|hockey|holdings|holiday|homedepot|homegoods|homes|homesense|honda|horse|hospital|host|hosting|hot|hotels|hotmail|house|how|hr|hsbc|ht|hu|hughes|hyatt|hyundai|ibm|icbc|ice|icu|id|ie|ieee|ifm|ikano|il|im|imamat|imdb|immo|immobilien|in|inc|industries|infiniti|info|ing|ink|institute|insurance|insure|int|international|intuit|investments|io|ipiranga|iq|ir|irish|is|ismaili|ist|istanbul|it|itau|itv|jaguar|java|jcb|je|jeep|jetzt|jewelry|jio|jll|jm|jmp|jnj|jo|jobs|joburg|jot|joy|jp|jpmorgan|jprs|juegos|juniper|kaufen|kddi|ke|kerryhotels|kerryproperties|kfh|kg|kh|ki|kia|kids|kim|kindle|kitchen|kiwi|km|kn|koeln|komatsu|kosher|kp|kpmg|kpn|kr|krd|kred|kuokgroup|kw|ky|kyoto|kz|la|lacaixa|lamborghini|lamer|land|landrover|lanxess|lasalle|lat|latino|latrobe|law|lawyer|lb|lc|lds|lease|leclerc|lefrak|legal|lego|lexus|lgbt|li|lidl|life|lifeinsurance|lifestyle|lighting|like|lilly|limited|limo|lincoln|link|live|living|lk|llc|llp|loan|loans|locker|locus|lol|london|lotte|lotto|love|lpl|lplfinancial|lr|ls|lt|ltd|ltda|lu|lundbeck|luxe|luxury|lv|ly|ma|madrid|maif|maison|makeup|man|management|mango|map|market|marketing|markets|marriott|marshalls|mattel|mba|mc|mckinsey|md|me|med|media|meet|melbourne|meme|memorial|men|menu|merckmsd|mg|mh|miami|microsoft|mil|mini|mint|mit|mitsubishi|mk|ml|mlb|mls|mm|mma|mn|mo|mobi|mobile|moda|moe|moi|mom|monash|money|monster|mormon|mortgage|moscow|moto|motorcycles|mov|movie|mp|mq|mr|ms|msd|mt|mtn|mtr|mu|museum|music|mv|mw|mx|my|mz|na|nab|nagoya|name|navy|nba|nc|ne|nec|net|netbank|netflix|network|neustar|new|news|next|nextdirect|nexus|nf|nfl|ng|ngo|nhk|ni|nico|nike|nikon|ninja|nissan|nissay|nl|no|nokia|norton|now|nowruz|nowtv|np|nr|nra|nrw|ntt|nu|nyc|nz|obi|observer|office|okinawa|olayan|olayangroup|ollo|om|omega|one|ong|onl|online|ooo|open|oracle|orange|org|organic|origins|osaka|otsuka|ott|ovh|pa|page|panasonic|paris|pars|partners|parts|party|pay|pccw|pe|pet|pf|pfizer|pg|ph|pharmacy|phd|philips|phone|photo|photography|photos|physio|pics|pictet|pictures|pid|pin|ping|pink|pioneer|pizza|pk|pl|place|play|playstation|plumbing|plus|pm|pn|pnc|pohl|poker|politie|porn|post|pr|praxi|press|prime|pro|prod|productions|prof|progressive|promo|properties|property|protection|pru|prudential|ps|pt|pub|pw|pwc|py|qa|qpon|quebec|quest|racing|radio|re|read|realestate|realtor|realty|recipes|red|redumbrella|rehab|reise|reisen|reit|reliance|ren|rent|rentals|repair|report|republican|rest|restaurant|review|reviews|rexroth|rich|richardli|ricoh|ril|rio|rip|ro|rocks|rodeo|rogers|room|rs|rsvp|ru|rugby|ruhr|run|rw|rwe|ryukyu|sa|saarland|safe|safety|sakura|sale|salon|samsclub|samsung|sandvik|sandvikcoromant|sanofi|sap|sarl|sas|save|saxo|sb|sbi|sbs|sc|scb|schaeffler|schmidt|scholarships|school|schule|schwarz|science|scot|sd|se|search|seat|secure|security|seek|select|sener|services|seven|sew|sex|sexy|sfr|sg|sh|shangrila|sharp|shell|shia|shiksha|shoes|shop|shopping|shouji|show|si|silk|sina|singles|site|sj|sk|ski|skin|sky|skype|sl|sling|sm|smart|smile|sn|sncf|so|soccer|social|softbank|software|sohu|solar|solutions|song|sony|soy|spa|space|sport|spot|sr|srl|ss|st|stada|staples|star|statebank|statefarm|stc|stcgroup|stockholm|storage|store|stream|studio|study|style|su|sucks|supplies|supply|support|surf|surgery|suzuki|sv|swatch|swiss|sx|sy|sydney|systems|sz|tab|taipei|talk|taobao|target|tatamotors|tatar|tattoo|tax|taxi|tc|tci|td|tdk|team|tech|technology|tel|temasek|tennis|teva|tf|tg|th|thd|theater|theatre|tiaa|tickets|tienda|tips|tires|tirol|tj|tjmaxx|tjx|tk|tkmaxx|tl|tm|tmall|tn|to|today|tokyo|tools|top|toray|toshiba|total|tours|town|toyota|toys|tr|trade|trading|training|travel|travelers|travelersinsurance|trust|trv|tt|tube|tui|tunes|tushu|tv|tvs|tw|tz|ua|ubank|ubs|ug|uk|unicom|university|uno|uol|ups|us|uy|uz|va|vacations|vana|vanguard|vc|ve|vegas|ventures|verisign|versicherung|vet|vg|vi|viajes|video|vig|viking|villas|vin|vip|virgin|visa|vision|viva|vivo|vlaanderen|vn|vodka|volvo|vote|voting|voto|voyage|vu|wales|walmart|walter|wang|wanggou|watch|watches|weather|weatherchannel|webcam|weber|website|wed|wedding|weibo|weir|wf|whoswho|wien|wiki|williamhill|win|windows|wine|winners|wme|wolterskluwer|woodside|work|works|world|wow|ws|wtc|wtf|xbox|xerox|xihuan|xin|xn--11b4c3d|xn--1ck2e1b|xn--1qqw23a|xn--2scrj9c|xn--30rr7y|xn--3bst00m|xn--3ds443g|xn--3e0b707e|xn--3hcrj9c|xn--3pxu8k|xn--42c2d9a|xn--45br5cyl|xn--45brj9c|xn--45q11c|xn--4dbrk0ce|xn--4gbrim|xn--54b7fta0cc|xn--55qw42g|xn--55qx5d|xn--5su34j936bgsg|xn--5tzm5g|xn--6frz82g|xn--6qq986b3xl|xn--80adxhks|xn--80ao21a|xn--80aqecdr1a|xn--80asehdb|xn--80aswg|xn--8y0a063a|xn--90a3ac|xn--90ae|xn--90ais|xn--9dbq2a|xn--9et52u|xn--9krt00a|xn--b4w605ferd|xn--bck1b9a5dre4c|xn--c1avg|xn--c2br7g|xn--cck2b3b|xn--cckwcxetd|xn--cg4bki|xn--clchc0ea0b2g2a9gcd|xn--czr694b|xn--czrs0t|xn--czru2d|xn--d1acj3b|xn--d1alf|xn--e1a4c|xn--eckvdtc9d|xn--efvy88h|xn--fct429k|xn--fhbei|xn--fiq228c5hs|xn--fiq64b|xn--fiqs8s|xn--fiqz9s|xn--fjq720a|xn--flw351e|xn--fpcrj9c3d|xn--fzc2c9e2c|xn--fzys8d69uvgm|xn--g2xx48c|xn--gckr3f0f|xn--gecrj9c|xn--gk3at1e|xn--h2breg3eve|xn--h2brj9c|xn--h2brj9c8c|xn--hxt814e|xn--i1b6b1a6a2e|xn--imr513n|xn--io0a7i|xn--j1aef|xn--j1amh|xn--j6w193g|xn--jlq480n2rg|xn--jvr189m|xn--kcrx77d1x4a|xn--kprw13d|xn--kpry57d|xn--kput3i|xn--l1acc|xn--lgbbat1ad8j|xn--mgb9awbf|xn--mgba3a3ejt|xn--mgba3a4f16a|xn--mgba7c0bbn0a|xn--mgbaam7a8h|xn--mgbab2bd|xn--mgbah1a3hjkrd|xn--mgbai9azgqp6j|xn--mgbayh7gpa|xn--mgbbh1a|xn--mgbbh1a71e|xn--mgbc0a9azcg|xn--mgbca7dzdo|xn--mgbcpq6gpa1a|xn--mgberp4a5d4ar|xn--mgbgu82a|xn--mgbi4ecexp|xn--mgbpl2fh|xn--mgbt3dhd|xn--mgbtx2b|xn--mgbx4cd0ab|xn--mix891f|xn--mk1bu44c|xn--mxtq1m|xn--ngbc5azd|xn--ngbe9e0a|xn--ngbrx|xn--node|xn--nqv7f|xn--nqv7fs00ema|xn--nyqy26a|xn--o3cw4h|xn--ogbpf8fl|xn--otu796d|xn--p1acf|xn--p1ai|xn--pgbs0dh|xn--pssy2u|xn--q7ce6a|xn--q9jyb4c|xn--qcka1pmc|xn--qxa6a|xn--qxam|xn--rhqv96g|xn--rovu88b|xn--rvc1e0am3e|xn--s9brj9c|xn--ses554g|xn--t60b56a|xn--tckwe|xn--tiq49xqyj|xn--unup4y|xn--vermgensberater-ctb|xn--vermgensberatung-pwb|xn--vhquv|xn--vuq861b|xn--w4r85el8fhu5dnra|xn--w4rs40l|xn--wgbh1c|xn--wgbl6a|xn--xhq521b|xn--xkc2al3hye2a|xn--xkc2dl3a5ee0h|xn--y9a3aq|xn--yfro4i67o|xn--ygbi2ammx|xn--zfr164b|xxx|xyz|yachts|yahoo|yamaxun|yandex|ye|yodobashi|yoga|yokohama|you|youtube|yt|yun|za|zappos|zara|zero|zip|zm|zone|zuerich|zw"),RE_IP_NUM="25[0-5]|2[0-4][0-9]|1?[0-9]{1,2}",RE_PORTS=":(?:6553[0-5]|655[0-2][0-9]|65[0-4][0-9]{2}|6[0-4][0-9]{3}|[0-5][0-9]{4}|[1-9][0-9]{0,3})",urlRegex=new RegExp(`(?:https?:\\/\\/)?(?:(?:${RE_IP_NUM}\\.){3}(?:${RE_IP_NUM})|(?:[\\-a-z0-9]+\\.){1,}(?:${RE_TLDs}))\\b(?:${RE_PORTS}\\b)?(?:/(?:&amp;|[\\-a-zA-Z0-9@:%_\\+.~#?\\/=])*)?`,"g"),mentionRegex=new RegExp(`@([a-zA-Z0-9_\\-]{1,${limits.username}})\\b`,"g"),hashtagRegex=/#([a-zA-Z_][a-zA-Z0-9_]{0,63})\b/g;function withinBounds(e,t,n){for(var o of n)if(o.index<=e&&o.index+o.length-1>=e||o.index<=e+t-1&&o.index+o.length-1>=e+t-1||o.index>=e&&o.index+o.length-1<=e+t-1)return!0;return!1}function urlReplacements(e,t){t.sort((e,t)=>t.index-e.index);for(var n of t){var o=`<a href="${n.href}" ${n.hiddenLink?'class="plain-link"':""} ${n.internalIntent?`data-internal-link="${n.internalIntent}"`:'target="_blank"'}>`;e=e.slice(0,n.index)+o+e.slice(n.index,n.index+n.length)+"</a>"+e.slice(n.index+n.length)}return e}function linkify(t,n){var o,e,a,s=[];for(o of t.matchAll(urlRegex)){let e=o[0];e.startsWith("https://")||e.startsWith("http://")||(e="https://"+e),s.push({index:o.index,length:o[0].length,href:unescapeHTML(e)})}for(e of t.matchAll(mentionRegex))withinBounds(e.index,e[0].length,s)||s.push({index:e.index,length:e[0].length,href:`/u/${e[1]}/`,internalIntent:"user"});for(a of t.matchAll(hashtagRegex))withinBounds(a.index,a[0].length,s)||s.push({index:a.index,length:a[0].length,href:`/tag/${a[1].toLowerCase()}/`,internalIntent:"hashtag"});if(n){var i,r="number"==typeof n?`/p/${n}/`:`/u/${n}/`,l=[];let e=0;s.sort((e,t)=>e.index-t.index);for(i of s)0<i.index-e&&l.push({index:e,length:i.index-e,href:r,internalIntent:"number"==typeof n?"post":"user",hiddenLink:!0}),e=i.index+i.length;var c=s[s.length-1];c&&c.index+c.length<t.length?l.push({index:c.index+c.length,length:t.length-c.index-c.length,href:r,internalIntent:"number"==typeof n?"post":"user",hiddenLink:!0}):c||l.push({index:0,length:t.length,href:r,internalIntent:"number"==typeof n?"post":"user",hiddenLink:!0}),s.push(...l)}return urlReplacements(t,s)}let postModalFor=void 0;function createPostModal(n,o){if(!document.getElementById("modal")&&loggedIn){let e={hidden_if_no_quote:"hidden",hidden_if_no_comment:"hidden",hidden_if_no_poll:"",poll_items:getPollInputsHTML("modal","#modal-post"),private_post:"",placeholder:L.post.placeholder,action:L.post.button};if(postModalFor=void 0,n&&void 0!==o){var a=postCache[o];if(!a)return void console.log("post modal post not found",o);postModalFor={type:n,id:o},e={placeholder:L.post.placeholder,action:L.post.button,hidden_if_no_quote:"hidden",hidden_if_no_comment:"hidden",hidden_if_no_poll:"",poll_items:getPollInputsHTML("modal","#modal-post"),private_post:a.private?"data-private-post":"",username:a.user.username,timestamp:getTimestamp(a.timestamp),checked_if_private:defaultPostPrivate||("comment"===n||"quote"===n)&&a.private?"checked":"",content:[simplePostContent(a),1],display_name:[escapeHTML(a.user.display_name),1],content_2:[simplePostContent(a),1],display_name_2:[escapeHTML(a.user.display_name),1]},"quote"===n?(e.hidden_if_no_quote="",e.action=L.post.quote_button,e.placeholder=L.post.quote_placeholder[Math.floor(Math.random()*L.post.quote_placeholder.length)]):"comment"===n?(e.hidden_if_no_comment="",e.action=L.post.comment_button,e.placeholder=L.post.comment_placeholder[Math.floor(Math.random()*L.post.comment_placeholder.length)]):"edit"===n&&(e.action=L.post.edit_button,e.placeholder=L.post.edit_placeholder,e.hidden_if_no_poll="hidden")}let t=getSnippet("modal/compose",e);if(null!=(a=t.querySelector("#modal-post"))&&a.addEventListener("click",postModalCreatePost),null!=(a=t.querySelector("#modal"))&&a.addEventListener("click",clearModalIfClicked),document.body.append(t),null!=(a=t.querySelector("#modal-post-content"))&&a.focus(),null!=(a=t.querySelector("#modal-poll-toggle"))&&a.addEventListener("click",function(){var e=t.querySelector("#modal-poll-area");e&&(e.hidden=!e.hidden)}),document.addEventListener("keydown",clearModalOnEscape),"edit"===n&&void 0!==o){var a=postCache[o];if(!a)return;a.content_warning&&(s=t.querySelector("#modal-post-cw"))&&(s.value=a.content_warning);var s=t.querySelector("#modal-post-content"),s=(s&&(s.value=a.content),t.querySelector("#modal-post-private"));s&&(s.checked=a.private)}else if("comment"===n&&void 0!==o){s=postCache[o];if(!s)return;a=t.querySelector("#modal-post-content");a&&(a.value=getPostMentionsString(s))}"comment"!==n&&"quote"!==n||void 0===o||(a=postCache[o])&&(s=t.querySelector("#modal-post-cw"))&&(s.value=getPostTemplatedCW(a))}}function createUpdateModal(e){document.getElementById("modal")||(document.body.append(getSnippet("modal/update",{since:e,update_title:lr(L.update.title,{s:pageTitle})})),null!=(e=document.getElementById("modal"))&&e.addEventListener("click",clearModalIfClicked),document.addEventListener("keydown",clearModalOnEscape))}function createFollowingModal(e,t){var n;document.getElementById("modal")||(n=userCache[t]&&userCache[t].display_name||t,document.body.append(getSnippet("modal/following",{title:"following"===e?`${n} follows:`:`${n} is followed by:`})),hookFollowingTimeline(e,t),null!=(n=document.getElementById("modal"))&&n.addEventListener("click",clearModalIfClicked),document.addEventListener("keydown",clearModalOnEscape))}function modifyKeybindModal(o){let e,t,n,a=keybinds[o];var s=getSnippet("modal/keybind",{keybind_title:a.name||"",keybind_description:a.description||"",hidden_if_no_description:a.description?"":"hidden"});forceDisableKeybinds=!0,null!=(e=s.querySelector("#kb-modal-input"))&&e.addEventListener("keydown",e=>{if(!["shift","alt","control","meta"," "].includes(e.key.toLowerCase()))if(setKeybindKey(o,e.key,{alt:e.altKey,ctrl:e.ctrlKey,nav:a.modifiers&&a.modifiers.includes("nav"),shift:e.shiftKey})){if("navModifier"===o)for(var t of document.querySelectorAll('[data-kb-id^="nav"]'))setKeybindElementData(t.dataset.kbId||o,t);var n=document.querySelector(`[data-kb-id="${o}"]`);n&&setKeybindElementData(o,n),clearModal()}else createToast("Key already in use");e.preventDefault()}),document.body.append(s),null!=(t=s.querySelector("#kb-modal-input"))&&t.focus(),null!=(n=s.querySelector("#modal"))&&n.addEventListener("click",clearModalIfClicked),document.addEventListener("keydown",clearModalOnEscape)}function newMessageModal(){var e;document.getElementById("modal")||(document.body.append(getSnippet("modal/message")),null!=(e=document.getElementById("message-modal-add"))&&e.addEventListener("click",()=>{var e,t=document.querySelectorAll("#message-modal-inputs input").length;255<=t||(null!=(e=document.querySelector("#message-modal-inputs input:not([data-enter-next])"))&&e.setAttribute("data-enter-next",`#message-modal-inputs :nth-child(${t+1}) input`),null!=(e=document.getElementById("message-modal-inputs"))&&e.insertAdjacentHTML("beforeend",`<div>@<input autofocus data-enter-submit="#message-modal-create" placeholder="${L.generic.username}"></div>`),null!=(e=document.querySelector("#message-modal-inputs input:not([data-enter-next])"))&&e.addEventListener("keydown",inputEnterEvent),null!=(e=document.querySelector("#message-modal-inputs input:not([data-enter-next])"))&&e.focus(),254<=t&&null!=(e=document.getElementById("message-modal-add"))&&e.setAttribute("hidden",""))}),null!=(e=document.getElementById("message-modal-create"))&&e.addEventListener("click",()=>{var e=[...document.querySelectorAll("#message-modal-inputs input")].map(e=>e.value.toLowerCase()).filter(Boolean);e.length&&new api_MessageGetGID(e,document.getElementById("message-modal-create")).fetch()}),null!=(e=document.getElementById("modal"))&&e.addEventListener("click",clearModalIfClicked))}function postModalCreatePost(i){var e=document.getElementById("modal-post-cw");let r=document.getElementById("modal-post-content");var t=document.getElementById("modal-post-private");if(e&&r&&t){let o=e.value,a=r.value,s=t.checked;var n=[];if(!postModalFor||"edit"!==postModalFor.type)for(var l of document.querySelectorAll(':not([hidden]) > div > [data-poll-input="modal"]'))l.value&&n.push(l.value);a||0!==n.length?(null!=(e=i.target)&&e.setAttribute("disabled",""),postModalFor&&"edit"===postModalFor.type?new api_EditPost(postModalFor.id,a,o,s,i.target).fetch().then(e=>{if(e&&postModalFor){var t=postCache[postModalFor.id];if(clearModal(),t){t.content=a,t.content_warning=o,t.private=s,t.edited=!0;for(var n of document.querySelectorAll(`[data-edit-replace="${postModalFor.id}"]`))n.replaceWith(getPost(t.id,!1))}}else r.focus()}):(t={},postModalFor&&(t[postModalFor.type]=postModalFor.id),0!==n.length&&(t.poll=n),createPost(a,o||null,s,e=>{var t,n;if(e){if(postModalFor&&"quote"===postModalFor.type)for(t of document.querySelectorAll(`[data-interaction-quote="${postModalFor.id}"] [data-number]`))isNaN(+t.innerText)||(t.innerText=String(+t.innerText+1));else if(postModalFor&&"comment"===postModalFor.type)for(n of document.querySelectorAll(`[data-interaction-comment="${postModalFor.id}"] [data-number]`))isNaN(+n.innerText)||(n.innerText=String(+n.innerText+1));clearModal()}else r.focus(),null!=(e=i.target)&&e.removeAttribute("disabled")},t))):r.focus()}}function clearModalOnEscape(e){"Escape"===e.key&&(clearModal(),document.removeEventListener("keydown",clearModalOnEscape),e.preventDefault())}function clearModalIfClicked(e){void 0!==(null==(e=e.target)?void 0:e.dataset.closeModal)&&clearModal()}function clearModal(){var e;null!=(e=document.getElementById("modal"))&&e.remove(),forceDisableKeybinds=!1}let container=document.getElementById("container");function urlToIntent(e){if(e=normalizePath(e),loggedIn)switch(e){case"/home/":case"/login/":case"/signup/":history.pushState("home","","/");case"/":return"home";case"/notifications/":return"notifications";case"/follow-requests/":return"follow-requests";case"/search/":return"search";case"/messages/":return"message-list";case"/settings/profile/":return"settings/profile";case"/settings/keybinds/":return"settings/keybinds";case"/settings/account/":return"settings/account";case isAdmin&&"/admin/":return"admin";case/^\/tag\/[a-z0-9_]+\/$/.test(e)?e:"":return"hashtag";case/^\/message\/[0-9]+\/$/.test(e)?e:"":return"message"}else switch(e){case"/":return"index";case"/login/":return"login";case"/signup/":return"signup"}switch(e){case"/logout/":return"logout";case/^\/u\/[a-z0-9_\-]+\/$/.test(e)?e:"":return"user";case/^\/p\/[0-9]+\/$/.test(e)?e:"":return"post";case"/settings/":return"settings";case"/settings/cosmetic/":return"settings/cosmetic";case"/settings/about/":return"settings/about";case"/changes/all/":case/^\/changes\/[0-9]+\.[0-9]+\.[0-9]\/$/.test(e)?e:"":return"changelog";default:return"404"}}function generateInternalLinks(e){var t;for(t of(e=e||container).querySelectorAll("[data-internal-link]:not([data-link-processed])"))t.dataset.linkProcessed="",IS_IFRAME?t.setAttribute("target","_blank"):t.addEventListener("click",internalLinkHandler)}function internalLinkHandler(t){if(!t.ctrlKey){var n=t.currentTarget,o=n.dataset.internalLink;let e=n.href||null;(e=null!=e&&e.includes("//")?"/"+e.split("//")[1].split("/").slice(1).join("/"):e)&&"post"===o&&getPostIDFromPath(e)===getPostIDFromPath()?createPostModal("comment",getPostIDFromPath()):(o!==currentPage||"post"===o||e&&"user"===o&&getUsernameFromPath(e)!==getUsernameFromPath()||e&&"hashtag"===o&&getHashtagFromPath(e)!==getHashtagFromPath())&&(history.pushState(o,"",e),renderPage(o),currentPage=o),t.preventDefault()}}function normalizePath(e,t){return(e=e.split("?")[0].endsWith("/")?e:e.split("?")[0]+"/"+e.split("?").slice(1).map(e=>"?"+e)).startsWith("/")||(e="/"+e),t?e.toLowerCase():e.toLowerCase().split("?")[0]}function renderPage(e){let t={},n;switch(clearModal(),e){case"home":t={poll_items:getPollInputsHTML("home","#post")};break;case"user":var o=getUsernameFromPath();n=userCache[o],t={color_one:n&&n.color_one||"var(--background-mid)",color_two:n&&n.color_two||"var(--background-mid)",following:lr(L.user.following_count,{n:n&&floatintToStr(n.num_following)||"0"}),followers:lr(L.user.followed_by_count,{n:n&&floatintToStr(n.num_followers)||"0"}),post_count:lr(L.user.posts_count,{n:n&&floatintToStr(n.num_posts)||"0"}),bio:n?[linkify(escapeHTML(n.bio)),1]:"",user_username:n?[escapeHTML(o+(n.pronouns?" - "+n.pronouns:"")),1]:o,display_name:n?[escapeHTML(n.display_name),1]:o};break;case"settings/profile":o=window.getComputedStyle(document.documentElement).getPropertyValue("--background-mid");n=userCache[username],t={color_one:n&&n.color_one||o,color_two:n&&n.color_two||o,checked_if_gradient:n&&n.color_one&&n.color_two&&n.color_one!==n.color_two?"checked":"",display_name:n&&escapeHTML(n.display_name)||username,bio:n&&escapeHTML(n.bio)||"",pronouns_presets:L.settings.profile.pronouns_presets.map(e=>`<option value="${e}">${e}</option>`).join("")};break;case"settings/cosmetic":t={language_selection:Object.values(LANGS).map(e=>`<option value="${e.meta.id}">${escapeHTML(e.meta.name)}</option>`).join("")};break;case"settings/account":t={delete_account_confirmation:lr(L.settings.account.confirmation,{B:'<span class="warning">',b:"</span>",u:`<b>@${username}</b>`})};break;case"settings/about":var a,s=e=>e[0]?`<li><a target="_blank" href="https://github.com/${e[0]}/">${escapeHTML(e[1])}</a></li>`:`<li>${escapeHTML(e[1])}</li>`;let e="";for(a of Object.values(LANGS))e=(e+=`<li><b>${escapeHTML(a.meta.name)}</b>:<ul class="no-margin-top">`)+`<li><div>${L.settings.about.maintainers}</div>`,a.meta.maintainers.length?e+=`<ul class="no-margin-top">${a.meta.maintainers.map(s)}</ul>`:e=e.slice(0,e.length-6)+` <i>${L.generic.none}</i></div>`,e+=`</li>`,a.meta.past_maintainers.length&&(e+=`<li>${L.settings.about.past_maintainers}<ul class="no-margin-top">${a.meta.past_maintainers.map(s)}</ul></li>`),e+="</ul></li>";t={changes_link:lr(L.settings.about.past_changes,{h:`<a href="/changes/all/" data-internal-link="changelog">${L.settings.about.here}</a>`}),translator_credits:`<ul class="no-margin-top">${e}</ul>`};break;case"post":var o=getPostIDFromPath(),i=postCache[o];t={pid:String(o),parent:String(i&&i.comment),hidden_if_comment:i&&i.comment?"hidden":"",hidden_if_not_comment:i&&i.comment?"":"hidden",checked_if_private:defaultPostPrivate||i&&i.private?"checked":""};break;case"hashtag":t={tag:getHashtagFromPath()};break;case"changelog":t={changes:generateChangesHTML(location.pathname.split("/").filter(Boolean)[1])}}tlPollingIntervalID&&(clearInterval(tlPollingIntervalID),tlPollingIntervalID=null);var r=getSnippet(`pages/${e}`,t);container.replaceChildren(r),document.title=getPageTitle(e),currentPage=e,resetNotificationIndicators()}function getPageTitle(e){let t="",n=(Object.values(pendingNotifications).some(Boolean)&&(t=" "),e);switch(e){case"login":n=L.titles.login;break;case"signup":n=L.titles.signup;break;case"logout":n=L.titles.logout;break;case"404":n=L.titles.not_found;break;case"user":n=getUsernameFromPath()+" - ";break;case"notifications":n=L.titles.notifications;break;case"follow-requests":n=L.titles.follow_requests;break;case"changelog":n=L.titles.changes;break;case"admin":n=L.titles.admin;break;case"search":n=L.titles.search;break;case"message-list":case"message":n=L.titles.messages;break;case"index":case"home":case"post":n=null;break;case"settings":case"settings/profile":case"settings/cosmetic":case"settings/keybinds":case"settings/account":case"settings/about":n=L.titles.settings}return n?t+lr(L.titles.base,{l:n,n:pageTitle}):t+pageTitle}let pendingNotifications={notifications:!(onpopstate=function(e){renderPage(currentPage=e.state)}),messages:!1,follow_requests:!1};function fetchNotifications(){(new api_Notifications).fetch()}function resetNotificationIndicators(){var e,t,n,o;for(n of document.querySelectorAll("#navbar [data-notif-dot][data-notification]"))delete n.dataset.notification;for(o of document.querySelectorAll("#navbar [data-notif-dot]"))pendingNotifications.notifications&&null!=(e=o.dataset.notifDot)&&e.includes("notifications")||pendingNotifications.messages&&null!=(e=o.dataset.notifDot)&&e.includes("messages")||pendingNotifications.follow_requests&&null!=(t=o.dataset.notifDot)&&t.includes("folreq")?o.dataset.notification="":delete o.dataset.notification;if(pendingNotifications.follow_requests)for(var a of document.querySelectorAll("[data-navbar-folreq-toggle][hidden]"))a.removeAttribute("hidden");document.title=getPageTitle(currentPage)}function lr(e,t){for(var[n,o]of Object.entries(t))e=e.replaceAll("%"+n,o);return e}function n(e,t){return e[t]||e["*"]}function langFromRaw(e){let t=L;for(var n of e.split("."))if(!(t=t[n]))return e;return String(t)}function floatintToStr(e){if(e>>14&1)return L.numbers.infinity;let t=1,n=(e>>3&1023)*(t=e>>13&1?-1:t);var o=3&e;Boolean(e>>2&1)&&(n/=10);let a="";switch(o){case 0:a="%n";break;case 1:a=L.numbers.thousand;break;case 2:a=L.numbers.million;break;case 3:a=L.numbers.billion}return lr(a,{n:String(n)})}function floatintToNum(e){if(e>>14&1)return 1/0;let t=1,n=(e>>3&1023)*(t=e>>13&1?-1:t);var o=3&e;return Boolean(e>>2&1)&&(n/=10),n*Math.pow(1e3,o)}function _getErrorStrings(e,t){switch(e){case ErrorCodes.BadRequest:return[L.errors.something_went_wrong];case ErrorCodes.BadUsername:switch(t){case ResponseCodes.LogIn:case ResponseCodes.AdminDeleteUser:case ResponseCodes.GetAdminPermissions:case ResponseCodes.SetAdminPermissions:return[L.errors.bad_username,L.errors.username_no_user];case ResponseCodes.SignUp:return[L.errors.bad_username,L.errors.username_characters];case ResponseCodes.TimelineUser:return userSetDNE(),[null];default:return[L.errors.bad_username]}case ErrorCodes.UsernameUsed:return[L.errors.username_used];case ErrorCodes.BadPassword:return[L.errors.bad_password];case ErrorCodes.InvalidOTP:return[L.errors.invalid_otp,L.errors.invalid_otp_more];case ErrorCodes.CantInteract:return t!==ResponseCodes.DeletePost?[L.errors.cant_interact,L.errors.cant_interact_more]:[L.errors.cant_delete,L.errors.cant_delete_more];case ErrorCodes.Blocking:return[L.errors.blocking,L.errors.blocking_more];case ErrorCodes.PostNotFound:return t!==ResponseCodes.TimelineComments?[L.errors.post_not_found]:(postSetDNE(),[null]);case ErrorCodes.PollSingleOption:return[L.errors.invalid_poll,L.errors.poll_more_than_one];case ErrorCodes.NotAuthenticated:return[L.errors.not_authenticated,L.errors.not_authenticated_more];case ErrorCodes.Ratelimit:return[L.errors.ratelimit,L.errors.ratelimit_more]}return[L.errors.something_went_wrong,lr(L.errors.error_code,{c:t.toString(16)+e.toString(16)})]}function _extractString(e,t){var n=_extractInt(e,t);return[(new TextDecoder).decode(t.slice(e/8,e/8+n)),t.slice(e/8+n)]}function _extractInt(t,n){let o=0;for(let e=0;8*e<t;e++)o=(o<<=8)+n[e];return o}function _extractBool(e,t){return Boolean(e>>t&1)}function _extractPost(e){var t=_extractInt(32,e);let n=null;var o=_extractInt(64,e.slice(4)),a=[e[12],e[13]],s=[_extractBool(a[1],7),_extractBool(a[1],6)];let i=e.slice(14);_extractBool(a[0],6)&&(n=_extractInt(32,i),i=i.slice(4));var e={likes:_extractInt(16,i),liked:_extractBool(a[0],3),quotes:_extractInt(16,i.slice(2)),comments:_extractInt(16,i.slice(4))},r=_extractString(16,i.slice(6)),l=_extractString(8,r[1]),c=_extractString(8,l[1]),d=_extractString(8,c[1]),u=_extractString(8,d[1]),m=["#"+_toHex(u[1].slice(0,3)),"#"+_toHex(u[1].slice(3,6))];i=u[1].slice(6);let p=null,g=(_extractBool(a[0],0)&&(h=_extractPoll(i),p=h[0],i=h[1]),null);if(_extractBool(a[0],5))if(_extractBool(a[0],4)){var h=_extractBool(a[0],1);let e=null;h&&(e=_extractInt(32,i.slice(12)));var h=_extractString(16,i.slice(12+4*+h)),f=_extractString(8,h[1]),_=_extractString(8,f[1]),b=_extractString(8,_[1]),v=_extractString(8,b[1]),y=["#"+_toHex(v[1].slice(0,3)),"#"+_toHex(v[1].slice(3,6))];g={id:_extractInt(32,i),content:h[0],content_warning:f[0],timestamp:_extractInt(64,i.slice(4)),private:_extractBool(a[0],2),comment:e,edited:s[1],has_poll:_extractBool(a[1],5),has_quote:_extractBool(a[1],4),user:{username:_[0],display_name:b[0],pronouns:v[0],banner:y}},i=v[1].slice(6)}else g=!1;return[{id:t,content:r[0],content_warning:l[0],timestamp:o,private:_extractBool(a[0],7),comment:n,edited:s[0],interactions:e,poll:p,user:{username:c[0],display_name:d[0],pronouns:u[0],banner:m},quote:g},i]}function _extractPoll(t){var n={votes:_extractInt(16,t),has_voted:!1,items:[]},o=_extractInt(8,t.slice(2));t=t.slice(3);for(let e=0;e<o;e++){var a=_extractString(8,t),s=_extractInt(16,a[1]),i=_extractBool(a[1][2],7);t=a[1].slice(3),i&&(n.has_voted=!0),n.items.push({content:a[0],percentage:s/10,voted:i})}return[n,t]}function _toHex(e){return[...e].map(e=>e.toString(16).padStart(2,"0")).join("")}loggedIn&&(fetchNotifications(),setInterval(fetchNotifications,NOTIFICATION_POLLING_INTERVAL));let icons={back:'<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 448 512"><path d="M7.4 273.4C2.7 268.8 0 262.6 0 256s2.7-12.8 7.4-17.4l176-168c9.6-9.2 24.8-8.8 33.9.8s8.8 24.8-.8 33.9L83.9 232H424c13.3 0 24 10.7 24 24s-10.7 24-24 24H83.9l132.7 126.6c9.6 9.2 9.9 24.3.8 33.9s-24.3 9.9-33.9.8l-176-168z"/></svg>',private:'<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 448 512"><path d="M130.9 168.3v54.4h136v-54.4c0-37.57-30.43-68-68-68s-68 30.43-68 68m-40.8 54.4v-54.4c0-60.095 48.705-108.8 108.8-108.8s108.8 48.705 108.8 108.8v54.4h27.2c30.005 0 54.4 24.395 54.4 54.4v163.2c0 30.005-24.395 54.4-54.4 54.4h-272c-30.005 0-54.4-24.395-54.4-54.4V277.1c0-30.005 24.395-54.4 54.4-54.4zm-40.8 54.4v163.2c0 7.48 6.12 13.6 13.6 13.6h272c7.48 0 13.6-6.12 13.6-13.6V277.1c0-7.48-6.12-13.6-13.6-13.6h-272c-7.48 0-13.6 6.12-13.6 13.6"/></svg>',comment_arrow:'<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 640 640"><path d="M488 528c13.3 0 24 10.7 24 24s-10.7 24-24 24h-96c-53 0-96-43-96-96V145.9l-95 95c-9.4 9.4-24.6 9.4-33.9 0s-9.4-24.6 0-33.9L303 71c4.5-4.5 10.6-7 17-7s12.5 2.5 17 7l136 136c9.4 9.4 9.4 24.6 0 33.9s-24.6 9.4-33.9 0l-95-95V480c0 26.5 21.5 48 48 48h96z"/></svg>',login:'<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 512 512"><path d="m217 401 128-128c9.4-9.4 9.4-24.6 0-33.9L217 111c-9.4-9.4-24.6-9.4-33.9 0s-9.4 24.6 0 33.9l87 87L24 232c-13.3 0-24 10.7-24 24s10.7 24 24 24h246.1l-87 87c-9.4 9.4-9.4 24.6 0 33.9s24.6 9.4 33.9 0zM344 80h80c22.1 0 40 17.9 40 40v272c0 22.1-17.9 40-40 40h-80c-13.3 0-24 10.7-24 24s10.7 24 24 24h80c48.6 0 88-39.4 88-88V120c0-48.6-39.4-88-88-88h-80c-13.3 0-24 10.7-24 24s10.7 24 24 24"/></svg>',user_plus:'<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 640 512"><path d="M224 48a80 80 0 1 1 0 160 80 80 0 1 1 0-160m0 208a128 128 0 1 0 0-256 128 128 0 1 0 0 256m-45.7 96h91.4c65.7 0 120.1 48.7 129 112H49.3c8.9-63.3 63.3-112 129-112m0-48C79.8 304 0 383.8 0 482.3 0 498.7 13.3 512 29.7 512h388.6c16.4 0 29.7-13.3 29.7-29.7 0-98.5-79.8-178.3-178.3-178.3zm325.7 8c0 13.3 10.7 24 24 24s24-10.7 24-24v-64h64c13.3 0 24-10.7 24-24s-10.7-24-24-24h-64v-64c0-13.3-10.7-24-24-24s-24 10.7-24 24v64h-64c-13.3 0-24 10.7-24 24s10.7 24 24 24h64z"/></svg>',comment:'<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 512 512"><path d="M123.6 391.3c12.9-9.4 29.6-11.8 44.6-6.4 26.5 9.6 56.2 15.1 87.8 15.1 124.7 0 208-80.5 208-160S380.7 80 256 80 48 160.5 48 240c0 32 12.4 62.8 35.7 89.2 8.6 9.7 12.8 22.5 11.8 35.5-1.4 18.1-5.7 34.7-11.3 49.4 17-7.9 31.1-16.7 39.4-22.7zM21.2 431.9q2.7-4.05 5.1-8.1c10-16.6 19.5-38.4 21.4-62.9C17.7 326.8 0 285.1 0 240 0 125.1 114.6 32 256 32s256 93.1 256 208-114.6 208-256 208c-37.1 0-72.3-6.4-104.1-17.9-11.9 8.7-31.3 20.6-54.3 30.6-15.1 6.6-32.3 12.6-50.1 16.1-.8.2-1.6.3-2.4.5-4.4.8-8.7 1.5-13.2 1.9-.2 0-.5.1-.7.1-5.1.5-10.2.8-15.3.8-6.5 0-12.3-3.9-14.8-9.9S0 457.4 4.5 452.8c4.1-4.2 7.8-8.7 11.3-13.5q2.55-3.45 4.8-6.9c.1-.2.2-.3.3-.5z"/></svg>',quote:'<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 512 512"><path d="M0 254.5c-.8 13.2 9.2 24.6 22.5 25.5s24.6-9.2 25.5-22.5l.5-8c3.4-54.8 48.8-97.5 103.7-97.5H366l-55 55c-9.4 9.4-9.4 24.6 0 33.9s24.6 9.4 33.9 0l96-96c9.4-9.4 9.4-24.6 0-33.9L345 15c-9.4-9.4-24.6-9.4-33.9 0s-9.4 24.6 0 33.9l55 55H152.3C72 104 5.6 166.4.5 246.5zm511.9 3c.8-13.2-9.2-24.6-22.5-25.5s-24.6 9.2-25.4 22.5l-.5 8c-3.4 54.8-48.9 97.5-103.8 97.5H145.9l55-55c9.4-9.4 9.4-24.6 0-33.9s-24.6-9.4-33.9 0L71 367c-9.4 9.4-9.4 24.6 0 33.9l96 96c9.4 9.4 24.6 9.4 33.9 0s9.4-24.6 0-33.9l-55-55h213.8c80.3 0 146.7-62.4 151.7-142.5z"/></svg>',like:'<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 512 512"><path d="m225.8 468.2-2.5-2.3L48.1 303.2C17.4 274.7 0 234.7 0 192.8v-3.3c0-70.4 50-130.8 119.2-144 39.4-7.6 79.7 1.5 111.8 24.1 9 6.4 17.4 13.8 25 22.3 4.2-4.8 8.7-9.2 13.5-13.3 3.7-3.2 7.5-6.2 11.5-9 32.1-22.6 72.4-31.7 111.8-24.2C462 58.6 512 119.1 512 189.5v3.3c0 41.9-17.4 81.9-48.1 110.4L288.7 465.9l-2.5 2.3c-8.2 7.6-19 11.9-30.2 11.9s-22-4.2-30.2-11.9M239.1 145c-.4-.3-.7-.7-1-1.1l-17.8-20-.1-.1c-23.1-25.9-58-37.7-92-31.2-46.6 8.9-80.2 49.5-80.2 96.9v3.3c0 28.5 11.9 55.8 32.8 75.2L256 430.7 431.2 268a102.7 102.7 0 0 0 32.8-75.2v-3.3c0-47.3-33.6-88-80.1-96.9-34-6.5-69 5.4-92 31.2l-.1.1-.1.1-17.8 20c-.3.4-.7.7-1 1.1-4.5 4.5-10.6 7-16.9 7s-12.4-2.5-16.9-7z"/></svg>',like_active:'<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 512 512"><path d="m47.6 300.4 180.7 168.7c7.5 7 17.4 10.9 27.7 10.9s20.2-3.9 27.7-10.9l180.7-168.7c30.4-28.3 47.6-68 47.6-109.5v-5.8c0-69.9-50.5-129.5-119.4-141-45.6-7.6-92 7.3-124.6 39.9l-12 12-12-12c-32.6-32.6-79-47.5-124.6-39.9C50.5 55.6 0 115.2 0 185.1v5.8c0 41.5 17.2 81.2 47.6 109.5"/></svg>',hamburger:'<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 448 512"><path d="M0 96c0-17.7 14.3-32 32-32h384c17.7 0 32 14.3 32 32s-14.3 32-32 32H32c-17.7 0-32-14.3-32-32m0 160c0-17.7 14.3-32 32-32h384c17.7 0 32 14.3 32 32s-14.3 32-32 32H32c-17.7 0-32-14.3-32-32m448 160c0 17.7-14.3 32-32 32H32c-17.7 0-32-14.3-32-32s14.3-32 32-32h384c17.7 0 32 14.3 32 32"/></svg>',edit:'<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 512 512"><path d="M395.8 39.6c9.4-9.4 24.6-9.4 33.9 0l42.6 42.6c9.4 9.4 9.4 24.6 0 33.9L417.6 171 341 94.4zM318.4 117l76.6 76.6-219 219V400c0-8.8-7.2-16-16-16h-32v-32c0-8.8-7.2-16-16-16H99.4zM66.9 379.5c1.2-4 2.7-7.9 4.7-11.5H96v32c0 8.8 7.2 16 16 16h32v24.4c-3.7 1.9-7.5 3.5-11.6 4.7l-92.8 27.3 27.3-92.8zM452.4 17c-21.9-21.9-57.3-21.9-79.2 0L60.4 329.7c-11.4 11.4-19.7 25.4-24.2 40.8L.7 491.5c-1.7 5.6-.1 11.7 4 15.8s10.2 5.7 15.8 4l121-35.6c15.4-4.5 29.4-12.9 40.8-24.2L495 138.8c21.9-21.9 21.9-57.3 0-79.2zM331.3 202.7c6.2-6.2 6.2-16.4 0-22.6s-16.4-6.2-22.6 0l-128 128c-6.2 6.2-6.2 16.4 0 22.6s16.4 6.2 22.6 0z"/></svg>',pin:'<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 384 512"><path d="m134.6 51.7-10.8 140.9c-1.1 14.6-8.8 27.8-20.9 36-23.9 16.2-41.8 40.8-49.1 70.3l-1.3 5.1h279l-1.3-5.1c-7.4-29.5-25.2-54.1-49.1-70.2-12.1-8.2-19.8-21.5-20.9-36l-10.8-141c-.1-1.2-.1-2.5-.1-3.7H134.8c0 1.2 0 2.5-.2 3.7M168 352H32c-9.9 0-19.2-4.5-25.2-12.3s-8.2-17.9-5.8-27.5l6.2-25c10.3-41.3 35.4-75.7 68.7-98.3L83.1 96l3.7-48H56c-4.4 0-8.6-1.2-12.2-3.3C36.8 40.5 32 32.8 32 24 32 10.7 42.7 0 56 0h272c13.3 0 24 10.7 24 24 0 8.8-4.8 16.5-11.8 20.7-3.6 2.1-7.7 3.3-12.2 3.3h-30.8l3.7 48 7.1 92.9c33.3 22.6 58.4 57.1 68.7 98.3l6.2 25c2.4 9.6.2 19.7-5.8 27.5S361.7 352 351.9 352H216v136c0 13.3-10.7 24-24 24s-24-10.7-24-24z"/></svg>',unpin:'<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 640 640"><path d="M73 39.1c-9.4-9.4-24.6-9.4-33.9 0s-9.4 24.6-.1 34l528 528c9.4 9.4 24.6 9.4 33.9 0s9.4-24.6 0-33.9L449.8 416h23.9c21.2 0 38.3-17.2 38.3-38.3 0-29.2-12.5-57-28.5-79.5-13.4-18.9-30.2-35.5-47.5-48L425.8 112h-48.2l10.5 141.8 1.7 22.3 18.2 13.1c16.1 11.6 29.3 26.3 40.4 42.8 6.9 10.8 13 23.3 14.7 36.1h-61.3L254.2 220.5l8-108.4h-48.1l-4.7 63.6L72.9 39.2zM213.8 112H456c13.3 0 24-10.7 24-24s-10.7-24-24-24H184c-5.1 0-9.9 1.6-13.8 4.4zm100.4 304-48-48h-89.3c2.5-15.3 9.9-29.5 18.8-42.1 3.9-5.4 8.2-10.7 12.8-15.7l-34-34c-6.4 6.9-12.5 14.2-18 21.9-15.9 22.5-28.5 50.3-28.5 79.5 0 21.2 17.2 38.3 38.3 38.3h147.8zM296 584c0 13.3 10.7 24 24 24s24-10.7 24-24V464h-48z"/></svg>',delete:'<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 448 512"><path d="m170.5 51.6-19 28.4h145l-19-28.4c-1.5-2.2-4-3.6-6.7-3.6h-93.7c-2.7 0-5.2 1.3-6.7 3.6zm147-26.6 36.7 55H424c13.3 0 24 10.7 24 24s-10.7 24-24 24h-8v304c0 44.2-35.8 80-80 80H112c-44.2 0-80-35.8-80-80V128h-8c-13.3 0-24-10.7-24-24s10.7-24 24-24h69.8l36.7-55.1C140.9 9.4 158.4 0 177.1 0h93.7c18.7 0 36.2 9.4 46.6 24.9zM80 128v304c0 17.7 14.3 32 32 32h224c17.7 0 32-14.3 32-32V128zm80 64v208c0 8.8-7.2 16-16 16s-16-7.2-16-16V192c0-8.8 7.2-16 16-16s16 7.2 16 16m80 0v208c0 8.8-7.2 16-16 16s-16-7.2-16-16V192c0-8.8 7.2-16 16-16s16 7.2 16 16m80 0v208c0 8.8-7.2 16-16 16s-16-7.2-16-16V192c0-8.8 7.2-16 16-16s16 7.2 16 16"/></svg>',share:'<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 512 512"><path d="M288 240h-96c-66.2 0-122 44.7-138.8 105.5-3.3-12.4-5.2-26.2-5.2-41.5 0-70.7 57.3-128 128-128h136c13.3 0 24-10.7 24-24V99.9L456.1 208 336 316.1V264c0-13.3-10.7-24-24-24zm0 48v64c0 12.6 7.4 24.1 19 29.2s25 3 34.4-5.4l160-144c6.7-6.1 10.6-14.7 10.6-23.8s-3.8-17.7-10.6-23.8l-160-144c-9.4-8.5-22.9-10.6-34.4-5.4S288 51.4 288 64v64H176C78.8 128 0 206.8 0 304c0 78 38.6 126.2 68.7 152.1 4.1 3.5 8.1 6.6 11.7 9.3 3.2 2.4 6.2 4.4 8.9 6.2 4.5 3 8.3 5.1 10.8 6.5s5.3 1.9 8.1 1.9c10.9 0 19.7-8.9 19.7-19.7 0-6.8-3.6-13.2-8.3-18.1l-1.4-1.4c-2.4-2.3-5.1-5.1-7.7-8.6-1.7-2.3-3.4-5-5-7.9-5.3-9.7-9.5-22.9-9.5-40.2 0-53 43-96 96-96h96z"/></svg>',embed:'<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 640 640"><path d="M392.8 65.2c-17-4.9-34.7 5-39.6 22l-128 448c-4.9 17 5 34.7 22 39.6s34.7-5 39.6-22l128-448c4.9-17-5-34.7-22-39.6m64.6 136.1c-12.5 12.5-12.5 32.8 0 45.3l73.4 73.4-73.4 73.4c-12.5 12.5-12.5 32.8 0 45.3s32.8 12.5 45.3 0l96-96c12.5-12.5 12.5-32.8 0-45.3l-96-96c-12.5-12.5-32.8-12.5-45.3 0zm-274.7 0c-12.5-12.5-32.8-12.5-45.3 0l-96 96c-12.5 12.5-12.5 32.8 0 45.3l96 96c12.5 12.5 32.8 12.5 45.3 0s12.5-32.8 0-45.3L109.3 320l73.3-73.4c12.5-12.5 12.5-32.8 0-45.3z"/></svg>',home_active:'<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 576 512"><path d="M575.8 255.5c0 18-15 32.1-32 32.1h-32l.7 160.2c0 2.7-.2 5.4-.5 8.1V472c0 22.1-17.9 40-40 40h-16c-1.1 0-2.2 0-3.3-.1-1.4.1-2.8.1-4.2.1H392c-22.1 0-40-17.9-40-40v-88c0-17.7-14.3-32-32-32h-64c-17.7 0-32 14.3-32 32v88c0 22.1-17.9 40-40 40h-55.9c-1.5 0-3-.1-4.5-.2-1.2.1-2.4.2-3.6.2h-16c-22.1 0-40-17.9-40-40V360c0-.9 0-1.9.1-2.8v-69.6H32c-18 0-32-14-32-32.1 0-9 3-17 10-24L266.4 8c7-7 15-8 22-8s15 2 21 7l255.4 224.5c8 7 12 15 11 24"/></svg>',home:'<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 576 512"><path d="M303.5 5.7c-9-7.6-22.1-7.6-31.1 0l-264 224c-10.1 8.6-11.3 23.7-2.8 33.8s23.7 11.3 33.8 2.8L64 245.5V432c0 44.2 35.8 80 80 80h288c44.2 0 80-35.8 80-80V245.5l24.5 20.8c10.1 8.6 25.3 7.3 33.8-2.8s7.3-25.3-2.8-33.8zM112 432V204.8L288 55.5l176 149.3V432c0 17.7-14.3 32-32 32h-48V312c0-22.1-17.9-40-40-40H232c-22.1 0-40 17.9-40 40v152h-48c-17.7 0-32-14.3-32-32m128 32V320h96v144z"/></svg>',notifications_active:'<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 448 512"><path d="M224 0c-17.7 0-32 14.3-32 32v19.2C119 66 64 130.6 64 208v18.8c0 47-17.3 92.4-48.5 127.6l-7.4 8.3c-8.4 9.4-10.4 22.9-5.3 34.4S19.4 416 32 416h384c12.6 0 24-7.4 29.2-18.9s3.1-25-5.3-34.4l-7.4-8.3c-31.2-35.2-48.5-80.5-48.5-127.6V208c0-77.4-55-142-128-156.8V32c0-17.7-14.3-32-32-32m45.3 493.3c12-12 18.7-28.3 18.7-45.3H160c0 17 6.7 33.3 18.7 45.3S207 512 224 512s33.3-6.7 45.3-18.7"/></svg>',notifications:'<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 448 512"><path d="M224 0c-17.7 0-32 14.3-32 32v19.2C119 66 64 130.6 64 208v25.4c0 45.4-15.5 89.5-43.8 124.9L5.3 377c-5.8 7.2-6.9 17.1-2.9 25.4S14.8 416 24 416h400c9.2 0 17.6-5.3 21.6-13.6s2.9-18.2-2.9-25.4l-14.9-18.6c-28.3-35.5-43.8-79.6-43.8-125V208c0-77.4-55-142-128-156.8V32c0-17.7-14.3-32-32-32m0 96c61.9 0 112 50.1 112 112v25.4c0 47.9 13.9 94.6 39.7 134.6H72.3c25.8-40 39.7-86.7 39.7-134.6V208c0-61.9 50.1-112 112-112m64 352H160c0 17 6.7 33.3 18.7 45.3S207 512 224 512s33.3-6.7 45.3-18.7S288 465 288 448"/></svg>',messages_active:'<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 512 512"><path d="M48 64C21.5 64 0 85.5 0 112c0 15.1 7.1 29.3 19.2 38.4l217.6 163.2c11.4 8.5 27 8.5 38.4 0l217.6-163.2c12.1-9.1 19.2-23.3 19.2-38.4 0-26.5-21.5-48-48-48zM0 176v208c0 35.3 28.7 64 64 64h384c35.3 0 64-28.7 64-64V176L294.4 339.2a63.9 63.9 0 0 1-76.8 0z"/></svg>',messages:'<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 512 512"><path d="M64 112c-8.8 0-16 7.2-16 16v22.1l172.5 141.6c20.7 17 50.4 17 71.1 0L464 150.1V128c0-8.8-7.2-16-16-16zM48 212.2V384c0 8.8 7.2 16 16 16h384c8.8 0 16-7.2 16-16V212.2L322 328.8c-38.4 31.5-93.7 31.5-132 0zM0 128c0-35.3 28.7-64 64-64h384c35.3 0 64 28.7 64 64v256c0 35.3-28.7 64-64 64H64c-35.3 0-64-28.7-64-64z"/></svg>',user_active:'<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 448 512"><path d="M224 256a128 128 0 1 0 0-256 128 128 0 1 0 0 256m-45.7 48C79.8 304 0 383.8 0 482.3 0 498.7 13.3 512 29.7 512h388.6c16.4 0 29.7-13.3 29.7-29.7 0-98.5-79.8-178.3-178.3-178.3z"/></svg>',user:'<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 448 512"><path d="M304 128a80 80 0 1 0-160 0 80 80 0 1 0 160 0m-208 0a128 128 0 1 1 256 0 128 128 0 1 1-256 0M49.3 464h349.5c-8.9-63.3-63.3-112-129-112h-91.4c-65.7 0-120.1 48.7-129 112zM0 482.3C0 383.8 79.8 304 178.3 304h91.4c98.5 0 178.3 79.8 178.3 178.3 0 16.4-13.3 29.7-29.7 29.7H29.7C13.3 512 0 498.7 0 482.3"/></svg>',settings_active:'<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 512 512"><path d="M495.9 166.6c3.2 8.7.5 18.4-6.4 24.6l-43.3 39.4c1.1 8.3 1.7 16.8 1.7 25.4s-.6 17.1-1.7 25.4l43.3 39.4c6.9 6.2 9.6 15.9 6.4 24.6-4.4 11.9-9.7 23.3-15.8 34.3l-4.7 8.1c-6.6 11-14 21.4-22.1 31.2-5.9 7.2-15.7 9.6-24.5 6.8l-55.7-17.7c-13.4 10.3-28.2 18.9-44 25.4l-12.5 57.1c-2 9.1-9 16.3-18.2 17.8-13.8 2.3-28 3.5-42.5 3.5s-28.7-1.2-42.5-3.5c-9.2-1.5-16.2-8.7-18.2-17.8l-12.5-57.1c-15.8-6.5-30.6-15.1-44-25.4l-55.6 17.8c-8.8 2.8-18.6.3-24.5-6.8-8.1-9.8-15.5-20.2-22.1-31.2l-4.7-8.1c-6.1-11-11.4-22.4-15.8-34.3-3.2-8.7-.5-18.4 6.4-24.6l43.3-39.4c-1.1-8.4-1.7-16.9-1.7-25.5s.6-17.1 1.7-25.4l-43.3-39.4c-6.9-6.2-9.6-15.9-6.4-24.6 4.4-11.9 9.7-23.3 15.8-34.3l4.7-8.1c6.6-11 14-21.4 22.1-31.2 5.9-7.2 15.7-9.6 24.5-6.8l55.7 17.7c13.4-10.3 28.2-18.9 44-25.4l12.5-57.1c2-9.1 9-16.3 18.2-17.8C227.3 1.2 241.5 0 256 0s28.7 1.2 42.5 3.5c9.2 1.5 16.2 8.7 18.2 17.8l12.5 57.1c15.8 6.5 30.6 15.1 44 25.4l55.7-17.7c8.8-2.8 18.6-.3 24.5 6.8 8.1 9.8 15.5 20.2 22.1 31.2l4.7 8.1c6.1 11 11.4 22.4 15.8 34.3zM256 336a80 80 0 1 0 0-160 80 80 0 1 0 0 160"/></svg>',settings:'<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 512 512"><path d="M256 0c17 0 33.6 1.7 49.8 4.8 7.9 1.5 21.8 6.1 29.4 20.1 2 3.7 3.6 7.6 4.6 11.8l9.3 38.5c1.4 5.8 11.2 11.5 16.9 9.8l38-11.2c4-1.2 8.1-1.8 12.2-1.9 16.1-.5 27 9.4 32.3 15.4 22.1 25.1 39.1 54.6 49.9 86.3 2.6 7.6 5.6 21.8-2.7 35.4-2.2 3.6-4.9 7-8 10L459 246.3c-4.2 4-4.2 15.5 0 19.5l28.7 27.3c3.1 3 5.8 6.4 8 10 8.2 13.6 5.2 27.8 2.7 35.4-10.8 31.7-27.8 61.1-49.9 86.3-5.3 6-16.3 15.9-32.3 15.4-4.1-.1-8.2-.8-12.2-1.9L366 427c-5.7-1.7-15.5 4-16.9 9.8l-9.3 38.5c-1 4.2-2.6 8.2-4.6 11.8-7.7 14-21.6 18.5-29.4 20.1-16.2 3.1-32.8 4.8-49.8 4.8s-33.6-1.7-49.8-4.8c-7.9-1.5-21.8-6.1-29.4-20.1-2-3.7-3.6-7.6-4.6-11.8l-9.3-38.5c-1.4-5.8-11.2-11.5-16.9-9.8l-38 11.2c-4 1.2-8.1 1.8-12.2 1.9-16.1.5-27-9.4-32.3-15.4-22-25.1-39.1-54.6-49.9-86.3-2.6-7.6-5.6-21.8 2.7-35.4 2.2-3.6 4.9-7 8-10L53 265.7c4.2-4 4.2-15.5 0-19.5l-28.8-27.3c-3.1-3-5.8-6.4-8-10-8.2-13.6-5.2-27.8-2.6-35.3 10.8-31.7 27.8-61.1 49.9-86.3 5.3-6 16.3-15.9 32.3-15.4 4.1.1 8.2.8 12.2 1.9L146 85c5.7 1.7 15.5-4 16.9-9.8l9.3-38.5c1-4.2 2.6-8.2 4.6-11.8 7.7-14 21.6-18.5 29.4-20.1C222.4 1.7 239 0 256 0m-37.9 51.4-8.5 35.1c-7.8 32.3-45.3 53.9-77.2 44.6l-34.5-10.2c-16.5 19.3-29.5 41.7-38 65.7l26.2 24.9c24 22.8 24 66.2 0 89l-26.2 24.9c8.5 24 21.5 46.4 38 65.7l34.6-10.2c31.8-9.4 69.4 12.3 77.2 44.6l8.5 35.1c24.6 4.5 51.3 4.5 75.9 0l8.5-35.1c7.8-32.3 45.3-53.9 77.2-44.6l34.6 10.2c16.5-19.3 29.5-41.7 38-65.7l-26.2-24.9c-24-22.8-24-66.2 0-89l26.2-24.9c-8.5-24-21.5-46.4-38-65.7l-34.6 10.2c-31.8 9.4-69.4-12.3-77.2-44.6l-8.5-35.1c-24.6-4.5-51.3-4.5-75.9 0zM208 256a48 48 0 1 0 96 0 48 48 0 1 0-96 0m48 96a96 96 0 1 1 0-192 96 96 0 1 1 0 192"/></svg>',folreq:'<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 640 512"><path d="M224 48a80 80 0 1 1 0 160 80 80 0 1 1 0-160m0 208a128 128 0 1 0 0-256 128 128 0 1 0 0 256m-45.7 96h91.4c65.7 0 120.1 48.7 129 112H49.3c8.9-63.3 63.3-112 129-112m0-48C79.8 304 0 383.8 0 482.3 0 498.7 13.3 512 29.7 512h388.6c16.4 0 29.7-13.3 29.7-29.7 0-98.5-79.8-178.3-178.3-178.3zm325.7 8c0 13.3 10.7 24 24 24s24-10.7 24-24v-64h64c13.3 0 24-10.7 24-24s-10.7-24-24-24h-64v-64c0-13.3-10.7-24-24-24s-24 10.7-24 24v64h-64c-13.3 0-24 10.7-24 24s10.7 24 24 24h64z"/></svg>',folreq_active:'<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 640 512"><path d="M96 128a128 128 0 1 1 256 0 128 128 0 1 1-256 0M0 482.3C0 383.8 79.8 304 178.3 304h91.4c98.5 0 178.3 79.8 178.3 178.3 0 16.4-13.3 29.7-29.7 29.7H29.7C13.3 512 0 498.7 0 482.3M504 312v-64h-64c-13.3 0-24-10.7-24-24s10.7-24 24-24h64v-64c0-13.3 10.7-24 24-24s24 10.7 24 24v64h64c13.3 0 24 10.7 24 24s-10.7 24-24 24h-64v64c0 13.3-10.7 24-24 24s-24-10.7-24-24"/></svg>',search:'<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 640 640"><path fill="currentColor" d="M480 272c0 45.9-14.9 88.3-40 122.7l126.6 126.7c12.5 12.5 12.5 32.8 0 45.3s-32.8 12.5-45.3 0L394.7 440c-34.4 25.1-76.8 40-122.7 40-114.9 0-208-93.1-208-208S157.1 64 272 64s208 93.1 208 208M272 416c79.5 0 144-64.5 144-144s-64.5-144-144-144-144 64.5-144 144 64.5 144 144 144"/></svg>',plus:'<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 512 512"><path d="M256 512a256 256 0 1 0 0-512 256 256 0 1 0 0 512m-24-168v-64h-64c-13.3 0-24-10.7-24-24s10.7-24 24-24h64v-64c0-13.3 10.7-24 24-24s24 10.7 24 24v64h64c13.3 0 24 10.7 24 24s-10.7 24-24 24h-64v64c0 13.3-10.7 24-24 24s-24-10.7-24-24"/></svg>'},snippetVariables={site_name:pageTitle,home_page:loggedIn?"home":"index",username:loggedIn?username:"",selected_if_default_private:defaultPostPrivate?"selected":"",checked_if_default_private:defaultPostPrivate?"checked":""},snippetProcessing={input_enter:p_inputEnter,password_toggle:p_passwordToggle,timeline_switch:p_tlSwitch,timeline_more:p_tlMore,login:p_login,signup:p_signup,logout:p_logout,home:p_home,user:p_user,post:p_post,post_page:p_postPage,notifications:p_notifications,hashtag:p_hashtag,follow_requests:p_folreq,admin:p_admin,search:p_search,message_list:p_messageList,message:p_message,settings_index:p_settingsIndex,settings_profile:p_settingsProfile,settings_cosmetic:p_settingsCosmetic,settings_account:p_settingsAccount,settings_keybinds:p_settingsKeybinds},snippets={};function getSnippet(e,t){var n,o,a,e=snippets[e];let s=e.content;for(n of Object.keys(icons))s=s.replaceAll(`@{icon_${n}}`,icons[n]);for(o of s.matchAll(/@\{lang((?:\.[a-z_0-9]+)+)\}/gi))s=s.replace(o[0],langFromRaw(o[1].slice(1)));for(a of e.variables){let t="",n=0;if("string"==typeof a?a in snippetVariables?t=snippetVariables[a]:console.log(`Unknown snippet variable "${a}"`):(n=a[1],a[0]in snippetVariables?t=a[0]:console.log(`Unknown snippet variable "${a}"`)),n)for(let e=0;e<n;e++)s=s.replace(`@{${"string"==typeof a?a:a[0]}}`,t);else s=s.replaceAll(`@{${"string"==typeof a?a:a[0]}}`,t)}if(t)for(var i of Object.keys(t))if("string"==typeof t[i])s=s.replaceAll(`@{${i}}`,t[i]);else for(let e=0;e<t[i][1];e++)s=s.replace(`@{${i}}`,t[i][0]);var r,l=document.createElement("div");l.innerHTML=s.replaceAll(' =""',"");for(r of e.processing)r in snippetProcessing?snippetProcessing[r](l):console.log(`Unknown snippet process "${r}"`);return generateInternalLinks(l),l}function p_inputEnter(e){for(var t of e.querySelectorAll("[data-enter-submit]"))t.onkeydown=inputEnterEvent}function p_passwordToggle(e){for(var t of e.querySelectorAll("[data-password-toggle]"))t.onclick=togglePasswords}for(let e of document.querySelectorAll("[data-snippet]"))snippets[e.dataset.snippet]={variables:(null==(_a=e.dataset.snippetVariables)?void 0:_a.split(",").filter(e=>e).map(e=>e.includes(":")?[e.split(":")[0],+e.split(":")[1]]:e))||[],processing:(null==(_b=e.dataset.snippetProcessing)?void 0:_b.split(",").filter(e=>e))||[],content:e.innerHTML},e.remove();null!=(_c=document.getElementById("snippets"))&&_c.remove();let themeMedia=matchMedia("(prefers-color-scheme: light)"),_themeLs=localStorage.getItem("smiggins-theme"),theme="light"===_themeLs||"dark"===_themeLs||"warm"===_themeLs||"gray"===_themeLs||"darker"===_themeLs||"oled"===_themeLs?_themeLs:"system";function setTheme(e){"system"===e?(localStorage.removeItem("smiggins-theme"),theme="system",updateTheme(themeMedia.matches?"light":"dark")):(localStorage.setItem("smiggins-theme",e),updateTheme(e))}function updateTheme(e){document.documentElement.dataset.theme=e}function updateAutoTheme(){"system"===theme&&updateTheme(themeMedia.matches?"light":"dark")}themeMedia.addEventListener("change",updateAutoTheme),updateTheme("system"===theme&&(themeMedia.matches?"light":"dark")||theme);let currentTl,currentTlID,tlElement,timelines={},tlPollingIntervalID=null,tlPollingPendingResponse=!1,prependedPosts=0,timelineToggles=[],tlCache={},postCache={},userCache={},offset={upper:null,lower:null};function hookTimeline(e,t,n,o,a){if(timelineToggles=[],t){for(var s of t.querySelectorAll("[data-timeline-toggle][data-timeline-toggle-store]"))s.dataset.timelineToggle&&s.dataset.timelineToggleStore&&localStorage.getItem("smiggins-"+s.dataset.timelineToggleStore)&&(timelineToggles.push(s.dataset.timelineToggle),s.dataset.timelineActive="");if(t.dataset.timelineStore){var i=localStorage.getItem("smiggins-"+t.dataset.timelineStore)||"",r=t.querySelector(`[data-timeline-id="${i}"]`);if(r){for(var l of t.querySelectorAll(`[data-timeline-active][data-timeline-id]`))delete l.dataset.timelineActive;r.dataset.timelineActive="",o=i}}}timelines=n,tlElement=e,_setTimeline(o,a)}function reloadTimeline(e=!1,t){tlElement.innerHTML=`<i class="timeline-status">${L.generic.loading}</i>`,prependedPosts=0;var n=tlCache[currentTlID];if(currentTl.disableCaching||e||!n||!1===n.pendingForward)null!=(e=document.getElementById("timeline-more"))&&e.setAttribute("hidden",""),delete tlCache[currentTlID],offset.upper=null,offset.lower=null,new currentTl.api(null,!1,...currentTl.args||[]).fetch();else{offset={upper:n.upperBound,lower:n.lowerBound},n.posts=n.pendingForward.reverse().concat(n.posts);var o,a=[];for(o of n.posts){var s=postCache[o],s=s&&userCache[s.user.username];currentTl.api!==api_TimelineUser&&s&&s.blocking||a.push(o)}(currentTl.customRender||renderTimeline)(a,n.end,!1,null==t?void 0:t.querySelector("#timeline-more")),timelinePolling(!0)}}function insertIntoPostCache(e){var t,n=[];for(t of e)postCache[t.id]=t,n.push(t.id);return n}function loadMorePosts(){let t=document.getElementById("timeline-more");t&&(t.hidden=!0),tlElement.insertAdjacentHTML("beforeend",`<i class="timeline-status">${L.generic.loading}</i>`),new currentTl.api(currentTl.invertOffset?offset.upper:offset.lower,!1,...currentTl.args||[]).fetch().then(e=>{"boolean"!=typeof e&&(t&&(t.hidden=!1),clearTimelineStatuses())})}function clearTimelineStatuses(e){var t=(e||tlElement).querySelectorAll(".timeline-status");for(let e of t)e.remove()}function renderTimeline(t,n,e=!0,o){if(clearTimelineStatuses(),null===offset.lower&&0===t.length)(i=document.createElement("i")).classList.add("timeline-status"),i.innerText=L.generic.none,tlElement.append(i);else{var a,s=document.createDocumentFragment(),i=o||document.getElementById("timeline-more");i&&(i.hidden=!!n);for(a of t)s.append(getPost(a));if(loggedIn||((o=document.createElement("div")).innerHTML=`<a class="timeline-status" href="/signup/" data-internal-link=\"signup\">${L.generic.sign_up_for_more}</a>`,generateInternalLinks(o),s.append(o)),tlElement.append(s),e&&!currentTl.disableCaching){let e=tlCache[currentTlID];e||(e={upperBound:null,lowerBound:null,posts:[],pendingForward:[],end:!1},tlCache[currentTlID]=e),e.posts.push(...t),e.lowerBound=offset.lower,e.upperBound=offset.upper,e.end=n}}}function _setTimeline(e,t){var n=tlCache[currentTlID];n&&(n.upperBound=offset.upper,n.lowerBound=offset.lower),currentTlID=e.split("__")[0]+timelineToggles.map(e=>"__"+e).join(""),currentTl=timelines[currentTlID],loggedIn||(currentTl.disablePolling=!0),tlPollingIntervalID&&(clearInterval(tlPollingIntervalID),tlPollingIntervalID=null),currentTl.disablePolling||(tlPollingIntervalID=setInterval(timelinePolling,TL_POLLING_INTERVAL)),reloadTimeline(!1,t)}function switchTimeline(e){let t=e.target;if(t){var n;t.dataset.timelineId&&t.dataset.timelineId in timelines&&((n=timelines[t.dataset.timelineId.split("__")[0]+timelineToggles.map(e=>"__"+e).join("")]).api!==currentTl.api||typeof n.args!=typeof currentTl.args||n.args&&currentTl.args&&(n.args.length!==currentTl.args.length||n.args.map((e,t)=>e===currentTl.args[t]).filter(Boolean).length!==n.args.length))&&(_setTimeline(t.dataset.timelineId),n=document.querySelector("[data-timeline-store]"))&&n.dataset.timelineStore&&localStorage.setItem("smiggins-"+n.dataset.timelineStore,t.dataset.timelineId);for(let e of document.querySelectorAll("[data-timeline-active]:not([data-timeline-toggle])"))delete e.dataset.timelineActive;e.target.dataset.timelineActive=""}}function toggleTimeline(e){var t,e=e.target;e&&(t=e.dataset.timelineToggle)&&("string"==typeof e.dataset.timelineActive?(delete e.dataset.timelineActive,e.dataset.timelineToggleStore&&localStorage.removeItem("smiggins-"+e.dataset.timelineToggleStore),timelineToggles.includes(t)&&timelineToggles.splice(timelineToggles.indexOf(t),1)):(e.dataset.timelineActive="",timelineToggles.push(t),e.dataset.timelineToggleStore&&localStorage.setItem("smiggins-"+e.dataset.timelineToggleStore,"1")),_setTimeline(currentTlID))}function pollVote(e,t){new api_PollVote(e,t).fetch()}function refreshPollData(e){new api_PollRefresh(e).fetch()}function refreshPollDisplay(e,t=!1){var n=postCache[e];if(n)for(var o of document.querySelectorAll(`[data-post-id="${e}"] .poll-container`))o.innerHTML=getPollHTML(n.poll,e,t)}function getPollHTML(e,t,o=!1){if(!e)return"";let a="",s="";var i,r=e.has_voted||o||!loggedIn,l=r?"poll-voted":"";let c=0;for(i of e.items)a+=`<div ${r?"":`onclick="pollVote(${t}, ${c})"`} class="poll-bar ${l}" style="--poll-width: ${i.percentage}%;" ${i.voted||!loggedIn?"data-vote":""}><div class="poll-bar-text">${r?`${i.percentage}% - `:""}${escapeHTML(i.content)}</div></div>`,c++;return r?(s=`<a onclick="refreshPollData(${t})">${L.post.poll.refresh}</a>`,!e.has_voted&&o&&loggedIn&&(s+=` - <a onclick="refreshPollDisplay(${t})">${L.post.poll.return_to_voting}</a>`)):s=`<a onclick="refreshPollDisplay(${t}, true)">${L.post.poll.view_results}</a>`,a+`<small><div>${lr(n(L.post.poll.vote_count,floatintToNum(e.votes)),{n:floatintToStr(e.votes)})} - ${s}</div></small>`}function getPost(e,t=!0,o=null){var a=postCache[e];if(!a)return(s=document.createElement("div")).innerText="Post couldn't be loaded.",s;var s=linkify(escapeHTML(a.content),e);t&&(!offset.lower||a.timestamp<offset.lower)&&(offset.lower=a.timestamp),t&&(!offset.upper||a.timestamp>offset.upper)&&(offset.upper=a.timestamp);let i="",r="";a.content_warning&&(i=`<details class="content-warning"${!1===o||!0!==o&&!localStorage.getItem("smiggins-expand-cws")?"":" open"}><summary><div>${escapeHTML(a.content_warning)} <div class="content-warning-stats">(${lr(n(L.post.cw.length,a.content.length),{n:String(a.content.length)})}${a.quote?L.post.cw.has_quote:""}${a.poll?L.post.cw.has_poll:""})</div></div></summary>`,r="</details>");t=getPollHTML(a.poll,a.id);let l={hidden_if_no_quote:"hidden"},c={};if(a.quote){var d=linkify(escapeHTML(a.quote.content),a.quote.id);let e="",t="";a.quote.content_warning&&(e=`<details class="content-warning"${!1===o||!0!==o&&!localStorage.getItem("smiggins-expand-cws")?"":" open"}><summary><div>${escapeHTML(a.quote.content_warning)} <div class="content-warning-stats">(${lr(n(L.post.cw.length,a.quote.content.length),{n:String(a.quote.content.length)})}${a.quote.has_quote?L.post.cw.has_quote:""}${a.quote.has_poll?L.post.cw.has_poll:""})</div></div></summary>`,t="</details>"),l={hidden_if_no_quote:"",quote_timestamp:getTimestamp(a.quote.timestamp),quote_username:a.quote.user.username,quote_private_post:a.quote.private?"data-private-post":"",quote_cw_end:t,quote_banner_one:a.quote.user.banner[0],quote_banner_two:a.quote.user.banner[1],quote_pid:String(a.quote.id),quote_comment_id:String(a.quote.comment),hidden_if_no_quote_pronouns:a.quote.user.pronouns?"":"hidden",hidden_if_no_quote_comment:a.quote.comment?"":"hidden",hidden_if_no_quote_edit:a.quote.edited?"":"hidden"},c={quote_content:[d+(a.quote.has_poll?(a.quote.content?"\n":"")+`<a data-internal-link="post" href="/p/${a.quote.id}/" class="plain-link"><i>${L.post.quote.has_poll}</i></a>`:"")+(a.quote.has_quote?(a.quote.content||a.quote.has_poll?"\n":"")+`<a data-internal-link="post" href="/p/${a.quote.id}/" class="plain-link"><i>${L.post.quote.has_quote}</i></a>`:""),1],quote_cw_start:[e,1],quote_pronouns:[a.quote.user.pronouns||"",1],quote_display_name:[escapeHTML(a.quote.user.display_name),1]}}o=getSnippet("post",Object.assign(Object.assign(Object.assign({timestamp:getTimestamp(a.timestamp),username:a.user.username,post_interactions_hidden:localStorage.getItem("smiggins-hide-interactions")?"hidden":"",edit_hidden:username===a.user.username?"":"hidden",delete_hidden:isAdmin||username===a.user.username?"":"hidden",pid:String(e),comment_id:String(a.comment),comments:floatintToStr(a.interactions.comments),quotes:floatintToStr(a.interactions.quotes),likes:floatintToStr(a.interactions.likes),liked:String(a.interactions.liked),banner_one:a.user.banner[0],banner_two:a.user.banner[1],private_post:a.private?"data-private-post":"",cw_end:r,hidden_if_no_pronouns:a.user.pronouns?"":"hidden",hidden_if_no_comment:a.comment?"":"hidden",hidden_if_no_poll:a.poll?"":"hidden",hidden_if_no_edit:a.edited?"":"hidden"},l),c),{poll:[t,1],content:[s,1],pronouns:[a.user.pronouns||"",1],display_name:[escapeHTML(a.user.display_name),1],cw_start:[i,1]}));return o.dataset.editReplace=String(e),!1===a.quote&&(d=o.querySelector(".post-quote"))&&(d.removeAttribute("hidden"),d.innerHTML=`<i>${L.post.quote.cant_view}</i>`),o}function timelineShowNew(){var e,t=tlCache[currentTlID];if(t){var n=t.pendingForward;if(t.pendingForward=[],null!=(e=document.getElementById("timeline-show-new"))&&e.remove(),!1===n)reloadTimeline(!0);else{t.posts=n.reverse().concat(t.posts);var o,a,s=document.createDocumentFragment();for(o of n)s.append(getPost(o));prependedPosts=0;for(a of document.querySelectorAll("[data-prepended]"))a.remove();tlElement.prepend(s)}}}function handleForward(t,o,e,a=!1){tlPollingPendingResponse=!1;var s=tlCache[e];if(s)if(e!==currentTlID)console.log("timeline switched, discarding request"),o?s.pendingForward=!1:!1!==s.pendingForward&&s.pendingForward.push(...insertIntoPostCache(t).reverse());else if(0!==t.length&&!1!==s.pendingForward){let e=document.getElementById("timeline-show-new");a||e||o&&!(0<s.pendingForward.length+t.length-prependedPosts)||((e=document.createElement("button")).id="timeline-show-new",e.addEventListener("click",timelineShowNew),tlElement.prepend(e)),o?(offset.upper=Math.max(...t.map(e=>e.timestamp)),s.pendingForward.push(...insertIntoPostCache(t).reverse()),e&&(e.innerText=lr(n(L.post.show_new,s.pendingForward.length),{n:String(s.pendingForward.length)}))):(s.pendingForward=!1,e&&(e.innerText=L.post.tl_refresh)),a&&timelineShowNew()}}function timelinePolling(e=!1){var t;currentTl.disablePolling||!offset.upper||tlPollingPendingResponse&&!e||(t=tlCache[currentTlID])&&!1===t.pendingForward||(tlPollingPendingResponse=!0,localStorage.getItem("smiggins-auto-show-posts")&&(e=!0),new currentTl.api(currentTl.invertOffset?offset.lower:offset.upper,!e||"force",...currentTl.args||[]).fetch().then(e=>{tlPollingPendingResponse=!1}))}function prependPostToTimeline(e){var t;!currentTl.prependPosts||"number"==typeof currentTl.prependPosts&&e.comment!==currentTl.prependPosts||(tlElement.querySelector(".post")||clearTimelineStatuses(),t=document.getElementById("timeline-show-new"),(e=getPost(insertIntoPostCache([e])[0],!1)).dataset.prepended="",prependedPosts++,t?tlElement.prepend(t,e):tlElement.prepend(e))}function postButtonClick(e){var t=e.currentTarget;if(t&&loggedIn){if(t.dataset.interactionQuote)createPostModal("quote",+t.dataset.interactionQuote);else if(t.dataset.interactionLike){var n,o=+t.dataset.interactionLike,a="true"===t.dataset.liked,s=postCache[o];s&&(s.interactions.liked=!a,s.interactions.likes+=2*(.5-a)*8);for(n of document.querySelectorAll(`[data-interaction-like="${o}"]`)){n.dataset.liked=String(!a);var i=n.querySelector("[data-number]");i&&!isNaN(+i.innerText)&&(i.innerText=String(+i.innerText+2*(.5-a)))}new(a?api_Unlike:api_Like)(o).fetch()}else if(t.dataset.interactionEdit)createPostModal("edit",+t.dataset.interactionEdit);else if(t.dataset.interactionPin){s=+t.dataset.interactionPin;new api_Pin(s).fetch()}else if(t.dataset.interactionUnpin)(new api_Unpin).fetch();else if(t.dataset.interactionDelete){o=+t.dataset.interactionDelete;new api_DeletePost(o).fetch()}else if(t.dataset.interactionShare){s=+t.dataset.interactionShare;if(!navigator.clipboard)return void createToast(L.errors.cant_copy,L.errors.cant_copy_more);navigator.clipboard.writeText(lr(L.post.copy_message,{s:pageTitle,p:`${location.origin}/p/${s}/`})),createToast(L.generic.copied,L.post.copied)}else if(t.dataset.interactionEmbed){o=+t.dataset.interactionEmbed;if(!navigator.clipboard)return void createToast(L.errors.cant_copy,L.errors.cant_copy_more);navigator.clipboard.writeText(`<iframe src="${location.origin}/p/${o}/?iframe=" width="600" height="400"></iframe>`),createToast(L.generic.copied,L.post.embedded)}else console.log("Unknown interaction type for post button",e);e.preventDefault()}}function createPost(e,t,n,o,a){new api_CreatePost(e,t,n,a).fetch().then(e=>{o&&o(Boolean(e))})}function handlePostDelete(e){for(var t of Object.values(tlCache))for(;null!=t&&t.posts.includes(e);)t.posts.splice(t.posts.indexOf(e),1);for(var n of document.querySelectorAll(`[data-post-id="${e}"]`))n.innerHTML=`<i>${L.post.deleted}</i>`;delete tlCache[`post_${e}_recent`],delete tlCache[`post_${e}_oldest`],getPostIDFromPath()===e&&(currentPage="home",history.pushState("home","","/"),renderPage("home"));for(var[o,a]of Object.entries(postCache))(null==a?void 0:a.comment)===e&&(delete postCache[+o],handlePostDelete(+o))}function simplePostContent(e,t,n){let o;return"string"!=typeof e?(o=e.content,t=e.content_warning,n=Boolean(e.poll)):o=e,escapeHTML(t?lr(L.post.cw_short,{c:t}):o)||(n?L.post.poll_short:"")}function p_tlMore(e){let t=e.querySelector('[id="timeline-more"]');t&&t.addEventListener("click",()=>{t.setAttribute("hidden",""),loadMorePosts()})}function p_tlSwitch(e){var t,n,o=e.querySelectorAll("[data-timeline-id]"),e=e.querySelectorAll("[data-timeline-toggle]");for(t of o)t.addEventListener("click",switchTimeline);for(n of e)n.addEventListener("click",toggleTimeline)}function p_post(e){var t;null!=(t=e.querySelector("[data-interaction-comment]"))&&t.addEventListener("click",postButtonClick),null!=(t=e.querySelector("[data-interaction-quote]"))&&t.addEventListener("click",postButtonClick),null!=(t=e.querySelector("[data-interaction-like]"))&&t.addEventListener("click",postButtonClick),null!=(t=e.querySelector("[data-interaction-edit]"))&&t.addEventListener("click",postButtonClick),null!=(t=e.querySelector("[data-interaction-pin]"))&&t.addEventListener("click",postButtonClick),null!=(t=e.querySelector("[data-interaction-delete]"))&&t.addEventListener("click",postButtonClick),null!=(t=e.querySelector("[data-interaction-share]"))&&t.addEventListener("click",postButtonClick),null!=(t=e.querySelector("[data-interaction-embed]"))&&t.addEventListener("click",postButtonClick)}function createToast(t,n,o){if(t){let e=getSnippet("toast",{title:t,content:n||""});null!=(t=document.getElementById("toasts"))&&t.append(e),e.addEventListener("click",()=>e.remove()),setTimeout(()=>e.remove(),o||3e3)}}function inputEnterEvent(e){var t,n;"Enter"===e.key&&(t=e.currentTarget,t=e.ctrlKey&&t.dataset.enterSubmit||t.dataset.enterNext||t.dataset.enterSubmit)&&"!avoid"!==t&&(n=document.querySelector(t))&&(n.focus(),"BUTTON"===n.nodeName&&n.click(),e.preventDefault())}function togglePasswords(e){let t,n,o="";var a,s,e=e.target;if(o=e?e.dataset.passwordToggle||"":o){t=[],n=[];for(var i of o.split(",")){i=document.querySelector(i.trim());i&&("password"===i.type?t:n).push(i)}}else t=[...document.querySelectorAll('input[type="password"]')],n=[...document.querySelectorAll("input[data-toggle-password]")];for(a of t)a.type="text",a.dataset.togglePassword="";for(s of n)s.type="password",delete s.dataset.togglePassword}function sha256(t){function n(e,t){return e>>>t|e<<32-t}var e=Math.pow(2,32);let o="";var a=[],s=8*t.length;let i=[];var r=[];let l=r.length;var c={};for(let t=2;l<64;t++)if(!c[t]){for(let e=0;e<313;e+=t)c[e]=t;i[l]=Math.pow(t,.5)*e|0,r[l++]=Math.pow(t,1/3)*e|0}for(t+="";t.length%64-56;)t+="\0";for(let e=0;e<t.length;e++){var d=t.charCodeAt(e);if(d>>8)return"";a[e>>2]|=d<<(3-e)%4*8}a[a.length]=s/e|0,a[a.length]=s;for(let e=0;e<a.length;){var u=a.slice(e,e+=16),m=i;i=i.slice(0,8);for(let e=0;e<64;e++){var p=u[e-15],g=u[e-2],h=i[0],f=i[4],f=i[7]+(n(f,6)^n(f,11)^n(f,25))+(f&i[5]^~f&i[6])+r[e]+(u[e]=e<16?u[e]:u[e-16]+(n(p,7)^n(p,18)^p>>>3)+u[e-7]+(n(g,17)^n(g,19)^g>>>10)|0),p=(n(h,2)^n(h,13)^n(h,22))+(h&i[1]^h&i[2]^i[1]&i[2]);(i=[f+p|0].concat(i))[4]=i[4]+f|0}for(let e=0;e<8;e++)i[e]=i[e]+m[e]|0}for(let t=0;t<8;t++)for(let e=3;e+1;e--){var _=i[t]>>8*e&255;o+=(_<16?0:"")+_.toString(16)}return o}function escapeHTML(e){return void 0===e?"":e.replaceAll("&","&amp;").replaceAll("<","&lt;").replaceAll('"',"&quot;").replaceAll("`","&#96;")}function unescapeHTML(e){return void 0===e?"":e.replaceAll("&#96;","`").replaceAll("&quot;",'"').replaceAll("&lt;","<").replaceAll("&amp;","&")}function getTimestamp(e,t=!1){let n=Math.round(Date.now()/1e3-e);var o=n<0,a=!!localStorage.getItem("smiggins-complex-timestamps");let s="?";return(n=o?-n:n)<60?s=lr(L.numbers.second,{x:String(n)}):n<3600?s=lr(L.numbers[a?"minute_second":"minute"],{x:String(Math.floor(n/60)),y:String(n%60)}):n<86400?s=lr(L.numbers[a?"hour_minute":"hour"],{x:String(Math.floor(n/60/60)),y:String(Math.floor(n/60)%60)}):n<31536e3?s=lr(L.numbers[a?"day_hour":"day"],{x:String(Math.floor(n/60/60/24)),y:String(Math.floor(n/60/60)%24)}):isNaN(e)||(s=lr(L.numbers[a?"day_hour":"day"],{x:String(Math.floor(n/60/60/24/365)),y:String(Math.floor(n/60/60/24)%365)})),o&&(s=lr(L.numbers.future,{t:s})),t?s:`<span data-timestamp="${e}">${s}</span>`}function updateTimestamps(){var e;for(e of document.querySelectorAll("[data-timestamp]")){var t=getTimestamp(+(e.dataset.timestamp||NaN),!0);t!==e.innerText&&(e.innerText=t)}}function setTokenCookie(e){document.cookie=`token=${e};Path=/;SameSite=Lax;Expires=${new Date(Date.now()+307584e5).toUTCString()}`}function genericCheckbox(t){return function(e){e=e.target;e&&(e.checked?localStorage.setItem(t,"1"):localStorage.removeItem(t))}}function getMentionsFromPost(e){e=[...new Set([[null,e.user.username],...e.content.matchAll(mentionRegex)].map(e=>e[1].toLowerCase()))].sort((e,t)=>e<t?-1:1);return e.includes(username)&&e.splice(e.indexOf(username),1),e}function adminDeletePost(){var e=document.getElementById("delete-post-id");e&&(e.value?new api_DeletePost(+e.value).fetch():e.focus())}function adminDeleteUser(){var e=document.getElementById("delete-user-username"),t=document.getElementById("delete-user-confirm");e&&t&&(e.value?t.checked?new api_AdminDeleteUser(e.value).fetch():t.focus():e.focus())}function adminCreateOTP(){(new api_GenerateOTP).fetch()}function adminDeleteOTP(e){e=e.target;if(e){var t,e=e.dataset.otp||"";for(t of document.querySelectorAll(`[data-otp-container="${e}"]`))t.remove();new api_DeleteOTP(e).fetch()}}function adminListOTPs(){var e=document.getElementById("otp-list");e&&(e.removeAttribute("hidden"),e.innerHTML=`<i>${L.generic.loading}</i>`),(new api_ListOTP).fetch()}function adminLoadPermissions(){var e=document.getElementById("permissions-username");e&&(e.value?new api_GetAdminPermissions(e.value).fetch():e.focus())}function adminSavePermissions(){var t=document.getElementById("permissions-username");if(t)if(t.value){let e=0;for(var n of document.querySelectorAll("[data-admin-permissions]"))n.checked&&n.dataset.adminPermissions&&(e|=1<<+n.dataset.adminPermissions);new api_SetAdminPermissions(t.value,e).fetch()}else t.focus()}function adminSetPermissionCheckboxes(e){for(var t of document.querySelectorAll("[data-admin-permissions]"))t.checked=Boolean(e&1<<+(t.dataset.adminPermissions||0))}function p_admin(e){var t;null!=(t=e.querySelector("#delete-post"))&&t.addEventListener("click",adminDeletePost),null!=(t=e.querySelector("#delete-user"))&&t.addEventListener("click",adminDeleteUser),null!=(t=e.querySelector("#generate-otp"))&&t.addEventListener("click",adminCreateOTP),null!=(t=e.querySelector("#list-otps"))&&t.addEventListener("click",adminListOTPs),null!=(t=e.querySelector("#permissions-load"))&&t.addEventListener("click",adminLoadPermissions),null!=(t=e.querySelector("#permissions-save"))&&t.addEventListener("click",adminSavePermissions)}function _getChanges(e,t){return`<details><summary>All changes in v${e}</summary><ul>${t.map(e=>`<li>${e}</li>`).join("")}</ul></details>`}function _getVersionSpotlight(e){return e?(e=(null==e?void 0:e.map(e=>`<div>${e.icon?icons[e.icon]:""}${e.info}</div>`).join(""))||"")&&`<div class="version-spotlight">${e}</div>`:""}function checkVersionNewer(e,t){e=e.split(".").map(Number),t=t.split(".").map(Number);return t[0]>e[0]||t[0]===e[0]&&t[1]>e[1]||t[0]===e[0]&&t[1]===e[1]&&t[2]>e[2]}function generateChangesHTML(e){let t=Object.keys(changes);if("all"!==e){if(!e.match(/^[0-9]+\.[0-9]+\.[0-9]+$/))return"Invalid";var n,o=[];for(n of t)checkVersionNewer(e,n)&&o.push(n);t=o}if(0===t.length)return"No changes";t.sort((e,t)=>{e=e.split(".").map(Number),t=t.split(".").map(Number);return t[0]-e[0]||t[1]-e[1]||t[2]-e[2]});let a="";if("all"===e)for(var s of t){var i=changes[s];a+=`<h2>v${s}</h2> <div class="changelog-description">- ${i.description}</div>${_getVersionSpotlight(i.major_changes)}${_getChanges(s,i.changes)}`}else{var r,l=[].concat(...t.map(e=>changes[e].major_changes||[]));a+="<h2>What's new?</h2><br>"+_getVersionSpotlight(l);for(r of t){var c=changes[r];a+=`<h2>v${r}</h2> <div class="changelog-description">- ${c.description}</div>${_getChanges(r,c.changes)}`}}return a}setInterval(updateTimestamps,1e3);let expectedVersion=localStorage.getItem("smiggins-last-version");function p_folreq(e){var t=e.querySelector("#timeline-posts");t&&hookTimeline(t,null,{"follow-requests":{api:api_TimelineFolreq,disableCaching:!0,disablePolling:!0,prependPosts:!1,customRender:renderFolreqTimeline}},"follow-requests",e)}function renderFolreqTimeline(e,t,n,o){var a;if(clearTimelineStatuses(),null===offset.lower&&0===e.length)(r=document.createElement("i")).classList.add("timeline-status"),r.innerText=L.generic.none,tlElement.append(r);else{var s,i=document.createDocumentFragment(),r=o||document.getElementById("timeline-more");r&&(r.hidden=!!t);for(s of e){var l=getSnippet("folreq-user",{username:s.username,banner_one:s.color_one,banner_two:s.color_two,hidden_if_no_pronouns:s.pronouns?"":"hidden",bio:[linkify(escapeHTML(s.bio)),1],pronouns:[escapeHTML(s.pronouns||""),1],display_name:[escapeHTML(s.display_name),1]});null!=(a=l.querySelector("[data-folreq-interaction-accept]"))&&a.addEventListener("click",folreqInteraction),null!=(a=l.querySelector("[data-folreq-interaction-deny]"))&&a.addEventListener("click",folreqInteraction),null!=(a=l.querySelector("[data-folreq-interaction-block]"))&&a.addEventListener("click",folreqInteraction),l.dataset.folreqRemove=s.username,i.append(l)}tlElement.append(i)}}function folreqInteraction(e){var t,n,e=e.currentTarget;e&&(e.dataset.folreqInteractionAccept||e.dataset.folreqInteractionDeny?(n=e.dataset.folreqInteractionAccept||e.dataset.folreqInteractionDeny||"",null!=(t=document.querySelector(`[data-folreq-remove="${n}"]`))&&t.remove(),new(e.dataset.folreqInteractionAccept?api_AcceptFollowRequest:api_DenyFollowRequest)(n).fetch()):e.dataset.folreqInteractionBlock&&(null!=(t=document.querySelector(`[data-folreq-remove="${e.dataset.folreqInteractionBlock}"]`))&&t.remove(),blockUser(e.dataset.folreqInteractionBlock,!0)))}function getHashtagFromPath(e){return(e||location.pathname).toLowerCase().split("/").filter(Boolean)[1]}function p_hashtag(e){var t=e.querySelector("#timeline-posts"),n=getHashtagFromPath();t&&n&&hookTimeline(t,e.querySelector("#timeline-carousel"),{[`hashtag_${n}_recent`]:{api:api_TimelineHashtag,args:[getHashtagFromPath(),"recent"],prependPosts:!1},[`hashtag_${n}_oldest`]:{api:api_TimelineHashtag,args:[getHashtagFromPath(),"oldest"],prependPosts:!1,disablePolling:!0,invertOffset:!0}},`hashtag_${n}_recent`,e)}function p_home(t){var e;hookTimeline(t.querySelector('[id="timeline-posts"]'),t.querySelector("#timeline-carousel"),{following:{api:api_TimelineFollowing,prependPosts:!0},global:{api:api_TimelineGlobal,prependPosts:!0},following__comments:{api:api_TimelineFollowing,args:[!0],prependPosts:!0},global__comments:{api:api_TimelineGlobal,args:[!0],prependPosts:!0}},"global",t),null!=(e=t.querySelector("#post"))&&e.addEventListener("click",homeCreatePost),null!=(e=t.querySelector("#poll-toggle"))&&e.addEventListener("click",function(){var e=t.querySelector("#poll-area");e&&(e.hidden=!e.hidden)})}function getPollInputsHTML(t,n){let o="";for(let e=0;e<limits.poll_count;e++)o+=`<div><input data-poll-input="${t}" data-poll-num="${e}" ${e+1<limits.poll_count?`data-enter-next="[data-poll-input='${t}'][data-poll-num='${e+1}']"`:""} data-enter-submit="${n}" placeholder="${lr(L.post[2<=e?"poll_placeholder_optional":"poll_placeholder"],{n:String(e+1)})}" maxlength="${limits.poll_item}"></div>`;return o}function homeCreatePost(o){let e,a=document.getElementById("post-cw"),s=document.getElementById("post-content");var t=document.getElementById("post-private");if(a&&s&&t){var n=a.value,i=s.value,t=t.checked,r=[];if(!postModalFor||"edit"!==postModalFor.type)for(var l of document.querySelectorAll(':not([hidden]) > div > [data-poll-input="home"]'))l.value&&r.push(l.value);i||0!==r.length?(null!=(e=o.target)&&e.setAttribute("disabled",""),createPost(i,n||null,t,e=>{var t;if(null!=(t=o.target)&&t.removeAttribute("disabled"),s.focus(),e){a.value="",s.value="",null!=(t=document.getElementById("poll-area"))&&t.setAttribute("hidden","");for(var n of document.querySelectorAll("[data-poll-input]"))n.value=""}},{poll:r.length?r:void 0})):s.focus()}}function loginSubmitEvent(e){var t,n,o=document.getElementById("username"),a=document.getElementById("password");o&&a&&(t=o.value,n=a.value,t?n?new api_LogIn(t,n,e.target).fetch():a.focus():o.focus())}function signupSubmitEvent(t){var n=document.getElementById("username"),o=document.getElementById("password"),a=document.getElementById("confirm"),s=document.getElementById("otp");if(n&&o&&a){var i=n.value,r=o.value,l=a.value;let e=null;s&&(e=s.value),s&&!e?s.focus():i?r?r!==l?(a.focus(),createToast(L.errors.passwords_dont_match)):new api_SignUp(i,r,t.target).fetch():o.focus():n.focus()}}function p_login(e){e.querySelector("#submit").addEventListener("click",loginSubmitEvent)}function p_signup(e){null!=(e=e.querySelector("#submit"))&&e.addEventListener("click",signupSubmitEvent)}function p_logout(e){document.cookie="token=;Path=/;Expires=Thu, 01 Jan 1970 00:00:01 GMT;",location.href="/"}setTimeout(()=>{loggedIn&&expectedVersion&&checkVersionNewer(expectedVersion,version)&&!localStorage.getItem("smiggins-hide-changelog")&&createUpdateModal(localStorage.getItem("smiggins-last-version")||"0.0.0"),localStorage.setItem("smiggins-last-version",version)},100);let MESSAGE_SEPARATION_TIMESTAMP_THRESHOLD=600,MESSAGE_PREPEND_SCROLL_DOWN_THRESHOLD=16,previousMessageLabel=null,firstMessage=null;function getMessageGroupIDFromPath(e){return+(e||location.pathname).split("/").filter(Boolean)[1]}function p_messageList(e){var t=e.querySelector("#timeline-posts");t&&(hookTimeline(t,null,{message_list:{api:api_MessageGroupTimeline,disableCaching:!0,prependPosts:!1,customRender:renderMessageListTimeline,customForward:handleMessageListForward}},"message_list",e),null!=(t=e.querySelector("#message-new")))&&t.addEventListener("click",newMessageModal)}function p_message(e){var t=e.querySelector("#timeline-posts");previousMessageLabel=null,firstMessage=null,t&&(hookTimeline(t,null,{message:{api:api_MessageTimeline,args:[getMessageGroupIDFromPath()],disableCaching:!0,prependPosts:!1,customRender:renderMessageTimeline,customForward:handleMessageForward}},"message",e),null!=(t=e.querySelector("#messages-compose")))&&t.addEventListener("keydown",messageComposeHandler)}function messageComposeHandler(e){var t;"Enter"!==e.key||e.shiftKey||(t=document.getElementById("messages-compose"))&&t.value&&(new api_MessageSend(getMessageGroupIDFromPath(),t.value,t).fetch(),e.preventDefault())}function renderMessageListTimeline(e,t,n,o,a=!1){if(clearTimelineStatuses(),null===offset.lower&&0===e.length)(i=document.createElement("i")).classList.add("timeline-status"),i.innerText=L.generic.none,tlElement.append(i);else{var s,i,r=document.createDocumentFragment();for(s of e){(!offset.lower||s.timestamp<offset.lower)&&(offset.lower=s.timestamp),(!offset.upper||s.timestamp>offset.upper)&&(offset.upper=s.timestamp);var l=getSnippet("message-list-item",{gid:String(s.group_id),timestamp:getTimestamp(s.timestamp),content:[s.recent_content?escapeHTML(s.recent_content):`<i>${L.messages.none}</i>`,1],names:[getMessageTitle(s.members.names,s.members.count),1]}),c=(s.unread||(l.dataset.notificationRead=""),document.querySelector(`[data-message-group-id="${s.group_id}"]`)||r.querySelector(`[data-message-group-id="${s.group_id}"]`));a&&null!=c&&c.remove(),c&&!a||(l.dataset.messageGroupId=String(s.group_id),r.append(l))}a?tlElement.prepend(r):(tlElement.append(r),(i=o||document.getElementById("timeline-more"))&&(i.hidden=!!t))}}function handleMessageListForward(e,t,n="message_list",o){tlPollingPendingResponse=!1,n!==currentTlID?console.log("timeline switched, discarding request"):0!==e.length&&(t?renderMessageListTimeline(e.reverse(),!1,!1,null,!0):reloadTimeline(!0))}function getMessageTitle(e,t){return e=e.map(e=>`<b>${escapeHTML(e)}</b>`),lr(n(L.messages.title,t-1),{a:e[0],b:e[1],c:e[2],n:String(t)})}function _getMessageSeparator(e){var t=document.createElement("div");return t.dataset.messageSeparator="",e.username===username&&(t.dataset.messageSelf=""),t.innerHTML=`<a data-internal-link="user" href="/u/${e.username}/" class="plain-link">${escapeHTML(e.display_name)} - ${getTimestamp(e.timestamp)}</a>`,generateInternalLinks(t),t}function renderMessageTimeline(t,n,e,o,a=!1){clearTimelineStatuses();var s=null===offset.lower,i=document.getElementById("messages-timeline-container"),r=null==i?void 0:i.scrollTop,l=i&&i.scrollHeight-i.getBoundingClientRect().height,c=null==i?void 0:i.scrollHeight;if(null===offset.lower&&(fetchNotifications(),firstMessage=t[0]),0===t.length)null===offset.lower&&((u=document.createElement("i")).classList.add("timeline-status"),u.innerText=L.generic.none,tlElement.append(u));else{var d,u,m=document.createDocumentFragment();let e=t[0];!a&&previousMessageLabel&&(e=previousMessageLabel[0],previousMessageLabel[1].remove(),previousMessageLabel=null);for(d of t){(!offset.lower||d.timestamp<offset.lower)&&(offset.lower=d.timestamp),(!offset.upper||d.timestamp>offset.upper)&&(offset.upper=d.timestamp),(e.username!==d.username||e.timestamp-MESSAGE_SEPARATION_TIMESTAMP_THRESHOLD>d.timestamp)&&m.append(_getMessageSeparator(e)),e=d;var p=document.createElement("div");p.innerHTML=linkify(escapeHTML(d.content)),generateInternalLinks(p),d.username===username&&(p.dataset.messageSelf=""),m.append(p)}(!a||firstMessage&&(e.username!==firstMessage.username||e.timestamp-MESSAGE_SEPARATION_TIMESTAMP_THRESHOLD>firstMessage.timestamp))&&(u=_getMessageSeparator(e),previousMessageLabel=[e,u],m.append(u)),a?(tlElement.prepend(m),firstMessage=t[0],i&&r&&l&&l-r<MESSAGE_PREPEND_SCROLL_DOWN_THRESHOLD&&(i.scrollTop=i.scrollHeight)):(tlElement.append(m),(u=o||document.getElementById("timeline-more"))&&(u.hidden=!!n),i&&s?i.scrollTop=i.scrollHeight:i&&void 0!==r&&void 0!==c&&(i.scrollTop=r+i.scrollHeight-c))}}function handleMessageForward(e,t,n="message",o){tlPollingPendingResponse=!1,n!==currentTlID?console.log("timeline switched, discarding request"):0!==e.length&&(t?renderMessageTimeline(e,!1,!1,null,!0):reloadTimeline(!0))}function p_notifications(e){pendingNotifications.notifications=!1;var t=e.querySelector("#timeline-posts");t&&hookTimeline(t,null,{notifications:{api:api_TimelineNotifications,disableCaching:!0,prependPosts:!1,customRender:renderNotificationTimeline,customForward:handleNotificationForward}},"notifications",e)}function _getLikeNotification(e){let t=0;var o=e.map(e=>(e.timestamp>t&&(t=e.timestamp),[e.username,e.display_name])).map(e=>{if(null===e)return"";let t="<b>",n="</b>";return e[0]&&(t+=`<a class="plain-link" data-internal-link="user" href="/u/${e[0]}/">`,n="</a>"+n),t+escapeHTML(e[1])+n}),o=lr(n(L.notifications.like,e.length),{a:o[0],b:o[1],c:o[2],n:String(e.length-3)});return getSnippet("notification-like",{pid:String(e[0].post_id),timestamp:getTimestamp(t),content:[simplePostContent(e[0].content,e[0].content_warning,!1),1],names:[o,1]})}function _getFollowNotification(e){let t=0;var o=e.map(e=>(e.timestamp>t&&(t=e.timestamp),[e.username,e.display_name])).map(e=>{if(null===e)return"";let t="<b>",n="</b>";return e[0]&&(t+=`<a class="plain-link" data-internal-link="user" href="/u/${e[0]}/">`,n="</a>"+n),t+escapeHTML(e[1])+n}),o=lr(n(L.notifications.follow,e.length),{a:o[0],b:o[1],c:o[2],n:String(e.length-3)});return getSnippet("notification-follow",{timestamp:getTimestamp(t),names:[o,1]})}function renderNotificationTimeline(a,s,e,i,r=!1){if(clearTimelineStatuses(),null===offset.lower&&0===a.length)(c=document.createElement("i")).classList.add("timeline-status"),c.innerText=L.generic.none,tlElement.append(c);else{var l,c,d=document.createDocumentFragment();let e={},t=[],n=[],o=!1;for(l of a){var u=(l.code===NotificationCodes.Like||l.code===NotificationCodes.Follow?l:l.post).timestamp;(!offset.lower||u<offset.lower)&&(offset.lower=u),(!offset.upper||u>offset.upper)&&(offset.upper=u),o||l.unread||(o=!0,pushPending(d,e,t,n),e={},t=[],n=[]),l.code===NotificationCodes.Like?(pushPending(d,{},[],n),n=[],localStorage.getItem("smiggins-no-like-grouping")?(u=_getLikeNotification([l]),l.unread||(u.dataset.notificationRead=""),d.append(u)):e[l.post_id]?e[l.post_id].push(l):(t.push(l.post_id),e[l.post_id]=[l])):l.code===NotificationCodes.Follow?(pushPending(d,e,t,[]),e={},t=[],localStorage.getItem("smiggins-no-like-grouping")?(u=_getFollowNotification([l]),l.unread||(u.dataset.notificationRead=""),d.append(u)):n.push(l)):(pushPending(d,e,t,n),e={},t=[],n=[],u=getPost(insertIntoPostCache([l.post])[0],!1),l.unread||(u.dataset.notificationRead=""),d.append(u))}pushPending(d,e,t,n),r?tlElement.prepend(d):(tlElement.append(d),(c=i||document.getElementById("timeline-more"))&&(c.hidden=!!s))}}function pushPending(e,t,n,o){if(n.length)for(var a of n){var s=_getLikeNotification(t[a]);t[a][0].unread||(s.dataset.notificationRead=""),e.append(s)}else o.length&&(n=_getFollowNotification(o),o[0].unread||(n.dataset.notificationRead=""),e.append(n))}function handleNotificationForward(e,t,n="notifications",o){tlPollingPendingResponse=!1,n!==currentTlID?console.log("timeline switched, discarding request"):0!==e.length&&(t?renderNotificationTimeline(e.reverse(),!1,!1,null,!0):reloadTimeline(!0))}(e=>{e[e.Comment=1]="Comment",e[e.Quote=2]="Quote",e[e.Ping=3]="Ping",e[e.Like=4]="Like",e[e.Follow=5]="Follow"})(NotificationCodes=NotificationCodes||{});let commentBoxValueSet=!1;function getPostIDFromPath(e){return+(e||location.pathname).split("/").filter(Boolean)[1]}function postSetDNE(){var e,t,n=document.createElement("div");n.innerText=L.errors.post_not_found,n.classList.add("generic-margin-top"),null!=(e=document.getElementById("focused-post"))&&e.replaceChildren(n),null!=(e=document.getElementById("comment-parent"))&&e.setAttribute("hidden",""),null!=(n=document.getElementById("home-link"))&&n.removeAttribute("hidden");for(t of document.querySelectorAll("#focused-post + hr ~ *"))t.setAttribute("hidden","")}function updateFocusedPost(e){var t=insertIntoPostCache([e])[0],n=document.querySelector("#focused-post .content-warning"),n=(null!=(o=document.getElementById("focused-post"))&&o.replaceChildren(getPost(t,!1,n?n.open:null)),e.comment?(null!=(o=document.getElementById("comment-parent"))&&o.removeAttribute("hidden"),null!=(t=document.getElementById("comment-parent"))&&t.setAttribute("href",`/p/${e.comment}/`),null!=(n=document.getElementById("home-link"))&&n.setAttribute("hidden","")):(null!=(o=document.getElementById("comment-parent"))&&o.setAttribute("hidden",""),null!=(t=document.getElementById("home-link"))&&t.removeAttribute("hidden")),document.getElementById("post-content")),o=document.getElementById("post-cw");commentBoxValueSet||!n||n.value||!o||o.value||(commentBoxValueSet=!0,n.value=getPostMentionsString(e),o.value=getPostTemplatedCW(e),(e.private||defaultPostPrivate)&&null!=(t=document.querySelector("#post-private:not([data-private-set])"))&&t.setAttribute("checked",""),null!=(n=document.querySelector("#post-private:not([data-private-set])"))&&n.setAttribute("data-private-set",""))}function getPostMentionsString(e){return getMentionsFromPost(e).map(e=>`@${e} `).join("")}function getPostTemplatedCW(e){var t=e.content_warning;if(t)switch(localStorage.getItem("smiggins-cw-cascading")){case"email":case null:if(!t.toLowerCase().startsWith("re:"))return lr(L.post.cw.reply,{c:t}).slice(0,limits.content_warning);case"copy":return t}return""}function createComment(n){let e,o=document.getElementById("post-cw"),a=document.getElementById("post-content");var t,s,i=document.getElementById("post-private");o&&a&&i&&(t=o.value,s=a.value,i=i.checked,s?(null!=(e=n.target)&&e.setAttribute("disabled",""),createPost(s,t||null,i,e=>{var t;null!=(t=n.target)&&t.removeAttribute("disabled"),a.focus(),e&&(o.value="",t=postCache[getPostIDFromPath()],a.value=t?getMentionsFromPost(t).map(e=>`@${e} `).join(""):"")},{comment:getPostIDFromPath()})):a.focus())}function p_postPage(e){var t,n,o=getPostIDFromPath(),a=postCache[o],s=e.querySelector("#focused-post"),i=e.querySelector("#timeline-posts");commentBoxValueSet=!1,i&&s&&(a?(t=e.querySelector("#post-content"),n=e.querySelector("#post-cw"),t&&(t.value=getPostMentionsString(a)),n&&(n.value=getPostTemplatedCW(a)),s.replaceChildren(getPost(o,!1))):s.replaceChildren(getSnippet("post-placeholder")),hookTimeline(i,e.querySelector("#timeline-carousel"),{[`post_${o}_recent`]:{api:api_TimelineComments,args:[o,"recent"],prependPosts:o},[`post_${o}_oldest`]:{api:api_TimelineComments,args:[o,"oldest"],prependPosts:!1,disablePolling:!0,invertOffset:!0}},`post_${o}_recent`,e),null!=(t=e.querySelector("#post")))&&t.addEventListener("click",createComment)}function p_search(e){var t=e.querySelector("#search-content"),n=e.querySelector("details"),o=e.querySelector("#search-cw"),a=e.querySelector("#search-username"),s=e.querySelector("#search-quote"),i=e.querySelector("#search-poll"),r=e.querySelector("#search-comment"),l=new URLSearchParams(location.search);t&&l.get("q")&&(t.value=l.get("q")||""),o&&l.get("cw")&&(o.value=l.get("cw")||"",null!=n)&&n.setAttribute("open",""),a&&l.get("user")&&(a.value=l.get("user")||"",null!=n)&&n.setAttribute("open",""),s&&l.get("quote")&&(s.value=l.get("quote")||"",null!=n)&&n.setAttribute("open",""),i&&l.get("poll")&&(i.value=l.get("poll")||"",null!=n)&&n.setAttribute("open",""),r&&l.get("comment")&&(r.value=l.get("comment")||"",null!=n)&&n.setAttribute("open",""),null!=(t=e.querySelector("#apply-search"))&&t.addEventListener("click",()=>resetSearchTL()),resetSearchTL(e)}function resetSearchTL(t){var n=(t||document).querySelector("#search-content"),o=(t||document).querySelector("#search-cw"),a=(t||document).querySelector("#search-username"),s=(t||document).querySelector("#search-quote"),i=(t||document).querySelector("#search-poll"),r=(t||document).querySelector("#search-comment"),n=n?n.value.toLowerCase():"",o=o?o.value.toLowerCase():"",a=a?a.value.toLowerCase():"",s=s?s.value:"",i=i?i.value:"",r=r?r.value:"",l=(t||document).querySelector("#timeline-posts");if(l){let e="";n&&(e+="&q="+n),o&&(e+="&cw="+o),a&&(e+="&user="+a),"true"!==s&&"false"!==s||(e+="&quote="+s),"true"!==i&&"false"!==i||(e+="&poll="+i),"true"!==r&&"false"!==r||(e+="&comment="+r),e=e.slice(1),location.search!=="?"+e&&location.search!==e&&(e?history.pushState("search","",`/search/?${e}`):history.pushState("search","","/search/")),hookTimeline(l,(t||document).querySelector("#timeline-carousel"),{search_recent:{api:api_TimelineSearch,args:[e,"new"],prependPosts:!1,disableCaching:!0,disablePolling:!0},search_oldest:{api:api_TimelineSearch,args:[e,"old"],prependPosts:!1,disableCaching:!0,disablePolling:!0,invertOffset:!0}},(null==(n=(t||document).querySelector("#timeline-carousel [data-timeline-active]"))?void 0:n.dataset.timelineId)||"search_recent",t)}}function updateBannerColors(){var e=document.getElementById("banner-example"),t=document.getElementById("banner-gradient"),n=document.getElementById("banner-one"),o=document.getElementById("banner-two");e&&(n&&(e.style.setProperty("--color-one",n.value),t)&&!t.checked&&e.style.setProperty("--color-two",n.value),!o||t&&!t.checked||e.style.setProperty("--color-two",o.value))}function updateUserCacheFromCosmeticSettings(){var e=userCache[username],t=document.getElementById("display-name"),n=document.getElementById("bio"),o=document.getElementById("banner-gradient"),a=document.getElementById("banner-one"),s=document.getElementById("banner-two");t&&n&&o&&a&&s&&e&&(e.color_one=a.value,e.color_two=(o.checked?s:a).value,e.display_name=t.value,e.bio=n.value)}function setFontSize(e){e=e.currentTarget;e&&(localStorage.setItem("smiggins-font-size",e.id.slice(10)),document.body.dataset.fontSize=e.id.slice(10))}function saveProfile(e){var t=document.getElementById("display-name"),n=document.getElementById("bio"),o=document.getElementById("banner-gradient"),a=document.getElementById("banner-one"),s=document.getElementById("banner-two"),i=document.getElementById("pronouns"),r=document.getElementById("pronouns-custom");t&&n&&o&&a&&s&&new api_SaveProfile(o.checked,t.value,n.value,i&&r?("custom"===i.value?r:i).value:"",a.value.slice(1),s.value.slice(1),e.target).fetch()}function saveDefaultVisibility(){var e;defaultPostPrivate="true"===(null==(e=document.getElementById("default-private"))?void 0:e.value),snippetVariables.selected_if_default_private=defaultPostPrivate?"selected":"",snippetVariables.checked_if_default_private=defaultPostPrivate?"checked":"",new api_DefaultVisibility(defaultPostPrivate).fetch()}function saveVerifyFollowers(){var e;new api_VerifyFollowers((null==(e=document.getElementById("verify-followers"))?void 0:e.checked)||!1).fetch()}function settingsThemeSelection(){var e=document.getElementById("theme");e&&setTheme(e.value)}function settingsPFPShapeSelection(){var e=document.getElementById("pfp-shape");e&&(e=e.value,localStorage.setItem("smiggins-pfp-shape",e),document.body.dataset.pfpShape=e)}function settingsCWCascadingSelection(){var e=document.getElementById("cw-cascading");e&&(e=e.value,localStorage.setItem("smiggins-cw-cascading",e))}function changePasswordSuccess(e){setTokenCookie(e),createToast(L.generic.success,L.settings.account.password_changed);var e=document.getElementById("password-current"),t=document.getElementById("password-new"),n=document.getElementById("password-confirm");e&&t&&n&&(e.value="",t.value="",n.value="")}function changePassword(e){var t,n,o,a=document.getElementById("password-current"),s=document.getElementById("password-new"),i=document.getElementById("password-confirm");a&&s&&i&&(t=a.value,n=s.value,o=i.value,t?n?o!==n?i.focus():new api_ChangePassword(t,n,e.target).fetch():s.focus():a.focus())}function deleteAccount(e){var t,n,o=document.getElementById("delete-acc-password"),a=document.getElementById("delete-acc-confirm");o&&a&&(t=o.value,n=a.checked,t?n?new api_DeleteAccount(username,t,e.target).fetch():a.focus():o.focus())}function profileSettingsSetUserData(e,t,n,o,a,s,i){var r=document.getElementById("display-name"),l=document.getElementById("bio"),c=document.getElementById("banner-gradient"),d=document.getElementById("banner-one"),u=document.getElementById("banner-two"),m=document.getElementById("verify-followers");let p=document.getElementById("pronouns"),g=document.getElementById("pronouns-custom");r&&(r.value=e),l&&(l.value=t),c&&(c.checked=s),d&&(d.value=o,d.addEventListener("input",updateBannerColors)),u&&(u.value=a,u.addEventListener("input",updateBannerColors)),m&&(m.checked=i,m.addEventListener("input",saveVerifyFollowers)),p&&g&&(p.addEventListener("input",function(){"custom"===p.value?g.removeAttribute("hidden"):g.setAttribute("hidden","")}),""!==n)&&(L.settings.profile.pronouns_presets.includes(n)?(p.value=n,g.setAttribute("hidden","")):(p.value="custom",g.value=n,g.removeAttribute("hidden"))),null!=(r=document.getElementById("profile-save"))&&r.addEventListener("click",saveProfile),null!=(l=document.getElementById("default-private"))&&l.addEventListener("input",saveDefaultVisibility),null!=(c=document.getElementById("banner-gradient"))&&c.addEventListener("input",updateBannerColors);var h,d=userCache[username];d&&(d.color_one=o,d.color_two=s?a:o,d.display_name=e,d.bio=t),updateBannerColors();for(h of document.querySelectorAll("[data-disabled-while-loading]"))h.removeAttribute("disabled")}function setKeybindElementData(e,t){setKeybindStrings();var n=keybinds[e],o=_kbGetKey(e);let a=o[0]+o.slice(1).split(":")[0];var o=o.slice(1).split(":")[1].split(",").map(e=>({alt:L.keybinds.modifiers.alt+" + ",ctrl:L.keybinds.modifiers.ctrl+" + ",nav:_kbGetKey("navModifier")[0]+_kbGetKey("navModifier").slice(1).split(":")[0]+" + ",shift:L.keybinds.modifiers.shift+" + "})[e]).join("");a===KB_DISABLED&&(a=L.keybinds.modifiers.disabled);let s=`<div class="generic-margin-top">${escapeHTML(n.name||"")}: <code class="kb-key">${escapeHTML(a==KB_DISABLED?KB_DISABLED:o+a)}</code> <button data-kb-id="${e}">${L.keybinds.button_change}</button></div>`;n.description&&(s+=`<small><div>${escapeHTML(n.description)}</div></small>`),t.innerHTML=s,null!=(o=t.querySelector("button"))&&o.addEventListener("click",()=>{modifyKeybindModal(e)})}function exportSettings(){var e={autoShowPosts:Boolean(localStorage.getItem("smiggins-auto-show-posts")),complexTimestamps:Boolean(localStorage.getItem("smiggins-complex-timestamps")),cwCascading:localStorage.getItem("smiggins-cw-cascading")||"email",expandCws:Boolean(localStorage.getItem("smiggins-expand-cws")),fontSize:localStorage.getItem("smiggins-font-size")||"normal",hideChangelog:Boolean(localStorage.getItem("smiggins-hide-changelog")),hideInteractions:Boolean(localStorage.getItem("smiggins-hide-interactions")),language:localStorage.getItem("smiggins-language")||L.meta.id,noLikeGrouping:Boolean(localStorage.getItem("smiggins-no-like-grouping")),pfpShape:localStorage.getItem("smiggins-php-shape")||"round",theme:localStorage.getItem("smiggins-theme")||"system",homeTimeline:{comments:Boolean(localStorage.getItem("smiggins-home-comments")),default:localStorage.getItem("smiggins-home")||"global"},keybinds:{hamburgerDelete:_kbGetKey("hamburgerDelete"),hamburgerEdit:_kbGetKey("hamburgerEdit"),hamburgerEmbed:_kbGetKey("hamburgerEmbed"),hamburgerPin:_kbGetKey("hamburgerPin"),hamburgerShare:_kbGetKey("hamburgerShare"),loadNewPosts:_kbGetKey("loadNewPosts"),navAdmin:_kbGetKey("navAdmin"),navHome:_kbGetKey("navHome"),navModifier:_kbGetKey("navModifier"),navNotifications:_kbGetKey("navNotifications"),navProfile:_kbGetKey("navProfile"),navSettings:_kbGetKey("navSettings"),newPost:_kbGetKey("newPost"),topOfTimeline:_kbGetKey("topOfTimeline")}},t=document.createElement("a");t.setAttribute("href","data:text/plain;charset=utf-8,"+encodeURIComponent(JSON.stringify(e))),t.setAttribute("download",`${pageTitle}.json`),t.style.display="none",document.body.appendChild(t),t.click(),document.body.removeChild(t)}function _lsBoolean(e,t){e?localStorage.setItem(t,"1"):localStorage.removeItem(t)}function importSettings(e){_lsBoolean(e.autoShowPosts,"smiggins-auto-show-posts"),_lsBoolean(e.complexTimestamps,"smiggins-complex-timestamps"),localStorage.setItem("smiggins-cw-cascading",e.cwCascading||"email"),_lsBoolean(e.expandCws,"smiggins-expand-cws"),localStorage.setItem("smiggins-font-size",e.fontSize||"normal"),_lsBoolean(e.hideChangelog,"smiggins-hide-changelog"),_lsBoolean(e.hideInteractions,"smiggins-hide-interactions"),_lsBoolean(e.noLikeGrouping,"smiggins-no-like-grouping"),localStorage.setItem("smiggins-pfp-shape",e.pfpShape||"round"),localStorage.setItem("smiggins-theme",e.theme||"system"),localStorage.setItem("smiggins-language",e.theme||DEFAULT_LANGUAGE),_lsBoolean(e.homeTimeline.comments,"smiggins-home-comments"),localStorage.setItem("smiggins-home",e.homeTimeline.default||"global"),localStorage.setItem("smiggins-keybind-hamburgerDelete",e.keybinds.hamburgerDelete||_kbGetKey("hamburgerDelete")),localStorage.setItem("smiggins-keybind-hamburgerEdit",e.keybinds.hamburgerEdit||_kbGetKey("hamburgerEdit")),localStorage.setItem("smiggins-keybind-hamburgerEmbed",e.keybinds.hamburgerEmbed||_kbGetKey("hamburgerEmbed")),localStorage.setItem("smiggins-keybind-hamburgerPin",e.keybinds.hamburgerPin||_kbGetKey("hamburgerPin")),localStorage.setItem("smiggins-keybind-hamburgerShare",e.keybinds.hamburgerShare||_kbGetKey("hamburgerShare")),localStorage.setItem("smiggins-keybind-loadNewPosts",e.keybinds.loadNewPosts||_kbGetKey("loadNewPosts")),localStorage.setItem("smiggins-keybind-navAdmin",e.keybinds.navAdmin||_kbGetKey("navAdmin")),localStorage.setItem("smiggins-keybind-navHome",e.keybinds.navHome||_kbGetKey("navHome")),localStorage.setItem("smiggins-keybind-navModifier",e.keybinds.navModifier||_kbGetKey("navModifier")),localStorage.setItem("smiggins-keybind-navNotifications",e.keybinds.navNotifications||_kbGetKey("navNotifications")),localStorage.setItem("smiggins-keybind-navProfile",e.keybinds.navProfile||_kbGetKey("navProfile")),localStorage.setItem("smiggins-keybind-navSettings",e.keybinds.navSettings||_kbGetKey("navSettings")),localStorage.setItem("smiggins-keybind-newPost",e.keybinds.newPost||_kbGetKey("newPost")),localStorage.setItem("smiggins-keybind-topOfTimeline",e.keybinds.topOfTimeline||_kbGetKey("topOfTimeline")),location.href=location.origin+location.pathname+location.search}function p_settingsProfile(e){(new api_GetProfile).fetch()}function p_settingsCosmetic(e){var t,n;null!=(t=e.querySelector(`#theme > option[value="${theme}"]`))&&t.setAttribute("selected",""),null!=(t=e.querySelector(`#pfp-shape > option[value="${localStorage.getItem("smiggins-pfp-shape")||"round"}"]`))&&t.setAttribute("selected",""),null!=(t=e.querySelector(`#cw-cascading > option[value="${localStorage.getItem("smiggins-cw-cascading")||"email"}"]`))&&t.setAttribute("selected",""),null!=(t=e.querySelector(`#language > option[value="${localStorage.getItem("smiggins-language")||L.meta.id}"]`))&&t.setAttribute("selected",""),localStorage.getItem("smiggins-complex-timestamps")&&null!=(t=e.querySelector("#complex-timestamps"))&&t.setAttribute("checked",""),localStorage.getItem("smiggins-hide-interactions")&&null!=(t=e.querySelector("#hide-interactions"))&&t.setAttribute("checked",""),localStorage.getItem("smiggins-expand-cws")&&null!=(t=e.querySelector("#expand-cws"))&&t.setAttribute("checked",""),localStorage.getItem("smiggins-hide-changelog")&&null!=(t=e.querySelector("#hide-changelog"))&&t.setAttribute("checked",""),localStorage.getItem("smiggins-no-like-grouping")&&null!=(t=e.querySelector("#no-like-grouping"))&&t.setAttribute("checked",""),localStorage.getItem("smiggins-auto-show-posts")&&null!=(t=e.querySelector("#auto-show"))&&t.setAttribute("checked",""),null!=(t=e.querySelector("#theme"))&&t.addEventListener("change",settingsThemeSelection),null!=(t=e.querySelector("#pfp-shape"))&&t.addEventListener("change",settingsPFPShapeSelection),null!=(t=e.querySelector("#cw-cascading"))&&t.addEventListener("change",settingsCWCascadingSelection),null!=(t=e.querySelector("#complex-timestamps"))&&t.addEventListener("change",genericCheckbox("smiggins-complex-timestamps")),null!=(t=e.querySelector("#hide-interactions"))&&t.addEventListener("change",genericCheckbox("smiggins-hide-interactions")),null!=(t=e.querySelector("#expand-cws"))&&t.addEventListener("change",genericCheckbox("smiggins-expand-cws")),null!=(t=e.querySelector("#hide-changelog"))&&t.addEventListener("change",genericCheckbox("smiggins-hide-changelog")),null!=(t=e.querySelector("#no-like-grouping"))&&t.addEventListener("change",genericCheckbox("smiggins-no-like-grouping")),null!=(t=e.querySelector("#auto-show"))&&t.addEventListener("change",genericCheckbox("smiggins-auto-show-posts")),null!=(t=e.querySelector("#language"))&&t.addEventListener("change",()=>{var e=null==(e=document.getElementById("language"))?void 0:e.value;e&&Object.keys(LANGS).includes(e)&&(localStorage.setItem("smiggins-language",e),L=LANGS[e],renderPage("settings/cosmetic"))});for(n of e.querySelectorAll("#font-size-selection > div"))n.addEventListener("click",setFontSize)}function p_settingsAccount(e){var t;null!=(t=e.querySelector("#password-set"))&&t.addEventListener("click",changePassword),null!=(t=e.querySelector("#delete-acc"))&&t.addEventListener("click",deleteAccount)}function p_settingsKeybinds(e){for(var t of e.querySelectorAll(".kb-input")){var n=t.dataset.kbId||"";n in keybinds&&setKeybindElementData(n,t)}}function p_settingsIndex(e){var t;null!=(t=e.querySelector("#export"))&&t.addEventListener("click",exportSettings);let o=e.querySelector("#import");null!=o&&o.addEventListener("input",function(e){var t,n=o.files;n&&n.length&&(n=n[0],(t=new FileReader).onload=e=>{e=null==(e=e.target)?void 0:e.result;"string"==typeof e&&importSettings(JSON.parse(e))},t.readAsText(n))})}document.body.dataset.fontSize=localStorage.getItem("smiggins-font-size")||"normal",document.body.dataset.pfpShape=localStorage.getItem("smiggins-pfp-shape")||"round";let colorRegex=/^#[0-9a-f]{6}$/,followingTimelineOffset=null;function getUsernameFromPath(e){return(e||location.pathname).toLowerCase().split("/").filter(Boolean)[1]}function p_user(e){let t,n,o,a,s=getUsernameFromPath();var i=`user_${s}`;null!=(t=e.querySelector("#follow"))&&t.addEventListener("click",toggleFollow),null!=(n=e.querySelector("#block"))&&n.addEventListener("click",toggleBlock),null!=(o=e.querySelector("#following-popup"))&&o.addEventListener("click",()=>createFollowingModal("following",s)),null!=(a=e.querySelector("#followers-popup"))&&a.addEventListener("click",()=>createFollowingModal("followers",s)),hookTimeline(e.querySelector('[id="timeline-posts"]'),e.querySelector("#timeline-carousel"),{[i]:{api:api_TimelineUser,args:[s],prependPosts:username===s},[i+"+all"]:{api:api_TimelineUser,args:[s,!0],prependPosts:username===s}},i,e)}function userSetDNE(){var e=document.getElementById("timeline-posts");e&&(e.innerHTML=`<i class="timeline-status">${lr(L.errors.user_dne,{u:escapeHTML(getUsernameFromPath())})}</i>`)}function userUpdateStats(e,t,n,o,a,s,i,r,l,c,d){var u=getUsernameFromPath();let m=userCache[u];m?(m.display_name=e,m.pronouns=t||null,m.bio=n,m.color_one=o,m.color_two=a,m.following=s,m.blocking=i,m.num_following=r,m.num_followers=l,m.num_posts=c,m.pinned=d):(m={display_name:e||username,pronouns:t||null,bio:n,color_one:o||"var(--background-mid)",color_two:a||"var(--background-mid)",following:s||!1,blocking:i||!1,num_following:r||0,num_followers:l||0,num_posts:c||0,pinned:d},userCache[u]=m),username!==u&&(null!=(g=document.getElementById("user-interactions"))&&g.removeAttribute("hidden"),g=document.getElementById("follow"),h=document.getElementById("block"),g&&("pending"===s?(g.innerText=L.user.pending,g.dataset.unfollow=""):s?(g.innerText=L.user.unfollow,g.dataset.unfollow=""):(g.innerText=L.user.follow,delete g.dataset.unfollow)),h)&&(i?(h.innerText=L.user.unblock,h.dataset.unblock=""):(h.innerText=L.user.block,delete h.dataset.unblock));s=document.getElementById("bio");s&&(s.innerHTML=linkify(escapeHTML(n)),generateInternalLinks(s));let p="";Object.values(pendingNotifications).some(Boolean)&&(p=" "),document.title=`${p}${e} - ${pageTitle}`;var g=document.getElementById("display-name"),i=(g&&(g.innerText=e),document.getElementById("username")),h=(i&&(i.innerText="@"+u+(t&&" - ")+t),document.getElementById("user-banner")),n=(h&&(colorRegex.test(o)&&h.style.setProperty("--color-one",o),colorRegex.test(a))&&h.style.setProperty("--color-two",a),document.getElementById("user-pinned-container")),i=(n&&(d?(n.removeAttribute("hidden"),(s=document.getElementById("user-pinned"))&&!s.querySelector(`[data-post-id="${d}"]`)&&(g=getPost(d,!1),u===username&&(e=g.querySelector("[data-interaction-pin]"))&&(delete e.dataset.interactionPin,e.dataset.interactionUnpin=String(d),e.innerHTML=icons.unpin+" "+L.post.unpin),s.replaceChildren(g))):n.setAttribute("hidden","")),document.getElementById("following")),t=document.getElementById("followers"),o=document.getElementById("post-count");i&&(i.innerText=lr(L.user.following_count,{n:m&&floatintToStr(r)||"0"})),t&&(t.innerText=lr(L.user.followed_by_count,{n:m&&floatintToStr(l)||"0"})),o&&(o.innerText=lr(L.user.posts_count,{n:m&&floatintToStr(c)||"0"}))}function updateFollowButton(e,t){var n,o=document.getElementById("follow");o&&(n=userCache[username],e?t?(o.innerText=L.user.pending,o.dataset.unfollow="",n&&(n.following="pending")):(o.innerText=L.user.unfollow,o.dataset.unfollow="",n&&(n.following=!0)):(o.innerText=L.user.follow,delete o.dataset.unfollow,n&&(n.following=!1)))}function updateBlockButton(e){var t=document.getElementById("block");t&&(e?(t.innerText=L.user.unblock,t.dataset.unblock="",(e=document.getElementById("follow"))&&void 0!==e.dataset.unfollow&&(delete e.dataset.unfollow,e.innerText=L.user.follow)):(t.innerText=L.user.block,delete t.dataset.unblock))}function toggleFollow(e){e=e.target;e&&new(void 0!==e.dataset.unfollow?api_Unfollow:api_Follow)(getUsernameFromPath(),e).fetch()}function toggleBlock(e){var t,e=e.target;e&&(t=void 0!==e.dataset.unblock,blockUser(getUsernameFromPath(),!t,e))}function blockUser(e,t,n){new(t?api_Block:api_Unblock)(e,n).fetch()}function hookFollowingTimeline(e,t){var n;document.getElementById("modal-following-timeline")&&(followingTimelineOffset=null,loadFollowingTimeline(e,t),null!=(n=document.getElementById("modal-timeline-more")))&&n.addEventListener("click",()=>loadFollowingTimeline(e,t))}function loadFollowingTimeline(e,t){var n;null!=(n=document.getElementById("modal-timeline-more"))&&n.setAttribute("hidden",""),null!=(n=document.getElementById("modal-following-timeline"))&&n.insertAdjacentHTML("beforeend",`<i class="timeline-status">${L.generic.loading}</i>`),new("following"===e?api_TimelineUserFollowing:api_TimelineUserFollowers)(followingTimelineOffset,t).fetch()}function renderFollowingTimeline(e,t){var n,o=document.getElementById("modal-following-timeline");if(o){var a,s=document.createDocumentFragment();clearTimelineStatuses(o),null===followingTimelineOffset&&0===e.length&&o&&(o.innerHTML=`<i class="timeline-status">${L.generic.none}</i>`);for(a of e){var i=getSnippet("folreq-user",{username:a.username,banner_one:a.color_one,banner_two:a.color_two,hidden_if_no_pronouns:a.pronouns?"":"hidden",bio:[a.bio?linkify(escapeHTML(a.bio),a.username):`<i>${L.user.no_bio}</i>`,1],pronouns:[escapeHTML(a.pronouns||""),1],display_name:[escapeHTML(a.display_name),1]});null!=(n=i.querySelector(".folreq-interactions"))&&n.remove(),s.append(i),(null===followingTimelineOffset||a.id<followingTimelineOffset)&&(followingTimelineOffset=a.id)}null!=o&&o.append(s),t?null!=(e=document.getElementById("modal-timeline-more"))&&e.setAttribute("hidden",""):null!=(o=document.getElementById("modal-timeline-more"))&&o.removeAttribute("hidden")}}
var __awaiter=this&&this.__awaiter||function(t,s,c,r){return new(c=c||Promise)(function(n,i){function o(t){try{a(r.next(t))}catch(t){i(t)}}function e(t){try{a(r.throw(t))}catch(t){i(t)}}function a(t){var i;t.done?n(t.value):((i=t.value)instanceof c?i:new c(function(t){t(i)})).then(o,e)}a((r=r.apply(t,s||[])).next())})};let sw_self=self;function canUseNotifications(){return __awaiter(this,void 0,void 0,function*(){return"granted"===(yield navigator.permissions.query({name:"notifications"})).state})}function handleNotification(i){return __awaiter(this,void 0,void 0,function*(){canUseNotifications()||console.log("[SW] recieved message but can't show notif");var t=(null==i?void 0:i.text().split(";"))||["Notification","","No notification content was given."];sw_self.registration.showNotification(t[0],{body:t.slice(2).join(";"),data:t[1]})})}sw_self.addEventListener("push",function(t){t.waitUntil(handleNotification(t.data))}),console.log("[SW] init");
var __awaiter=this&&this.__awaiter||function(i,c,s,r){return new(s=s||Promise)(function(n,t){function o(i){try{a(r.next(i))}catch(i){t(i)}}function e(i){try{a(r.throw(i))}catch(i){t(i)}}function a(i){var t;i.done?n(i.value):((t=i.value)instanceof s?t:new s(function(i){i(t)})).then(o,e)}a((r=r.apply(i,c||[])).next())})};let sw_self=self;function canUseNotifications(){return __awaiter(this,void 0,void 0,function*(){return"granted"===(yield navigator.permissions.query({name:"notifications"})).state})}function handleNotification(t){return __awaiter(this,void 0,void 0,function*(){canUseNotifications()||console.log("[SW] recieved message but can't show notif");var i=(null==t?void 0:t.text().split(";"))||["Notification","","No notification content was given."];sw_self.registration.showNotification(i[0],{body:i.slice(2).join(";"),data:i[1],icon:location.origin+"/favicon.ico"})})}sw_self.addEventListener("push",function(i){i.waitUntil(handleNotification(i.data))}),console.log("[SW] init");